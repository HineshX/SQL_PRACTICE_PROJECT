(()=>{function mc(t,e,r){return r?`${t}_${e}_${r}`:`${t}_${e}`}function Yf(t,e={},r){let o=[t];r&&o.push(r);let n=o.slice();for(let i of Object.keys(e)){let s=e[i];for(let a of o)if(typeof s=="boolean")s&&n.push(mc(a,i,null));else if(typeof s=="string")n.push(mc(a,i,s));else throw new Error(`modifier '${i}' has invalid type`)}return n.join(" ")}window.__getCssClass=Yf;var h=class{static log(e,...r){console.log(e,...r)}static warn(e,...r){console.warn(e,...r)}static error(e,...r){console.error(e,...r)}static assert(e,r){e||h.error("Assertion failed"+(r?": "+r:""))}};function d(t,e){return h.assert(t,e),t}function pe(t){return t!==void 0}function $o(t){let e=typeof t;return e=="object"&&t!=null||e=="function"}function cs(t){return typeof t=="function"}function ft(t){return typeof t=="string"}function uc(t){return Array.isArray(t)}var Ko=t=>t!=null,F=(t,e=`Unhandled value: ${JSON.stringify(t,null," ")}`)=>h.error(e);function pc(t,e,r){return function(...o){r&&r(...o);let n=t(...o);return e(this,n,...o),n}}var qf=0,Ho=class{constructor(e,r,o,n,i=null){this.listener=e,this.src=r,this.type=o,this.capture=!!n,this.handler=i,this.key=++qf}};var Vo=class extends Ho{constructor(e,r,o,n,i,s){super(e,o,n,i,s),this.proxy=r,this.callOnce=!1,this.removed=!1}markAsRemoved(){this.removed=!0,this.listener=null,this.proxy=null,this.src=null,this.handler=null}};function fc(t,e,r){for(let o in t)if(e.call(r,t[o],o,t))return!0;return!1}function hc(t,e,r){if(t){for(let o in t)if(e.call(r,t[o],o,t))return o}}function Uo(t,e){for(let r in t)if(!(r in e)||t[r]!==e[r])return!1;for(let r in e)if(!(r in t))return!1;return!0}function gc(t,e,r){let o={};if(t)for(let n in t)e.call(r,t[n],n,t)&&(o[n]=t[n]);return o}function zo(t,e,r){for(let o in t)t.hasOwnProperty(o)&&e.call(r,t[o],o,t)}function yc(t,e){let r={};for(let o of Object.keys(t))r[o]=e(t[o]);return r}function Wo(t,e){let r=e(t);if(r!==void 0)return r;if(typeof t!="object"||t==null)return t;if(Array.isArray(t))return t.map(n=>Wo(n,e));let o={};for(let n of Object.keys(t))o[n]=Wo(t[n],e);return o}function _c(t,e){for(let r of Object.keys(e))t[r]=e[r]}function ls(t){return t&&JSON.parse(JSON.stringify(t))}var co=class{constructor(e){this.src=e,this.listeners={},this._typeCount=0}getTypeCount(){return this._typeCount}getListenerCount(){let e=0;for(let r of Object.keys(this.listeners))e+=this.listeners[r].length;return e}add(e,r,o,n,i){let s=e.toString(),a=this.listeners[s];a||(a=this.listeners[s]=[],this._typeCount++);let c,l=this._findListenerIndex(a,r,n,i);return l>-1?(c=a[l],o||(c.callOnce=!1)):(c=new Vo(r,null,this.src,s,!!n,i),c.callOnce=o,a.push(c)),c}remove(e,r,o,n){let i=e.toString();if(!(i in this.listeners))return!1;let s=this.listeners[i],a=this._findListenerIndex(s,r,o,n);return a>-1?(s[a].markAsRemoved(),s.splice(a,1),s.length==0&&(delete this.listeners[i],this._typeCount--),!0):!1}removeByKey(e){let r=e.type;if(!(r in this.listeners))return!1;let o=this.listeners[r],n=o.indexOf(e),i=n>=0;return i&&(o.splice(n,1),e.markAsRemoved(),this.listeners[r].length==0&&(delete this.listeners[r],--this._typeCount)),i}getListeners(e,r){let o=this.listeners[e.toString()],n=[];if(o)for(let i=0;i<o.length;++i){let s=o[i];s.capture==r&&n.push(s)}return n}getListener(e,r,o,n){let i=this.listeners[e.toString()],s=-1;return i&&(s=this._findListenerIndex(i,r,o,n)),s>-1?i[s]:null}hasListener(e="",r){let o=pe(e),n=o?e.toString():"",i=pe(r);return fc(this.listeners,s=>{for(let a=0;a<s.length;++a)if((!o||s[a].type==n)&&(!i||s[a].capture==r))return!0;return!1})}_findListenerIndex(e,r,o,n){for(let i=0;i<e.length;++i){let s=e[i];if(!s.removed&&s.listener==r&&s.capture==!!o&&s.handler==n)return i}return-1}};var ms="ispring_lm_"+(Math.random()*1e6|0),ds;function Xf(){if(!_e.addEventListener||!Object.defineProperty)return!1;let t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});return _e.addEventListener("test",Function.prototype,e),_e.removeEventListener("test",Function.prototype,e),t}function jf(){return pe(ds)||(ds=Xf()),ds}function us(t){let e=t[ms];return e instanceof co?e:null}function rt(t){let e=t;if(!e||e.removed)return!1;let r=e.src,o=e.type,n=e.proxy;r.removeEventListener&&r.removeEventListener(o,n,e.capture);let i=us(r);return i?(i.removeByKey(e),i.getTypeCount()==0&&(r[ms]=null)):e.markAsRemoved(),!0}function Zf(t){let{listener:e,handler:r,callOnce:o}=t,n=r?e.bind(r):e;return o?(...i)=>{n(...i),rt(t)}:n}function Xe(t,e,r,o,n=null){let i=$o(o)?d(o).capture:!!o,s=us(t);s||(s=new co(t),t[ms]=s);let a=!!(o&&o.once),c=s.add(e,r,a,i,n);if(c.proxy)return c;let l=Zf(c);if(c.proxy=l,t.addEventListener){let m=jf()?o:i;pe(m)||(m=!1),t.addEventListener(e.toString(),l,m)}else throw new Error("addEventListener is unavailable.");return c}function Cc(t,e,r,o,n){o=!!o;let i=us(t);return i?i.getListener(e,r,o,n):null}var Go=class{dispose(){}};var Jf=0,vt=class extends Go{constructor(){super(),this._listenersKeys=null,this._activeSignals=null,this._disposables=null,this._customDestructHandlers=null}addDestructHandler(e){this._customDestructHandlers=this._customDestructHandlers||[],this._customDestructHandlers.push(e)}dispose(){if(this._destruct(),this._customDestructHandlers)for(let e of this._customDestructHandlers)e();if(this._disposables)for(let e of this._disposables)ps(e);if(this._listenersKeys){for(let e of this._listenersKeys)rt(e);this._listenersKeys=null}if(this._activeSignals)for(let e of Object.keys(this._activeSignals))this._removeSignalByKey(e)}_listen(e,r,o,n){this._listenersKeys=this._listenersKeys||[];let i=Xe(this._getEventTarget(e),r,o,n,this);return this._listenersKeys.push(i),i}_unlisten(e,r,o){let n=Cc(this._getEventTarget(e),r,o,!1);return!!n&&this._unlistenByKey(n)}_unlistenByKey(e){let r=d(this._listenersKeys),o=r.indexOf(e);return o>=0&&r.splice(o,1),rt(e)}_addSignal(e,r,o){this._activeSignals=this._activeSignals||{},e.add(r,this,o);let n=++Jf;return this._activeSignals[n]={dispatcher:e,fn:r,priority:o},n}_addSignalCallOnce(e,r,o){let n=(...i)=>{r.apply(this,i),this._removeSignal(e,n,o)};this._addSignal(e,n,o)}_removeSignal(e,r,o){let n=hc(this._activeSignals,i=>Uo(i,{dispatcher:e,fn:r,priority:o}));n?this._removeSignalByKey(n):!1&&h.warn("unknown signal")}_removeSignalByKey(e){if(!(this._activeSignals&&this._activeSignals[e])){h.warn("unknown signal key");return}let{dispatcher:r,fn:o,priority:n}=this._activeSignals[e];r.remove(o,this,n),delete this._activeSignals[e]}_removeAllEvents(e){if(!!e){if(this._activeSignals){let r=gc(this._activeSignals,o=>o.dispatcher.eventOwner()==e);for(let o of Object.keys(r))this._removeSignalByKey(o)}if(this._listenersKeys){let r=this._getEventTarget(e),o=this._listenersKeys.filter(n=>n.src==r);for(let n of o)this._unlistenByKey(n)}}}_name(){let e=this,r=e.owner,o=`[${this.constructor.name}]`;return r&&(o+=` in [${r.constructor.name}].${e.ownerPropertyName()}`),o}_addDisposable(e){if(this._disposables=this._disposables||[],!e||this._disposables.includes(e))return e;if(!1){let r=e;d(this._disposables.indexOf(e)<0),d(!r.owner),r.owner=this,r.ownerPropertyName=()=>{let o=this;for(let n of Object.keys(o))if(o[n]==r)return n;return"unknown"}}return this._disposables.push(e),e}_removeDisposable(...e){if(!!this._disposables){for(let r of e)if(r){this._cleanItemDependencies(r);let o=this._disposables.indexOf(r);o>=0&&(this._disposables.splice(o,1),ps(r))}}}_cleanItemDependencies(e){this._removeAllEvents(e)}_cleanDependencies(...e){for(let r of e)r&&this._cleanItemDependencies(r)}_getEventTarget(e){return e}_destruct(){}};function fs(t,e){return t>e?1:t<e?-1:0}function kc(t,e){if(!t)return!1;let r=t.indexOf(e),o=r>=0;return o&&t.splice(r,1),o}function eh(t,e,r,o,n){let i=0,s=t.length,a;for(;i<s;){let c=i+s>>1,l;r?l=e.call(n,t[c],c,t):l=e(o,t[c]),l>0?i=c+1:(s=c,a=!l)}return a?i:~i}function th(t,e,r=fs){return eh(t,r,!1,e)}function Sc(t,e,r){let o=th(t,e,r);return o<0?(t.splice(-(o+1),0,e),!0):!1}function hs(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}var Qo=class{constructor(){this._priorities=null,this._values=null,this._zeroPriorityValues=null}push(e,r){this._addPriority(r);let o=this._getPriorityValues(r);o?o.push(e):h.warn("Priority array values are zero")}remove(e,r){let o=this._getPriorityValues(r);o&&kc(o,e)}removeAt(e,r){let o=this._getPriorityValues(r);o&&o.splice(e,1)}getValuesWithPriority(e){if(e==0)return this._zeroPriorityValues||[];if(!this._values)return h.warn("Priority array values are zero"),[];if(!(e in this._values))return[];let r=this._getPriorityValues(e);return r||(h.warn("Priority array values are zero"),[])}getAllValues(){if(!this._values)return this._zeroPriorityValues?this._zeroPriorityValues.slice():[];let e=[],r=d(this._priorities);for(let o=0;o<r.length;++o){let n=r[o],i=this._getPriorityValues(n);i&&e.push(...i)}return e}_addPriority(e){if(e==0){this._zeroPriorityValues=this._zeroPriorityValues||[];return}this._priorities=this._priorities||[0],this._values=this._values||{},e in this._values||(this._values[e]=[],Sc(this._priorities,e))}_getPriorityValues(e){return e==0?this._zeroPriorityValues:d(this._values)[e]}};var Ie=class extends vt{constructor(e=null){super(),this._handlers=null,this._owner=e}eventOwner(){return this._owner}add(e,r,o=0){this._handlers=this._handlers||new Qo,this._handlers.push({fn:e,context:r},o)}addCallOnce(e,r,o=0){let n=i=>{e.call(r,i),this.remove(n,r,o)};this.add(n,r,o)}remove(e,r,o=0){if(!this._handlers){h.warn("Signal has no handlers!");return}let n=this._handlers.getValuesWithPriority(o),i=n.length;for(let s=0;s<i;++s){let a=n[s];if(a.fn==e&&a.context==r){this._handlers.removeAt(s,o);break}}}has(e,r,o=0){if(!this._handlers)return!1;let n=this._handlers.getValuesWithPriority(o),i=n.length;for(let s=0;s<i;++s){let a=n[s];if(a.fn==e&&a.context==r)return!0}return!1}dispatch(e){if(!this._handlers)return;let r=this._handlers.getAllValues(),o=r.length;for(let n=0;n<o;++n){let i=r[n];if(this._handlers.getAllValues().indexOf(i)!=-1)if(!1)i.fn.apply(i.context,[e]);else try{i.fn.apply(i.context,[e])}catch(s){gs(s,!0)}}}toFn(){return e=>this.dispatch(e)}handlersCount(){return this._handlers?this._handlers.getAllValues().length:0}};var _e=Function("return this")(),rh=()=>!0;function Yo(t,e){if(!!rh()){if(e){h.error(t);return}h.warn(t)}}function gs(t,e){let r=t.stack||t.toString();String(r).indexOf(t.message)<0&&Yo(t.message,e),Yo(r,e)}var oh=Object.getPrototypeOf({});function ps(t){!t||(d(!t.disposed),!1&&setTimeout(()=>{let e=t.owner?t.owner.constructor.name:null,r=t.owner?t.ownerPropertyName():null;if(t.owner=null,t.ownerPropertyName=null,t instanceof Ie){let i=e?`[${e}].${r} have active signals`:void 0;d(t.handlersCount()==0,i)}let o=t,n=new Set;for(;(o=d(Object.getPrototypeOf(o)))!=oh;)Object.getOwnPropertyNames(o).forEach(i=>{i!="constructor"&&n.add(i)});n.forEach(i=>{cs(t[i])&&(t[i]=pc(t[i].bind(t),()=>{Yo(`using method ${i} from disposed object ${t.constructor.name}`,!0)}))})},100),cs(t.dispose)&&t.dispose(),t.disposed=!0)}function xc(t,e){let r=t.split("."),o=_e;!(r[0]in o)&&typeof o.execScript!="undefined"&&o.execScript("var "+r[0]);for(let n;r.length&&(n=r.shift());)!r.length&&pe(e)?o[n]=e:o[n]&&o[n]!==Object.prototype[n]?o=o[n]:o=o[n]={}}!1||(_e.onerror=function(...t){let[e,,,,r]=t;return r?gs(r,!0):Yo(e,!0),!0});function ht(t,e,r){return Math.max(e,Math.min(r,t))}function nh(t){return t.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1")}function ih(t,e,r,o="g"){return t.replace(new RegExp(nh(e),o),r)}function sh(t,e,r,o){return t.substr(0,r)+e+t.substr(o)}function bc(t,e){let r=t;return e.sort((o,n)=>n.startIndex-o.startIndex).forEach(({text:o,startIndex:n,endIndex:i})=>{r=sh(r,o,n,i)}),r}function wc(t,e,r){let o=t;for(let n of Object.keys(e)){let i=e[n],s=r(n);o=ih(o,s,i)}return o}function Tc(t,e){return t.slice(0,e).replace(/[^\s]*\s*$/,"").length}function vc(t,e){let r=/^\s*[^\s]*/i.exec(t.slice(e)),o=r?r[0].length:0;return e+o}function ys(t,e={}){return new Promise((r,o)=>{let n=new XMLHttpRequest;d(e),n.open(e.method||"get",t,!0);for(let s in e.headers)e.headers.hasOwnProperty(s)&&n.setRequestHeader(s,e.headers[s]);n.withCredentials=e.credentials=="include",n.onload=()=>{r(i())},n.onerror=o,n.send(e.body);function i(){let s=[],a=[],c={},l;return n.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(m,u,g)=>(s.push(u=u.toLowerCase()),a.push([u,g]),l=c[u],c[u]=l?`${l},${g}`:g,"")),{ok:(n.status/100|0)==2,status:n.status,statusText:n.statusText,url:n.responseURL,clone:i,text:()=>Promise.resolve(n.responseText),json:()=>Promise.resolve(n.responseText).then(m=>JSON.parse(m)),blob:()=>Promise.resolve(new Blob([n.response])),headers:{keys:()=>s,entries:()=>a,get:m=>c[m.toLowerCase()],has:m=>m.toLowerCase()in c}}}})}async function _s(t){let e=await ys(t);return e.ok?e.json():null}function Ec(t){return new Promise((e,r)=>{let o=new XMLHttpRequest;o.open("GET",t,!0),o.responseType="arraybuffer",o.onload=function(){let n=o.response;e(new Blob([n]))},o.onerror=r,o.send(null)})}async function Bc(t){let e=await ys(t);return e.ok?e.text():""}function ah(t){return window.path.normalize(t).replace(/\\/g,"/")}function ch(t,e){return e?`@media ${e} {${t}}`:t}function lh(t,e,r){let o=new RegExp(/@import ['"]([./\w-_]+)['"]\s*(.+)?;/gi),n=o.exec(e),i=[];for(;n;){let s=n.index,a=s+n[0].length,c=window.path,l=n[2],m=ah(c.join(c.dirname(t),n[1])),u=Cs(m).then(g=>({text:ch(g,l),startIndex:s,endIndex:a}));i.push(u),n=o.exec(e)}return Promise.all(i)}async function dh(t,e){let r=await Bc(t);r=r.replace(/(url\()([^/])/g,`$1${e}$2`);let o=await lh(t,r,e);return bc(r,o)}async function Cs(t){if(window.path){let r=window.path;return dh(t,r.dirname(t)+"/")}let e=await Bc(t);return e.includes("@import")&&console.error('import is not supported without "browser-path" dependency'),e}var gt="data-root";function Rc(t){return new Promise(e=>{let r=document.createElement("style");r.onload=()=>e(),r.innerHTML=t,d(d(document).head).appendChild(r),r.sheet.cssRules[0].type!==CSSRule.IMPORT_RULE&&e()})}var ks=0,qo=[],Dc=null;function mh(t,e,r={},o){return!1&&[e,...Object.keys(r),...Object.values(r).filter(i=>typeof i=="string")].some(i=>i.includes("_"))&&console.error('css className should not contain "_" character'),__getCssClass(t+e,r,o)}function uh(t,e){t.includes("@import")&&console.error("import is not supported");let r=`[${gt}]`,o=/^\s*\w*\..*[{,]/gm;return t.replace(o,n=>n.replace(/\.([a-zA-Z_])/g,`.${e}$1`).replace(/^\s*(\.[\w-]+)(.*)([{,])$/m,`${r} $1$2, $1${r}$2$3`))}var Ic="";function ph(t){return Ic=fh(gh(yh(hh(t),8*t.length))),Ic.toLowerCase()}function fh(t){for(var e,r="0123456789ABCDEF",o="",n=0;n<t.length;n++)e=t.charCodeAt(n),o+=r.charAt(e>>>4&15)+r.charAt(15&e);return o}function hh(t){for(var e=Array(t.length>>2),r=0;r<e.length;r++)e[r]=0;for(r=0;r<8*t.length;r+=8)e[r>>5]|=(255&t.charCodeAt(r/8))<<r%32;return e}function gh(t){for(var e="",r=0;r<32*t.length;r+=8)e+=String.fromCharCode(t[r>>5]>>>r%32&255);return e}function yh(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var r=1732584193,o=-271733879,n=-1732584194,i=271733878,s=0;s<t.length;s+=16){var a=r,c=o,l=n,m=i;o=we(o=we(o=we(o=we(o=be(o=be(o=be(o=be(o=xe(o=xe(o=xe(o=xe(o=Se(o=Se(o=Se(o=Se(o,n=Se(n,i=Se(i,r=Se(r,o,n,i,t[s+0],7,-680876936),o,n,t[s+1],12,-389564586),r,o,t[s+2],17,606105819),i,r,t[s+3],22,-1044525330),n=Se(n,i=Se(i,r=Se(r,o,n,i,t[s+4],7,-176418897),o,n,t[s+5],12,1200080426),r,o,t[s+6],17,-1473231341),i,r,t[s+7],22,-45705983),n=Se(n,i=Se(i,r=Se(r,o,n,i,t[s+8],7,1770035416),o,n,t[s+9],12,-1958414417),r,o,t[s+10],17,-42063),i,r,t[s+11],22,-1990404162),n=Se(n,i=Se(i,r=Se(r,o,n,i,t[s+12],7,1804603682),o,n,t[s+13],12,-40341101),r,o,t[s+14],17,-1502002290),i,r,t[s+15],22,1236535329),n=xe(n,i=xe(i,r=xe(r,o,n,i,t[s+1],5,-165796510),o,n,t[s+6],9,-1069501632),r,o,t[s+11],14,643717713),i,r,t[s+0],20,-373897302),n=xe(n,i=xe(i,r=xe(r,o,n,i,t[s+5],5,-701558691),o,n,t[s+10],9,38016083),r,o,t[s+15],14,-660478335),i,r,t[s+4],20,-405537848),n=xe(n,i=xe(i,r=xe(r,o,n,i,t[s+9],5,568446438),o,n,t[s+14],9,-1019803690),r,o,t[s+3],14,-187363961),i,r,t[s+8],20,1163531501),n=xe(n,i=xe(i,r=xe(r,o,n,i,t[s+13],5,-1444681467),o,n,t[s+2],9,-51403784),r,o,t[s+7],14,1735328473),i,r,t[s+12],20,-1926607734),n=be(n,i=be(i,r=be(r,o,n,i,t[s+5],4,-378558),o,n,t[s+8],11,-2022574463),r,o,t[s+11],16,1839030562),i,r,t[s+14],23,-35309556),n=be(n,i=be(i,r=be(r,o,n,i,t[s+1],4,-1530992060),o,n,t[s+4],11,1272893353),r,o,t[s+7],16,-155497632),i,r,t[s+10],23,-1094730640),n=be(n,i=be(i,r=be(r,o,n,i,t[s+13],4,681279174),o,n,t[s+0],11,-358537222),r,o,t[s+3],16,-722521979),i,r,t[s+6],23,76029189),n=be(n,i=be(i,r=be(r,o,n,i,t[s+9],4,-640364487),o,n,t[s+12],11,-421815835),r,o,t[s+15],16,530742520),i,r,t[s+2],23,-995338651),n=we(n,i=we(i,r=we(r,o,n,i,t[s+0],6,-198630844),o,n,t[s+7],10,1126891415),r,o,t[s+14],15,-1416354905),i,r,t[s+5],21,-57434055),n=we(n,i=we(i,r=we(r,o,n,i,t[s+12],6,1700485571),o,n,t[s+3],10,-1894986606),r,o,t[s+10],15,-1051523),i,r,t[s+1],21,-2054922799),n=we(n,i=we(i,r=we(r,o,n,i,t[s+8],6,1873313359),o,n,t[s+15],10,-30611744),r,o,t[s+6],15,-1560198380),i,r,t[s+13],21,1309151649),n=we(n,i=we(i,r=we(r,o,n,i,t[s+4],6,-145523070),o,n,t[s+11],10,-1120210379),r,o,t[s+2],15,718787259),i,r,t[s+9],21,-343485551),r=Et(r,a),o=Et(o,c),n=Et(n,l),i=Et(i,m)}return Array(r,o,n,i)}function Xo(t,e,r,o,n,i){return Et(_h(Et(Et(e,t),Et(o,i)),n),r)}function Se(t,e,r,o,n,i,s){return Xo(e&r|~e&o,t,e,n,i,s)}function xe(t,e,r,o,n,i,s){return Xo(e&o|r&~o,t,e,n,i,s)}function be(t,e,r,o,n,i,s){return Xo(e^r^o,t,e,n,i,s)}function we(t,e,r,o,n,i,s){return Xo(r^(e|~o),t,e,n,i,s)}function Et(t,e){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}function _h(t,e){return t<<e|t>>>32-e}function Ch(t){let e=`x${ph(t).slice(0,5)}__`;function r(n){qo[o]=uh(n,e),--ks,ks||(Rc(qo.join(`
`)),Dc&&Dc())}let o=qo.length;if(qo.push(""),!1){++ks;let n=window.rootPath||"";Cs(n+t).then(r).catch(()=>{r(t)})}return e}function he(t){let e=t[0],r=Ch(e);return{getCssClass:mh.bind(null,r)}}function kh(){return window.navigator.platform.includes("Mac")}function Sh(){return window.navigator.userAgent.includes("Chrome")}function Mc(){return kh()&&!Sh()}function lo(){return!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)}function jo(){return/Firefox/.test(navigator.userAgent)}function Zo(){return window.navigator.userAgent.includes("MSIE")||window.navigator.userAgent.includes("Trident")}function Ac(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(window.navigator.userAgent)}var Oc={};function Fc(t,e){Oc[t]=e}function br(t){return Oc[t]||document.body}var Ss={topLayer:"xced93__top-layer",popupLayer:"xced93__popup-layer",popupLayerIos:"xced93__popup-layer-ios"};function xh(t,e){let r=[Ss.topLayer];t==="popup"&&(r.push(Ss.popupLayer),lo()&&r.push(Ss.popupLayerIos)),e.classList.add(...r)}function xs(t){let e=document.createElement("div");return e.setAttribute(gt,""),xh(t,e),Fc(t,e),e}var Jo=class extends vt{addDisposable(e){return this._addDisposable(e)}addSignal(e,r,o){return this._addSignal(e,r,o)}addSignalCallOnce(e,r,o){return this._addSignalCallOnce(e,r,o)}listen(e,r,o,n){return this._listen(e,r,o,n)}};var Ae=class extends vt{_createDependencyGroup(){return this._addDisposable(new Jo)}_createSignal(e){let r=new Ie(this);if(this._addDisposable(r),e)if(Array.isArray(e))for(let o of e)this._addSignal(o,n=>r.dispatch(n));else this._addSignal(e,o=>r.dispatch(o));return r}_createSignalProxy({signal:e,checkDispatchFn:r,modifyDataFn:o}){let n=new Ie(this);return this._addDisposable(n),this._addSignal(e,i=>{if(!r||r(i)){let s=o?o(i):i;n.dispatch(s)}}),n}};var Pc=["Learn.Reports.SendReportOnSchedulePopup.Schedule.Month.Day","Learn.EditContent.CompletionTab.ReenrollmentAfterCourseCompletion.Part1","Learn.EditContent.CompletionTab.ReenrollmentBeforeCertExpires.Part1","Learn.EditContent.CompletionTab.ReenrollmentAfterCourseCompletion.Part2","Studio.SideBar.StorageBar.Progress.Part1","Studio.SideBar.StorageBar.Progress.Part2"];var en=class extends Ae{constructor(e){super(),this._messages=e}addMessages(e){this._messages={...this._messages,...e}}getMessage(e,r){if(!this._messages.hasOwnProperty(e))return e;let o=d(this._messages[e]||Pc.includes(e));return typeof o!="string"&&(o=""),r&&(o=wc(o,r,this._generateKey)),o}messages(){return this._messages}hasMessage(e){return this._messages.hasOwnProperty(e)}_generateKey(e){return"{"+e.toLowerCase()+"}"}};var wr,bs=null;function bh(t){if(wr){h.warn("i18n has already been declared");return}wr=t}function Nc(t){if(wr){wr.addMessages(t);return}let e=new en(t);bh(e)}function x(t,e){let r=typeof t=="string"?t:t.value;return wr?wr.getMessage(r,e):(h.warn("i18n is not initialized"),r)}function Lc(t){return{value:t}}var tn=null;function $c(t){if(tn){h.warn("direction has already been declared");return}tn=t,document.documentElement.dir=t}function Ve(){return tn||(h.warn("direction is not initialized"),"ltr")}function Tr(){return Ve()==="rtl"}function Bt(t){return t.order.length}function wh(){return{order:[],blocks:{}}}function rn(t,e){let r=wh();for(let o of t){let n=e(o);r.order.push(n),r.blocks[n]=o}return r}function Th(t,e){if(e<0||e>=t.order.length)return null;let r=t.order[e];return t.blocks[r]}function Rt(t){return Th(t,0)}function vr(t,e){if(e<0||e>=t.order.length)return null;let r=t.order[e];return t.blocks[r]}function Kc(t){return vr(t,0)}function Hc(t){return vr(t,t.order.length-1)}function Vc(t,e){let r=t.order.indexOf(e);return vr(t,r-1)}function Wc(t,e){let r=t.order.indexOf(e);return vr(t,r+1)}function je(t,e){t.order.forEach(r=>{e(t.blocks[r])})}function Uc(t,e){t.order.forEach(r=>{e(t.blocks[r])})}function zc(t,e,r){let o=t.order.indexOf(e);t.order.splice(o+1,0,r.key),t.blocks[r.key]=r}function ws(t,e){t.order.push(e.key),t.blocks[e.key]=e}function Gc(t,e){let r=t.order.indexOf(e);t.order.splice(r,1),delete t.blocks[e]}function Qc(t,e,r){t.order.includes(e)&&(delete t.blocks[e],t.order[t.order.indexOf(e)]=r.key,t.blocks[r.key]=r)}var ge={LATO:"Lato",ROBOTO:"Roboto",OPEN_SANS:"Open Sans",MERRIWEATHER:"Merriweather",ROBOTO_SLAB:"Roboto Slab",EXO_2:"Exo 2",MONTSERRAT:"Montserrat",PT_SERIF:"PT Serif"};function Ts(t){return`${mo(t)}, ${vh(t)}`}function mo(t){switch(t){case ge.LATO:return"Lato";case ge.ROBOTO:return"roboto";case ge.OPEN_SANS:return"open-sans";case ge.MERRIWEATHER:return"merriweather";case ge.ROBOTO_SLAB:return"roboto-slab";case ge.EXO_2:return"exo-2";case ge.MONTSERRAT:return"montserrat";case ge.PT_SERIF:return"pt-serif";default:return""}}function vh(t){switch(t){case ge.LATO:case ge.ROBOTO:case ge.OPEN_SANS:case ge.EXO_2:case ge.MONTSERRAT:return"sans-serif";case ge.MERRIWEATHER:case ge.ROBOTO_SLAB:case ge.PT_SERIF:return"serif";default:return""}}var Eh=['link[href*="bundle"]','link[href*="legacy_components_customization"]'],Bh={include:Eh.join(","),silent:!0};var Yc={};function yt(t,e,r){Er(t,{[e]:r})}function Er(t,e){(t instanceof HTMLElement||t instanceof SVGElement)&&(Zo()?(Object.keys(e).forEach(r=>{let o=e[r];o=o===null?"":o.toString(),Yc[r]=o}),cssVars({...Bh,variables:Yc})):Object.keys(e).forEach(r=>{let o=e[r];o!=null&&(o=o.toString()),t.style.setProperty(r,o)}))}function Jt(t){Er(document.documentElement,t)}function vs(t){return d(getComputedStyle(document.documentElement)).getPropertyValue(t)}function on(t){let e=window.getComputedStyle(t),r=e&&e.transform?e.transform:"";return r=="none"&&(r=""),r}function nn(t){let e=0,r=0,o=t.style;if(o&&o.transform&&o.transform!="none"){let n=o.transform.match(/translate(.*)/);if(n){let i=d(n[0].match(/-?\d(.\d+)?/g));e=parseFloat(i[0])||0,r=parseFloat(i[1])||0}}return{x:e,y:r}}function Oe(...t){return t.filter(e=>e).join(" ")}function Es(t,e,r){let o=t/255,n=e/255,i=r/255,s=Math.max(o,n,i),a=Math.min(o,n,i),c=0,l=0,m=.5*(s+a);return s!=a&&(s==o?c=60*(n-i)/(s-a):s==n?c=60*(i-o)/(s-a)+120:s==i&&(c=60*(o-n)/(s-a)+240),m>0&&m<=.5?l=(s-a)/(2*m):l=(s-a)/(2-2*m)),[Math.round(c+360)%360,l,m]}function ie(t){let e=parseInt(t.substr(1,2),16),r=parseInt(t.substr(3,2),16),o=parseInt(t.substr(5,2),16);return[e,r,o]}function sn(t){let e=ie(t);return Es(e[0],e[1],e[2])}function an(t,e){let r=e[3];return[(1-r)*t[0]+r*e[0],(1-r)*t[1]+r*e[1],(1-r)*t[2]+r*e[2]]}var Dt={accent:"#2972E0",link:"#2972E0",topPanelBackground:"#FFFFFF",topPanelText:"#42484E"};function uo(t,e){let[r,o,n]=ie(t);return`rgba(${r}, ${o}, ${n}, ${e})`}function qc(t,e){let[r,o,n]=sn(t);return`hsl(${r}, ${o*100}%, ${(n+e)*100}%)`}function Xc(t=Dt){return{"--color-accent-default":t.accent,"--color-accent-8":uo(t.accent,.08),"--color-accent-16":uo(t.accent,.16),"--color-accent-30":uo(t.accent,.3),"--color-accent-60":uo(t.accent,.6),"--color-accent-80":uo(t.accent,.8),"--color-accent-dark":qc(t.accent,-.08),"--color-link-default":t.link,"--color-link-dark":qc(t.link,-.08),"--color-top-panel-background-default":t.topPanelBackground,"--color-top-panel-text-default":t.topPanelText}}var Bs={headerFontFamily:"Roboto",contentFontFamily:"Roboto"};function jc(t=Bs){return{"--header-font-family":t.headerFontFamily,"--content-font-family":t.contentFontFamily}}var q=null;function Br(){if(!q)throw new Error("semanticColors not initialized");return q}function Zc(t){q={...t,actionCriticalDefault:"#EB5B47",actionCriticalDisabled:"#FCB6AC",actionCriticalHovered:"#E2422C",actionCriticalPressed:"#CB3420",actionPrimaryDefault:t.customAccent,actionPrimaryDisabled:"#C4C7CA",actionPrimaryHovered:It(t.customAccent,0,-1,-4),actionPrimaryPressed:It(t.customAccent,0,-1,-8),actionSliderDefault:"#32353729",actionSliderDisabled:"#C4C7CA",actionToggleDepressedDefault:"#D6D7D7",actionToggleDepressedDisabled:"#EFEFEF",actionToggleDepressedHovered:"#BDBEBF",actionTogglePressedDisabled:er(t.customAccent,.36),actionWarningDefault:"#FB8B28",actionWarningDisabled:"#FEC897",actionWarningHovered:"#EE7B17",actionWarningPressed:"#DF6316",backgroundActive:"#3235370F",backgroundDefault:"#F6F6F7",backgroundHovered:"#3235370A",borderAccentDefault:t.customAccent,borderAccentDisabled:"#C4C7CA",borderAccentHovered:It(t.customAccent,0,-1,-4),borderAccentPressed:It(t.customAccent,0,-1,-8),borderCritical:"#EB5B47",borderDefault:"#D6D7D7",borderDisabled:"#E6E6E7",borderHovered:"#BDBEBF",borderMediaDefault:"#3235371F",borderMediaDisabled:"#32353714",borderMediaHovered:"#32353729",borderOncolorDefault:"#FFFFFF",customPanelHovered:er(t.customTextDefault,.12),customPanelSubdued:er(t.customTextDefault,.08),customTextSubdued:er(t.customTextDefault,.72),decorativeChartEight:"#323537",decorativeChartEleven:"#517CE9",decorativeChartFive:"#CB3420",decorativeChartFour:"#983484",decorativeChartFourteen:"#BDBEBF",decorativeChartNine:"#5DC9B5",decorativeChartOne:"#2984E0",decorativeChartSeven:"#EE5091",decorativeChartSix:"#745CDE",decorativeChartStatusBackground:"#EFEFEF",decorativeChartStatusBackgroundHovered:"#DEDEDFB8",decorativeChartStatusCritical:"#E2422C",decorativeChartStatusCriticalHovered:"#E2422C3D",decorativeChartStatusInProgress:"#2985E0",decorativeChartStatusInProgressHovered:"#2985E03D",decorativeChartStatusSuccess:"#3CB46E",decorativeChartStatusSuccessHovered:"#3CB46E3D",decorativeChartStatusWarning:"#FFC252",decorativeChartStatusWarningHovered:"#FFC2527A",decorativeChartTen:"#EEA811",decorativeChartThirteen:"#33AFBD",decorativeChartThree:"#80B43C",decorativeChartTwelve:"#3CB46E",decorativeChartTwo:"#FB8B28",decorativeCollaborationEight:"#503AB0",decorativeCollaborationFive:"#80B43C",decorativeCollaborationFour:"#983484",decorativeCollaborationNine:"#EEA811",decorativeCollaborationOne:"#1F4198",decorativeCollaborationSeven:"#FB8B28",decorativeCollaborationSix:"#B8195B",decorativeCollaborationTen:"#5C247A",decorativeCollaborationThree:"#EE5091",decorativeCollaborationTwo:"#745CDE",decorativeReactionsOne:"#FEE9F1",dividerBackground:"#3235371F",dividerDefault:"#E6E6E7",dividerOncolor:"#FFFFFF33",focusCritical:"#FFD6D1",focusDefault:er(t.customAccent,.4),focusOncolor:"#FFFFFF",focusWarning:"#FFDEC2",iconAccentDefault:t.customAccent,iconAccentHovered:It(t.customAccent,0,-1,-4),iconAccentPressed:It(t.customAccent,0,-1,-8),iconAlphaDefault:"#323537",iconAlphaDisabled:"#32353752",iconAlphaPlaceholder:"#32353799",iconAlphaSubdued:"#030E1B94",iconCritical:"#E2422C",iconDefault:"#323537",iconDisabled:"#BDBEBF",iconInfo:"#2078CF",iconNew:"#654BD8",iconOncolorDefault:"#FFFFFF",iconOncolorDisabled:"#FFFFFF66",iconOncolorSecondary:"#FFFFFFA3",iconPlaceholder:"#848687",iconSubdued:"#6C737B",iconSuccess:"#389F62",iconWarning:"#FB8B28",indicatorOncolor:"#FFFFFF",indicatorPrimary:t.customAccent,indicatorSpecial:"#EB5B47",indicatorSubdued:"#B2B8BD",overlayBg:"#32353766",overlayBgDark:"#323537DE",overlayBgDefault:"#32353766",overlayBgHovered:"#32353799",overlayBgLight:"#FFFFFFE5",overlayCritical:"#CB3420",overlayDark:"#323537",overlayHovered:"#FFFFFF66",overlayNew:"#654BD8",overlayPressed:"#FFFFFF",overlaySemidark:"#323537DE",overlaySubdued:"#FFFFFF33",surfaceAccentDefault:er(t.customAccent,.12),surfaceAccentHovered:er(t.customAccent,.2),surfaceCriticalDefault:"#FEE4DF",surfaceCriticalHovered:"#FFD6D1",surfaceCriticalSubdued:"#FFF5F5",surfaceDefault:"#FFFFFF",surfaceDisabled:"#3235370A",surfaceHovered:"#3235371F",surfaceInfoDefault:"#D8ECFF",surfaceInfoHovered:"#C7E3FF",surfaceInfoSubdued:"#ECF5FF",surfaceNeutralDefault:"#EFEFEF",surfaceNeutralHovered:"#E6E6E7",surfaceNeutralSubdued:"#F7F7F7",surfaceNewDefault:"#E7E2FE",surfaceNewHovered:"#DED6FC",surfaceNewSubdued:"#F3F0FF",surfacePressed:"#32353729",surfaceSubdued:"#32353714",surfaceSuccessDefault:"#DFF4E8",surfaceSuccessHovered:"#C5ECD5",surfaceSuccessSubdued:"#EFF9F3",surfaceWarningDefault:"#FFEED4",surfaceWarningHovered:"#FFE6C1",surfaceWarningSubdued:"#FFF6E9",textAccentDefault:t.customAccent,textAccentHovered:It(t.customAccent,0,-1,-4),textAccentPressed:It(t.customAccent,0,-1,-8),textAlphaDefault:"#323537",textAlphaDisabled:"#32353752",textAlphaPlaceholder:"#32353766",textAlphaSubdued:"#030E1B94",textCritical:"#E2422C",textDefault:"#323537",textDisabled:"#BDBEBF",textLinkDefault:"#295DE0",textLinkPressed:"#214FC4",textOncolorDefault:"#FFFFFF",textOncolorDisabled:"#FFFFFF66",textOncolorSecondary:"#FFFFFFA3",textPlaceholder:"#ADAEAF",textSubdued:"#6C737B",textSuccess:"#389F63",textWarning:"#FB8B28"},Jt({"--color-action-primary-default":q.actionPrimaryDefault,"--color-action-primary-hovered":q.actionPrimaryHovered,"--color-action-primary-pressed":q.actionPrimaryPressed,"--color-action-toggle-pressed-disabled":q.actionTogglePressedDisabled,"--color-border-accent-default":q.borderAccentDefault,"--color-border-accent-hovered":q.borderAccentHovered,"--color-border-accent-pressed":q.borderAccentPressed,"--color-custom-accent":q.customAccent,"--color-custom-panel-default":q.customPanelDefault,"--color-custom-panel-hovered":q.customPanelHovered,"--color-custom-panel-subdued":q.customPanelSubdued,"--color-custom-text-default":q.customTextDefault,"--color-custom-text-subdued":q.customTextSubdued,"--color-focus-default":q.focusDefault,"--color-icon-accent-default":q.iconAccentDefault,"--color-icon-accent-hovered":q.iconAccentHovered,"--color-icon-accent-pressed":q.iconAccentPressed,"--color-indicator-primary":q.indicatorPrimary,"--color-surface-accent-default":q.surfaceAccentDefault,"--color-surface-accent-hovered":q.surfaceAccentHovered,"--color-text-accent-default":q.textAccentDefault,"--color-text-accent-hovered":q.textAccentHovered,"--color-text-accent-pressed":q.textAccentPressed})}function er(t,e){let[r,o,n]=ie(t);return`rgba(${r}, ${o}, ${n}, ${e})`}function It(t,e,r,o){let[n,i,s]=sn(t),a=(n+e).toFixed(2),c=(i*100+r).toFixed(2),l=(s*100+o).toFixed(2);return`hsl(${a}, ${c}%, ${l}%)`}var cn={accent:Dt.accent,link:Dt.link,topPanelBackground:Dt.topPanelBackground,topPanelText:Dt.topPanelText};function Jc(t){cn.accent=t.accent,cn.link=t.link,cn.topPanelBackground=t.topPanelBackground,cn.topPanelText=t.topPanelText}function Rh(t){let e={...Dt,...t};Jt(Xc(e)),Jc(e),Zc({customAccent:e.accent,customPanelDefault:e.topPanelBackground,customTextDefault:e.topPanelText})}function Dh(t=Bs){Jt(jc(t))}function el(t){Dh(t&&t.baseFonts),Rh(t&&t.baseColors)}function tl({settings:t,topPanelColors:e}){let r={accent:t.design.accentColor};e&&(r.topPanelBackground=e.topPanelBackground,r.topPanelText=e.topPanelText),Jt({"--roll-player-accent-color":t.design.accentColor,"--player-main-font":Ts(t.design.headerFont),"--content-font":Ts(t.design.contentFont)}),el({baseColors:r})}function rl({settings:t,i18nData:e}){tl({settings:t}),$c(t.advanced.direction),Nc(e)}var $={CLICK:"click",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEMOVE:"mousemove",CHANGE:"change",SELECTION_CHANGE:"selectionchange",INPUT:"input",TEXT_INPUT:"textInput",KEY_DOWN:"keydown",KEY_PRESS:"keypress",PASTE:"paste",CUT:"cut",COPY:"copy",BLUR:"blur",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",LOAD:"load",LOAD_END:"loadend",UNLOAD:"unload",BEFOREUNLOAD:"beforeunload",ERROR:"error",DRAG_START:"dragstart",DRAG_OVER:"dragover",DRAG_END:"dragend",RESIZE:"resize",SCROLL:"scroll",COMPOSITIONSTART:"compositionstart",COMPOSITIONUPDATE:"compositionupdate",COMPOSITIONEND:"compositionend",ORIENTATIONCHANGE:"orientationchange",CUSTOM_CONNECTED:"connected",CUSTOM_DISCONNECTED:"disconnected",TRANSITIONEND:"transitionend",TOUCHSTART:"touchstart",VISIBILITYCHANGE:"visibilitychange"};var Mt=class{constructor(e){this.Type=e}};function nl(t,e){return new Promise((r,o)=>{if(t=t,typeof t.arrayBuffer=="undefined"){let n=new FileReader;Xe(n,$.LOAD_END,()=>{n.result||o();let i=n.result;r(ol(i,e))}),Xe(n,$.ERROR,o),n.readAsArrayBuffer(t)}else t.arrayBuffer().then(n=>r(ol(n,e))).catch(o)})}function ol(t,e){let r=new Uint32Array(t.slice(0,Uint32Array.BYTES_PER_ELEMENT))[0],o=new Uint8Array(t.slice(Uint32Array.BYTES_PER_ELEMENT)),{Type:n}=e(r),i=n.decode(o),s=n.toObject(i);return{version:r,data:s}}function il(t,e,r){let o=e[t];return o?ft(o)?{keyValue:o,newKeys:e}:{keyValue:(Rs(o)||o)._,newKeys:o}:(h.error(`key not found: ${t}, path: ${r.join(".")}`),{keyValue:t,newKeys:e})}function sl(t,e,r){for(let o of Object.keys(e)){let{keyValue:n,newKeys:i}=il(o,e,r);if(n===t&&o!=="_")return{key:o,newKeys:i}}return h.error(`cant find value: ${t}, path: ${r.join(".")}`),{key:t,newKeys:e}}var ln=class{constructor(e){this.keys=e}};function W(t){return new ln(t)}function Rs(t){return t instanceof ln?t.keys:null}function tr(t,e,r){if(uc(t))return t.map(n=>tr(n,e,r));let o=Rs(e);if(o)return yc(t,n=>tr(n,d(o),r));if($o(t)){let n={};return zo(t,(i,s)=>{let{key:a,newKeys:c}=sl(s,e,r);n[a]=tr(i,c,[...r,a])}),n}return t}var Ze={TOOLTIP:"tooltip",PLAYER_MAIN:"playerMain",CONTENT:"content"};function We(t,e){return t.find(r=>r.name===e)}function rr(t,e){let r=[...t],o=r.findIndex(n=>n.name===e.name);return o>=0?r[o]=e:r.push(e),r}function dn(t,e){return t.filter(r=>!e.includes(r.name))}function al(t,e){return t.some(r=>r.name===e)}var Ih="$",$e={create(t){return t},add(t,e){return rr(t,e)},compareTextStyles(t,e){return $e.serializeStyles(t)===$e.serializeStyles(e)},serializeStyles(t){return[...t].sort((e,r)=>fs(e.name,r.name)).map(e=>JSON.stringify(e)).join(Ih)},remove(t,e){return dn(t,e)},has(t,e){return al(t,e)}};var z={create(t={}){let{url:e=null,style:r=$e.create([])}=t;return{url:e,style:r}},applyStyle(t,e){return z.create({...t,style:$e.add(t.style,e)})},removeStyles(t,e){return z.create({...t,style:$e.remove(t.style,e)})},hasStyle(t,e){return $e.has(t.style,e)},compare(t,e){return t.url===e.url&&$e.compareTextStyles(t.style,e.style)},setUrl(t,e){return z.create({...t,url:e})},removeUrl(t){return z.create({...t,url:null})}};var un="#",Rr={[un]:un},Mh=1,Ah=2,Oh=4,Fh=8,mn={FONT_SIZE:2,FONT_COLOR:3,TEXT_HIGHLIGHT_COLOR:4,TEXT_HIGHLIGHT_OPACITY:5},Ph="#";function At(t){return t===Ph}function cl(t){if(typeof t=="object"&&t&&t.hasOwnProperty(un)){let e=t[un],r=[],o=e.length&&!At(e[0])&&typeof e[0]=="number"&&!isNaN(e[0])?e[0]:void 0,n=e.length&&!At(e[0])&&ft(e[0])?e[0]:e.length>1&&!At(e[1])&&ft(e[1])?e[1]:void 0,i=e[mn.FONT_SIZE],s=e[mn.FONT_COLOR],a=e[mn.TEXT_HIGHLIGHT_COLOR],c=e[mn.TEXT_HIGHLIGHT_OPACITY];return!At(o)&&typeof o=="number"&&!isNaN(o)&&(o&Mh&&r.push({name:"bold"}),o&Ah&&r.push({name:"italic"}),o&Oh&&r.push({name:"underline"}),o&Fh&&r.push({name:"strikethrough"})),!At(i)&&(typeof i=="number"||i==="auto")&&r.push({name:"fontSize",size:i}),!At(s)&&ft(s)&&r.push({name:"fontColor",color:s}),!At(a)&&ft(a)&&r.push({name:"textHighlightColor",color:a}),!At(c)&&typeof c=="number"&&!isNaN(c)&&r.push({name:"textHighlightOpacity",opacity:c}),z.create({style:$e.create(r),url:n})}}var pn={text:"t",meta:{_:"m",...Rr},length:"l"},oe={key:"k",type:"t",viewType:"v",textAlign:"tA",characters:{_:"c",...pn},isOrderedListFirstItem:"iO"},Dr={type:"t",src:"s",key:"k",width:"w",height:"h",alignment:"a",characters:{_:"c",...pn},isBlob:"iB"},Te={type:"t",src:"s",key:"k",width:"w",height:"h",alignment:"a",characters:{_:"c",...pn}},ve={type:"t",src:"s",key:"k",fileName:"fn",fileExtension:"fe",fileSize:"fs",isLoading:"iL"},Ot={key:"k",type:"t",characters:{_:"c",...pn},noteType:"nT"};var Ir={crop:{_:"cp",top:"tp",left:"lf",right:"rt",bottom:"bm"}};var Nh={...Dr,parentCollageKey:"cK"},fn={type:"t",key:"k",alignment:"a",images:{_:"is",...Nh,length:"l"}},Ue={...fn,images:{...fn.images,...Ir}};var Mr={blockMap:{_:"b",order:{_:"o",length:"l"},blocks:W({_:"B",...oe})}};var Lh={type:"t",width:"w",height:"h",src:"s"},$h={choices:{_:"ch",key:"k",content:{_:"c",...Mr},correct:"cr",length:"l"}},Kh={caseSensitive:"cs",answers:{_:"a",key:"k",text:"t",length:"l"}},Hh={type:"t",correct:{_:"c",...Mr},incorrect:{_:"i",...Mr},answered:{_:"a",...Mr}},Vh={key:"k",type:"t",description:{_:"d",...Mr},attachment:{_:"a",...Lh},content:{_:"c",...$h,...Kh},feedback:{_:"f",...Hh}},or={type:"t",key:"k",settings:{_:"ss",includeInProgress:"iip",shuffleAnswers:"sa",showCorrectAnswers:"sca"},questions:{_:"q",...Vh}},po={...or,questions:{...or.questions,attachment:{...or.questions.attachment,...Ir}}},ot={...po,questions:{...po.questions,attachment:{...po.questions.attachment,title:"tl",previewSrc:"pws"}}};var ll={name:"n",color:"c",opacity:"o"},Wh={...ll,data:{_:"md",...Rr}},dl={key:"k",content:{_:"C",...oe,...Dr},meta:{_:"m",...ll}},Uh={...dl,verticalTextAlign:"vta",meta:{_:"m",...Wh}},zh={colsMap:W({_:"cM",...dl})},Gh={colsMap:W({_:"cM",...Uh})},fo={key:"k",type:"t",alignment:"a",colsOrder:"cO",rowsOrder:"rO",rowsMap:W({_:"rM",...zh}),meta:{_:"m",name:"n"}},ml={...fo,rowsMap:W({_:"rM",...Gh})};var ul={blockMap:{_:"b",order:{_:"o",length:"l"},blocks:W({_:"B",...oe,...Dr,...Te,...ve,...or})}},Qh={header:{_:"h",kicker:"k",title:"t",coverInfoState:{_:"c",src:"s",width:"w",height:"h",color:"c",opacity:"o",isBlob:"i"}},contentState:{_:"cs",...ul}},Yh={key:"k",header:{_:"h",title:"t"},contentState:{_:"cs",...ul}},pl={intro:{_:"i",...Qh},chapters:{_:"c",order:{_:"o",length:"l"},blocks:W({_:"B",...Yh})}},hn={main:{_:"m",navigationType:"nT",numberingEnabled:"nE",nextButtonEnabled:"nbE",copyingEnabled:"cE"},design:{_:"d",accentColor:"aC",headerFont:"hF",contentFont:"cF"}};var fl={blockMap:{_:"b",order:{_:"o",length:"l"},blocks:W({_:"B",...oe,...Te,...ve,...fn,...or})}},qh={header:{_:"h",kicker:"k",title:"t",coverInfoState:{_:"c",src:"s",width:"w",height:"h",color:"c",opacity:"o",isBlob:"i"}},contentState:{_:"cs",...fl}},Xh={key:"k",header:{_:"h",title:"t"},contentState:{_:"cs",...fl}},hl={intro:{_:"i",...qh},chapters:{_:"c",order:{_:"o",length:"l"},blocks:W({_:"B",...Xh})}},gn=hn;var gl={blockMap:{_:"b",order:{_:"o",length:"l"},blocks:W({_:"B",...oe,...Te,...ve,...Ue,...po})}},jh={header:{_:"h",kicker:"k",title:"t",coverInfoState:{_:"c",src:"s",width:"w",height:"h",color:"c",opacity:"o",isBlob:"i"}},contentState:{_:"cs",...gl}},Zh={key:"k",header:{_:"h",title:"t"},contentState:{_:"cs",...gl}},yl={intro:{_:"i",...jh},chapters:{_:"c",order:{_:"o",length:"l"},blocks:W({_:"B",...Zh})}},yn=gn;var _l={blockMap:{_:"b",order:{_:"o",length:"l"},blocks:W({_:"B",...oe,...Te,...ve,...Ue,...ot})}},Jh={header:{_:"h",kicker:"k",title:"t",coverInfoState:{_:"c",src:"s",width:"w",height:"h",color:"c",opacity:"o",isBlob:"i"}},contentState:{_:"cs",..._l}},eg={key:"k",header:{_:"h",title:"t"},contentState:{_:"cs",..._l}},Cl={intro:{_:"i",...Jh},chapters:{_:"c",order:{_:"o",length:"l"},blocks:W({_:"B",...eg})}},_n=yn;var kl={blockMap:{_:"b",order:{_:"o",length:"l"},blocks:W({_:"B",...oe,...Te,...ve,...Ue,...ot,...Ot})}},tg={header:{_:"h",kicker:"k",title:"t",coverInfoState:{_:"c",src:"s",width:"w",height:"h",color:"c",opacity:"o",isBlob:"i"}},contentState:{_:"cs",...kl}},rg={key:"k",header:{_:"h",title:"t"},contentState:{_:"cs",...kl}},Sl={intro:{_:"i",...tg},chapters:{_:"c",order:{_:"o",length:"l"},blocks:W({_:"B",...rg})}},Cn=_n;var xl={blockMap:{_:"b",order:{_:"o",length:"l"},blocks:W({_:"B",...oe,...Te,...ve,...Ue,...ot,...Ot,...fo})}},og={header:{_:"h",kicker:"k",title:"t",coverInfoState:{_:"c",src:"s",width:"w",height:"h",color:"c",opacity:"o",isBlob:"i"}},contentState:{_:"cs",...xl}},ng={key:"k",header:{_:"h",title:"t"},contentState:{_:"cs",...xl}},kn={intro:{_:"i",...og},chapters:{_:"c",order:{_:"o",length:"l"},blocks:W({_:"B",...ng})}},ho=Cn;var bl=kn,Sn={...ho,main:{...ho.main,longreadType:"lT"}};var Ds={color:"c",opacity:"o"},Tl={src:"s",width:"w",height:"h",overlay:{_:"o",...Ds},...Ir},vl={type:"t",image:{_:"i",...Tl},overlay:{_:"O",...Ds},...Ds},Is={type:"t",image:{_:"i",...Tl},text:{_:"rt",...oe},verticalTextAlign:"vta",background:{_:"b",...vl}},wl={...Is,meta:{_:"m",name:"n",data:{_:"md",...Rr}}},El={key:"k",frontSide:{_:"fs",...Is},backSide:{_:"bs",...Is}},ig={...El,frontSide:{_:"fs",...wl},backSide:{_:"bs",...wl}},xn={key:"k",type:"t",cardsBlockMap:{_:"cbm",order:{_:"o",length:"l"},blocks:W({_:"B",...El})},maxCardsInRow:"mcir",cardsLayout:"cl",background:{_:"b",...vl}},Bl={...xn,cardsBlockMap:{...xn.cardsBlockMap,blocks:W({_:"B",...ig})}};var Rl={blockMap:{_:"b",order:{_:"o",length:"l"},blocks:W({_:"B",...oe,...Te,...ve,...Ue,...ot,...Ot,...fo,...xn})}},sg={header:{_:"h",kicker:"k",title:"t",coverInfoState:{_:"c",src:"s",width:"w",height:"h",color:"c",opacity:"o",isBlob:"i"}},contentState:{_:"cs",...Rl}},ag={key:"k",header:{_:"h",title:"t"},contentState:{_:"cs",...Rl}},Dl={intro:{_:"i",...sg},chapters:{_:"c",order:{_:"o",length:"l"},blocks:W({_:"B",...ag})}},bn=Sn;var Il={blockMap:{_:"b",order:{_:"o",length:"l"},blocks:W({_:"B",...oe,...Te,...ve,...Ue,...ot,...Ot,...ml,...Bl})}},cg={header:{_:"h",kicker:"k",title:"t",coverInfoState:{_:"c",src:"s",width:"w",height:"h",color:"c",opacity:"o",isBlob:"i"}},contentState:{_:"cs",...Il}},lg={key:"k",header:{_:"h",title:"t"},contentState:{_:"cs",...Il}},wn={intro:{_:"i",...cg},chapters:{_:"c",order:{_:"o",length:"l"},blocks:W({_:"B",...lg})}},Tn=bn;var Ml=wn,Al={...Tn,advanced:{_:"a",direction:"d"}};function mg(t){switch(t){case 4:return hn;case 5:return gn;case 6:return yn;case 7:return _n;case 8:return Cn;case 9:return ho;case 10:return Sn;case 11:return bn;case 12:return Tn;case 13:return Al;default:throw Error(`cannot decode json document with version ${t}`)}}function Ol(t,e){let r=mg(e);return tr(t,r,[])}var Ar=class{static create({itemKey:e,captionSelected:r}){return{collageSelectedItemKey:e||"",collageItemCaptionSelected:r||!1}}};var nt=class{static createBlockSelection(){return{type:"flipCardBlock"}}static createCardTextSelection(e,r){return{type:"flipCardText",cardKey:e,cardSide:r}}static isBlockSelection(e){return e.customSelection&&e.customSelection.type==="flipCardBlock"}static isCardTextSelection(e){return e.customSelection&&e.customSelection.type==="flipCardText"}};var Or=class{static create(e={}){return{noteTextSelected:e.noteTextSelected||!1}}static textSelected(e){return e.customSelection&&e.customSelection.noteTextSelected}};var se=class{static createCellSelection(e){return{type:"cell",cellKey:e.cellKey,rowKey:e.rowKey,colKey:e.colKey}}static createRowSelection(e){return{type:"row",rowKey:e.rowKey}}static createColumnSelection(e){return{type:"column",colKey:e.columnKey}}static createTableSelection(){return{type:"table"}}static isCellSelected(e){return e.customSelection&&e.customSelection.type==="cell"}static isColumnSelected(e){return e.customSelection&&e.customSelection.type==="column"}static isRowSelected(e){return e.customSelection&&e.customSelection.type==="row"}static isTableSelected(e){return e.customSelection&&e.customSelection.type==="table"}};var _={isCollapsed(t){return t.startKey==t.endKey&&t.startOffset==t.endOffset},isEqual(t,e){return t==e?!0:!t||!e?!1:t.startKey==e.startKey&&t.startOffset==e.startOffset&&t.endKey==e.endKey&&t.endOffset==e.endOffset&&t.isBackward==e.isBackward&&JSON.stringify(t.customSelection)==JSON.stringify(e.customSelection)},create(t={}){return{startKey:t.startKey||"",startOffset:t.startOffset||0,endKey:t.endKey||"",endOffset:t.endOffset||0,isBackward:t.isBackward||!1,customSelection:t.customSelection||null}},createCollapsed({key:t,offset:e,customSelection:r}){return _.create({startKey:t,startOffset:e,endKey:t,endOffset:e,customSelection:r})},createAttachmentBlockSelection(t){return _.create({startKey:t,startOffset:0,endKey:t,endOffset:0})},createMediaBlockSelection(t){return _.create({startKey:t,startOffset:0,endKey:t,endOffset:0,customSelection:{captionSelected:!1}})},createCollageBlockSelection(t){return _.create({startKey:t,startOffset:0,endKey:t,endOffset:0,customSelection:Ar.create({})})},createNoteBlockSelection(t){return _.create({startKey:t,startOffset:0,endKey:t,endOffset:0,customSelection:Or.create()})},createTableBlockSelection(t){return _.create({startKey:t,startOffset:0,endKey:t,endOffset:0,customSelection:se.createTableSelection()})},createTableRowSelection(t,e){return _.create({startKey:t,startOffset:0,endKey:t,endOffset:0,customSelection:se.createRowSelection({rowKey:e})})},createTableColumnSelection(t,e){return _.create({startKey:t,startOffset:0,endKey:t,endOffset:0,customSelection:se.createColumnSelection({columnKey:e})})},createFlipCardsBlockSelection(t){return _.create({startKey:t,startOffset:0,endKey:t,endOffset:0,customSelection:nt.createBlockSelection()})}};var Fl={},ug=Math.pow(2,24);function As(){let t;for(;t===void 0||Fl.hasOwnProperty(t)||!isNaN(+t);)t=Math.floor(Math.random()*ug).toString(32);return Fl[t]=!0,t}var Ms=new WeakMap;function Pl(t){return Ms.has(t)||Ms.set(t,As()),Ms.get(t)}function v(){return As()}function pg(t,e={}){e.current=t}hyperHTML.define("save-ref",pg);var Nl=new WeakMap;function fg(t,e){let r=Nl.get(t)||Nl.set(t,{}).get(t);for(let o of Object.keys(e))if(o.slice(0,2)==="on"&&r[o]!==e[o]){let i=o.slice(2);r[o]&&t.removeEventListener(i,r[o]),r[o]=e[o],r[o]&&t.addEventListener(i,r[o],{passive:!0})}return""}hyperHTML.define("passive-events",fg);var D=hyperHTML.wire;if(!1){let t=new WeakMap;D=(e,r="__default__")=>{e=e||{},t.has(e)||t.set(e,{});let o=t.get(e);if(!o[r]){let n=hyperHTML.wire(e,r),i;o[r]=function(s,...a){return i||(i=s),i!=s&&s.join("_")==i.join("_")&&(s=i),d(o)[r].__tmp.history.push([s,...a]),n(s,...a)},o[r].__tmp={obj:e,id:r,history:[]}}return o[r]}}var iw=hyperHTML.bind;var Ce=_e.requestAnimationFrame||_e.mozRequestAnimationFrame||_e.webkitRequestAnimationFrame||_e.msRequestAnimationFrame||setTimeout,hg=_e.cancelAnimationFrame||_e.mozCancelAnimationFrame||_e.webkitCancelAnimationFrame||_e.msCancelAnimationFrame||clearTimeout,cw=_e.requestIdleCallback||gg,lw=_e.cancelIdleCallback||yg;function gg(t){let e=Date.now();return setTimeout(()=>{t({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-e))}})},1)}function yg(t){clearTimeout(t)}function Ll(t,e){let r=e?t.bind(e):t,o;function n(){hg(o),o=null}function i(){o&&n(),o=Ce(r)}function s(){return o!=null}return{call:i,cancel:n,isSheduled:s}}function _g(t,e){if(typeof t.className=="string"){t.className=e;return}t.className.baseVal=e}function Cg(t){return typeof t.className=="string"?t.className:t.className.baseVal}function kg(t){if(t.classList)return t.classList;let e=t.className;return ft(e)&&e.match(/\S+/g)||[]}function Sg(t,e){return t.classList?t.classList.contains(e):kg(t).includes(e)}function $l(t,e){if(t instanceof Element){if(t.classList){t.classList.add(e);return}if(!Sg(t,e)){let r=Cg(t),o="";r&&(o=`${r} `),_g(t,o+e)}}}var _t=new Map,Os=null;function Kl(){return Os||(Os=new MutationObserver(t=>{for(let e of t){for(let r of e.removedNodes)for(let o of _t.keys()){let n=d(_t.get(o));n.remove&&!!r.contains&&r.contains(o)&&n.remove()}for(let r of e.addedNodes)for(let o of _t.keys()){let n=d(_t.get(o));n.add&&!!r.contains&&r.contains(o)&&n.add()}}})),Os}function Hl(t,e){let r=_t.size==0;return h.assert(!_t.has(t)),_t.set(t,e),r&&Kl().observe(document,{subtree:!0,childList:!0}),()=>{_t.delete(t),_t.size==0&&Kl().disconnect()}}var Vl="renderBinding",C=(t,e=void 0,r=void 0)=>{let o=()=>[t,e,r];return o._meta=Vl,o},nr=(t,e,r=void 0,o=void 0)=>({id:typeof t=="string"?t:Pl(t),binding:C(e,r,o)});function Wl(t){return typeof t=="function"&&t._meta==Vl}function vn(t){return Object.freeze({initialValue:t})}function En(t,e,r){let o=t.get(e);if(!(o&&o.value===r)){if(Fs.set(e,!0),o){o.value=r;return}t.set(e,{value:r})}}function Ul(t,e){return t.has(e)?t.get(e).value:e.initialValue}function zl(){Fs.clear()}var Fs=new Map;function Gl(t){for(let e of t.keys())if(Fs.has(e))return!0;return!1}var Ql=[],Yl=[];function ql(t){for(let e of t){e.clear&&e.clear();try{e.clear=e.callback(),e.clear&&typeof e.clear!="function"&&(h.error("useEffect's callback should return a function"),e.clear=void 0)}catch(r){console.log(r)}}t.length=0}function Xl(){ql(Yl)}function Bn(){ql(Ql)}function jl(t){t.clear&&(t.clear(),t.clear=null),t.sync?Ql.push(t):Yl.push(t)}var Ps=null,Ls=new Map;function $s(){if(!Ps){let{call:t}=Ll(Ks);Ps=t}Ps()}var Ns=!1,Rn=!1;function Ks(){if(Ns)return;if(Ns=!0,Xl(),Ns=!1,Rn){h.error("render was already started"),$s();return}Rn=!0,zl();let t=Ls;Ls=new Map;for(let e of t.keys())try{e()}catch(r){console.log(r)}Bn(),Rn=!1}function Dn(t){Ls.set(t,!0),$s()}function Zl(){return Rn}function Hs(t){jl(t),t.sync||$s()}var Ft=new Map,ir=[];function Jl(t,e){if(ir.push({redrawFn:t,contextMap:e}),Ft.has(t)){let r=d(Ft.get(t));r.hookIndex=0,r.effectIndex=0}}function ed(t){let e=d(ir.pop()),r=Ft.get(e.redrawFn);if(r){if(h.assert(t instanceof Element),r.connected)h.assert(r.firstRenderHooksCount==r.hookData.length,`Incorrect hooks count
expected: ${r.firstRenderHooksCount}
actual: ${r.hookData.length}`),h.assert(r.firstRenderEffectsCount==r.effects.length,`Incorrect effects count
expected: ${r.firstRenderEffectsCount}
actual: ${r.effects.length}`);else{r.connected=!0;for(let o of r.effects)Hs(o);r.firstRenderHooksCount=r.hookData.length,r.firstRenderEffectsCount=r.effects.length}return!0}return!1}function td(t){let e=Ft.get(t);if(e){for(let r of e.effects)r.clear&&r.clear();Ft.delete(t)}}function Vs(){if(!ir.length)throw new Error("Hooks can be used only in render functions");let t=d(ir[ir.length-1]).redrawFn;return Ft.has(t)||Ft.set(t,{hookIndex:0,hookData:[],effectIndex:0,effects:[],redraw:t,connected:!1}),d(Ft.get(t))}var Q=t=>{!1&&t!=null&&typeof t=="object"&&h.error("useState: you should use lazy initialization for complex types");let e=Vs(),r=e.hookIndex;if(e.hookData.length==r){let o=i=>{typeof i=="function"&&(i=i(e.hookData[r][0])),e.hookData[r][0]=i,Dn(e.redraw)},n=typeof t=="function"?t():t;!1&&typeof n=="function"&&h.error("useState: do not store functions in state"),e.hookData.push([n,o])}return++e.hookIndex,e.hookData[r]};function B(t){let e=Vs(),r=e.hookIndex;if(e.hookData.length==r){let n={current:t};e.hookData.push(n)}let o=e.hookData[r];return++e.hookIndex,o}function rd(t,e,r){let o=Vs(),n=o.effectIndex;if(o.effects.length==n){let s={callback:t,sync:r,clear:null,deps:e};o.effects.push(s)}else{let s=o.effects[n];s.callback=t}let i=o.effects[n];o.connected&&(!e||!hs(d(i.deps),e))&&Hs(i),i.deps=e,++o.effectIndex}function H(t,e){rd(t,e,!1)}function J(t,e){rd(t,e,!0)}function xg(t){let e=B();return H(()=>{e.current=t},[t]),e.current}function Fe(t,e){let r=B(),o=xg(e);return(!o||!hs(o,e))&&(r.current=t()),r.current}function Z(t,e){return Fe(()=>t,e)}function it(t){return Ul(ir[ir.length-1].contextMap,t)}function In(...t){}var Ws=new Map,Mn=new WeakMap;function bg(t,e){return t===e?!0:typeof t=="object"&&typeof e=="object"&&Uo(t,e)}function Ct(t,e,r=new Map,o,n="html"){let i=e?`${e}`:"__root";Ws.has(t)||Ws.set(t,{});let s=Ws.get(t);if(!s[i]){let a=D(void 0,n),c=0,l=new Map(r),m=0,u=[],g=[],b=null,N=new Map,I=new Map,R=(y,...k)=>{if(Wl(y)||y==null){let L=k[0];return R.switch(()=>y,L)}else if(typeof y=="function"){let L=k[0],j=k[1];return R._getHtmlWireResultWithOptimizations(`_c${++c}`,y,L,j)}b&&!Object.is(y,b)&&h.warn("Template literal was changed"),b=y;let w=a(y,...k);return w.__clearCache=()=>{a=D(void 0,n)},R._finishRender(),o&&(o.current=w),w};R.contextMap=r,R.switch=(y,k)=>{u[m]||(u[m]=new Map);let w=u[m],L=g[m],j=y();if(!j)return++m,null;let[ce,He,De]=j();if(!w.get(ce)){let re=w.has(ce)?[...w.keys()].indexOf(ce):w.size;w.set(ce,zs(ce,R._createChild(`_u${m}_${re}`,n),l,k,De))}return++m,L&&L.delete(ce),d(w.get(ce))(He)},R.renderAll=(y,k)=>{let w=[],L=new Set;return y.forEach((j,ce)=>{let He=k(j,ce);if(He){let{id:De,binding:io}=He,re=De;for(;L.has(De);)De=`${De}_copy`;L.add(De),re!=De&&h.error(`duplicated child id: ${re}`);let[xr,so,ao]=io();De||(h.error("unexpected error: empty id in render all"),De=`_c${++c}`),w.push(R._getHtmlWireResultWithOptimizations(De,xr,so,ao))}}),w},R.toSvgMode=()=>{let y=R._createChild(`_c${++c}`,"svg");return R._finishRender(),y},R.setRenderTypeForChildren=y=>{n=y},R._createChild=(y,k)=>Ct(t,(e||"")+y,l,void 0,k),R._getHtmlWireResultWithOptimizations=(y,k,w,L)=>{let j=R._createChild(y,n);if(N.has(j))I.delete(j);else{let He=zs(k,j,l,L);N.set(j,He)}return d(N.get(j))(w)},R._finishRender=()=>{if(I.size)for(let y of I.keys()){let k=N.get(y);k?(k.clean(),N.delete(y)):h.warn("clean child error")}for(let y=0;y<g.length;++y){let k=g[y];for(let w of k.keys()){let L=k.get(w);L?(L.clean(),u[y].set(w,null)):L!==null&&h.warn("clean child error")}}I=new Map(N),g=u.map(y=>new Map(y)),c=0,m=0},R.renderIf=function(y,k,w){let L=k();return L?R(y,L,w):(++c,null)},R.setContext=(y,k)=>(En(l,y,k),R),R.clean=function(){R.clean=()=>console.log("clean already complete"),s[i]=null;for(let y of N.values())y.clean();for(let y of u)for(let k of y.values())k&&k.clean();N.clear(),I.clear()},s[i]=R}return s[i]}function Pt(t,e,r){let[o,n,i]=e(),s=o(t,n);return s instanceof Element&&Us(s,i),r&&(r.current=s),s}function Us(t,e){if(!e)return;let r=String(e);if(r.includes(" ")){h.error(`multiple classNames not allowed: ${r}`);return}$l(t,r)}function zs(t,e,r=new Map,o="",n=""){let i,s=null,a=typeof o=="string"||o.___css?{className:String(o)}:o,c=!1;function l(){if(c)return;Jl(l,d(r));let u=t(e,i),g=ed(u);return s&&g?s!=u&&window.console.error(`[${t.name}] dom element was changed`):s=u,s instanceof Element&&(Us(s,a.className),Us(s,n)),a.ref&&(a.ref.current=s),u}function m(u){return!Gl(d(r))&&bg(i,u)&&s?s:(i=u,d(l()))}return m.clean=function(){c=!0,td(l),e.clean()},m}function wg(t,e,r=Ct(e),o=new Map){let n=Mn.has(r);n||Mn.set(r,zs(t,r,o));let i=Mn.get(r),s=i(e);if(!n){let a=Hl(s,{remove:()=>{document.body.contains(s)||(i.clean(),a(),Mn.delete(r))}})}return s.hasAttribute(gt)||s.setAttribute(gt,"true"),Ce(Bn),s}function ae(t){return(r,o)=>{let n=o&&o.contextMap;return wg(t,r,o,n)}}function od(t,e,r=e){let o=ae(t),n=Ct(r),i=!0;return s=>{if(i){let a=o(s,n);e(a),i=!1}else Dn(()=>{o(s,n)})}}function An(){let[,t]=Q(!0);return Z(()=>t(e=>!e),[])}var le=class{constructor(e,r=null){this._block=e,this._element=r}className(){return this._element?`${this._block}__${this._element}`:this._block}getModifierClassName(e){return`${this.className()}_${e}`}getModifierWithValueClassName(e,r){return`${this.getModifierClassName(e)}_${r}`}createChildElementBemInfo(e){return d(!this._element),new le(this._block,e)}};function Y(t,e={}){let r=t.map(n=>n instanceof le?n:new le(n)),o=r.map(n=>n.className());for(let n of Object.keys(e)){let i=e[n];for(let s of r)i==null?o.push(s.getModifierClassName(n)):o.push(s.getModifierWithValueClassName(n,i))}return o.join(" ")}var Nt={SPAN:"SPAN",DIV:"DIV",SVG:"SVG",H1:"H1",H2:"H2",H3:"H3",H4:"H4",H5:"H5",H6:"H6",UL:"UL",OL:"OL",LI:"LI",P:"P",BR:"BR",B:"B",STRONG:"STRONG",I:"I",EM:"EM",A:"A",U:"U",S:"S",STRIKE:"STRIKE",IMG:"IMG",IFRAME:"IFRAME",BLOCKQUOTE:"BLOCKQUOTE",FIGURE:"FIGURE",FIGCAPTION:"FIGCAPTION",LINK:"LINK",CANVAS:"CANVAS",INPUT:"INPUT",BUTTON:"BUTTON",TABLE:"TABLE",TD:"TD"};function U(t,e){if(!e.hasOwnProperty(t))throw new Error(`getValueByCheckedKey(${t})`);return e[t]}var Gs={};function Fr(t){return Gs[t]||(Gs[t]={}),Gs[t]}!1&&(window.top.__HYPER_HTML_MODE__="development");var Qs="_ismeta";function Ys(t){let e=window.top.__ON_UPDATE_ELEMENT__;e&&e(t)}function qs(){let t=window.top.__UPDATE_ELEMENTS__;t&&t()}function On(t,e){!1&&!t[Qs]&&(t[Qs]={...t[Qs],...e})}function Xs(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{let e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}var Tg=[$.CLICK],Nr=new Map,js=new Map,Pr=!1,id=!1,vg=()=>null;function sd(){Eg(),Ce(sd)}Ce(sd);function Eg(){if(Nr.size&&!id){Pr=!0;for(let t of Nr.keys())t._redraw();Pr=!1,Nr.clear()}}function Bg(t){Nr.set(t,!0)}function nd(t){Nr.delete(t)}function Rg(t){return Nr.has(t)}var O=class extends Ae{constructor({bemInfo:e,blockName:r,block:o=r,relatedData:n,direction:i="ltr"}){super(),this._bemInfoArray=[],(e||o)&&this._addBemInfo(d(e||o)),this._childElements=null,this._childElementsRef=null,this._relatedData=n||this,this._modifiers={},this._browserEventSignals=null,this._domElement=null,this._onDidRedraw=null,this._onDomElementReCreatedCallback=null,this._childContext=new Map,this._direction=i}setDirection(e){this._direction=e}_setContext(e,r){En(this._childContext,e,r)}static renderInProgress(){return Pr}static suspend(e){id=e}domElement(){if(Rg(this)){let e=Pr;Pr=!0,this._redraw(),Pr=e}return this._domElement?this._domElement:(this._redraw(),this.domElement())}onDidRedraw(){return this._onDidRedraw||(this._onDidRedraw=this._createSignal()),this._onDidRedraw}updateModifier(e,r){r?typeof r=="string"?this._modifiers[e]=r:r&&(this._modifiers[e]=null):delete this._modifiers[e],this._sheduleRender()}hasModifier(e){return Object.keys(this._modifiers).includes(e)}handleEvent(e){if(e.defaultPrevented&&Tg.includes(e.type))return;let r=this._getBrowserEventSignalIfExists(e.type);r&&r.dispatch(e)}createChildBemInfo(e){return d(this._bemInfoArray[0]).createChildElementBemInfo(e)}addBemInfo(e,r){this._addBemInfo(e,r),this._sheduleRender()}setOnDomElementReCreatedCallback(e){this._onDomElementReCreatedCallback=e}clearCache(){this._relatedData={},this._sheduleRender()}_sheduleRender(){Bg(this)}_redraw(){nd(this);let e=this._render();if(e!=this._domElement){let r=this._domElement;this._domElement=e,r&&(this._onDomElementReCreatedCallback?this._onDomElementReCreatedCallback():h.error(`[${this.constructor.name}] component element was changed`))}!1&&(e.component=this),this._onDidRedraw&&document.body.contains(this._domElement)&&this._onDidRedraw.dispatch()}_getBrowserEventSignalIfExists(e){return this._browserEventSignals&&this._browserEventSignals[e]||null}_getBrowserEventSignal(e){return this._browserEventSignals||(this._browserEventSignals={}),this._browserEventSignals[e]||(this._browserEventSignals[e]=this._createSignal(),this._sheduleRender()),this._browserEventSignals[e]}_activeListenerExists(e){let r=this._getBrowserEventSignalIfExists(e);return!!r&&r.handlersCount()>0}_getHandler(e){return this._activeListenerExists(e)?this:null}_addBemInfo(e,r){e instanceof le||(e=new le(e,r)),this._bemInfoArray.push(e)}_getCssClasses(){return this._bemInfoArray?Y(this._bemInfoArray,this._modifiers):""}_wasRendered(){return!!this._domElement}_html(e,...r){return this._generateElement("",e,...r)}_renderFunctionEx(e){return this._childElementsRef||(this._childElementsRef={}),this._childElementsRef[e]||(this._childElementsRef[e]={}),Ct(this._relatedData,e,this._childContext,this._childElementsRef[e])}_childHtml(e){js.has(this)||js.set(this,{});let r=js.get(this);return r[e]||(r[e]=(o,...n)=>typeof o=="string"?this._childHtml(e+o):this._generateElement(e,o,...n),r[e].optional=(o,n)=>n?r[e](o):vg,!1&&(r[e].__hyperId=e)),r[e]}_getChildClass(e){return this.createChildBemInfo(e).className()}_getChildElement(e){if(this._childElementsRef&&this._childElementsRef[e])return d(this._childElementsRef[e].current);this.domElement();let r=this._childElements;return r&&r[e]||null}_generateElement(e,r,...o){let n=a=>a.map((c,l)=>{if(c instanceof le)c=c.className();else if(c instanceof Ie)c=c.dispatch.bind(c);else if(typeof c=="function")c=c.bind(this);else{if(c==this)return c.handleEvent.bind(this);if(c&&c!=this&&typeof c.domElement=="function")return typeof c.setOnDomElementReCreatedCallback=="function"&&c.setOnDomElementReCreatedCallback(()=>this._redraw()),this._addDisposable(c),c.domElement();if(Array.isArray(c))return n(c)}if(r[l]&&r[l].endsWith("passive-events="))for(let m of Object.keys(c))typeof c[m]=="function"&&(c[m]=c[m].bind(this));return c});o=n(o);let i=e&&`:${e}`,s=D(this._relatedData,i)(r,...o);if(e){if(this._childElements=this._childElements||{},!1){let a=this._childElements[e];a?(d(a==s,`[${this.constructor.name}] component child('${e}') element was changed`),Ys(a)):(On(s,{id:Xs(),renderer:`${this.constructor.name}: ${e}`}),qs())}this._childElements[e]=s}else!1&&(this._domElement?Ys(this._domElement):(On(s,{id:Xs(),renderer:this.constructor.name}),qs()));return!1&&On(s,{renderArgs:[r,...o]}),s}_render(){}_destruct(){nd(this),super._destruct()}};var ad=null,cd=null;function Lt(t){if(!t.length||t.startsWith("data:")||t.startsWith("blob:"))return t;let e=t;return ad&&(e=`${ad}${t}`),cd&&(e=cd(e)),e}var Dg=.76;function ld(t,e,r){let o=[...ie(t),e],n=an([255,255,255],o),[,,i]=Es(n[0],n[1],n[2]);return i<=r?"light":"dark"}function Ig({setStyle:t,background:e,lightnessLimitValue:r}){let o=new FastAverageColor,n=Lt(e.imageSrc);o.getColorAsync(n).then(i=>{i.error||t(ld(i.hexa,1,r))}),o.destroy()}function Lr({background:t,lightnessLimitValue:e=Dg,setStyle:r}){if(!t)return"light";t.type==="color"?r(ld(t.color,t.opacity,e)):t.type==="image"&&Ig({background:t,lightnessLimitValue:e,setStyle:r})}function go(t){return t?t.type==="color"?{type:"color",color:t.color,opacity:t.opacity}:{type:"image",imageSrc:t.image.src}:null}function dd(t){return t?{type:"image",imageSrc:t.src}:null}function Fn(t){t.stopPropagation()}function sr(t){zo(t,(e,r)=>{rt(e),delete t[r]})}var Mg=["png","jpg","jpeg","gif"];function md(){return Mg.slice()}var Ag="id";function ee(t){if(!!t)return typeof t=="string"&&(t={[Ag]:t}),Object.entries(t).filter(([e,r])=>Ko(r)).map(([e,r])=>`${e}=${r}`).join(";")}function ne(){return B()}function ud(){return B()}var Og={input:"x33b88__input"};function Pn(t,{browseRef:e,onChange:r,accept:o,multiple:n,autotestId:i}){let s=ud();J(()=>{e.current=()=>s.current.click()},[e,s]);function a(){let l=s.current,m=l.files?[...l.files]:[];l.value="",r(m)}function c(l){l.stopPropagation()}return t`
<input
	save-ref=${s}
	class=${Og.input}
	type='file'
	accept=${o==null?void 0:o.join(", ")}
	multiple=${n}
	onchange=${a}
	onclick=${c}
	data-at=${ee(i)}
>`}function pd(){return B(()=>{})}function Nn(t){return{browseRef:pd(),accept:md().map(r=>`.${r}`),onChange:r=>{r.length&&t(r[0])}}}function fd(t){return t`
<svg width="160" height="160" viewBox="0 0 160 160" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="39" cy="55" r="6" fill="currentColor"/><path d="M13 82h5v15h3v-7h3v10h-6v11h-5V96H7V84h3v9h3V82z" fill="#fff"/><path d="M13 82h5v15h3v-7h3v10h-6v11h-5V96H7V84h3v9h3V82z" fill="currentColor" fill-opacity=".6"/><path d="m95 61 42 50H53l42-50z" fill="#fff"/><path d="m95 61 42 50H53l42-50z" fill="currentColor" fill-opacity=".68"/><path d="m57 75 30 36H27l30-36z" fill="#fff"/><path d="m57 75 30 36H27l30-36z" fill="currentColor" fill-opacity=".24"/><path fill-rule="evenodd" clip-rule="evenodd" d="M34.419 111.001h-2.577c6.816-2.376 11.236-8.42 15.233-14.827.6-.962 1.192-1.933 1.78-2.899 1.785-2.93 3.545-5.82 5.452-8.29 1.842-2.386 3.853-4.424 6.21-5.762l.652.781c-2.259 1.242-4.222 3.198-6.07 5.592-1.87 2.422-3.589 5.243-5.366 8.16v.001c-.594.975-1.194 1.961-1.81 2.947-3.559 5.704-7.585 11.363-13.504 14.297zm11.531 0h-1.586c1.146-.872 2.199-1.881 3.184-2.988 2.575-2.896 4.66-6.433 6.707-9.908l.064-.107c2.054-3.487 4.084-6.918 6.524-9.438 1.396-1.441 2.937-2.596 4.704-3.301l.678.812c-1.742.628-3.262 1.738-4.663 3.185-2.341 2.417-4.312 5.736-6.382 9.25l-.087.148c-2.03 3.445-4.157 7.054-6.798 10.023a24.943 24.943 0 0 1-2.345 2.324zm10.222 0h-1.44a17.107 17.107 0 0 0 1.818-1.933c1.554-1.902 3.014-4.285 4.55-6.792l.599-.974c1.749-2.842 3.614-5.77 5.806-8.176a21.594 21.594 0 0 1 2.576-2.427l.64.768c-.87.684-1.692 1.47-2.477 2.332-2.12 2.328-3.943 5.181-5.694 8.027l-.592.965-.001.002-.004.006c-1.53 2.497-3.028 4.943-4.629 6.902-.375.458-.758.894-1.152 1.3zm8.87 0h-1.586c2.453-1.905 4.676-4.281 6.515-6.795 1.852-2.531 3.297-5.178 4.185-7.581.09-.247.176-.49.255-.73l.748.897-.065.18c-.925 2.502-2.418 5.23-4.316 7.824-1.632 2.231-3.576 4.379-5.735 6.205zm9.686 0h-1.21l.116-.171c1.739-2.56 3.703-5.166 6.777-7.735l.64.768c-2.834 2.369-4.692 4.767-6.323 7.138zm7.01 0h-1.614a46.061 46.061 0 0 1 4.3-3.09l.646.775a47.918 47.918 0 0 0-3.332 2.315z" fill="#fff"/><path fill-rule="evenodd" clip-rule="evenodd" d="M34.419 111.001h-2.577c6.816-2.376 11.236-8.42 15.233-14.827.6-.962 1.192-1.933 1.78-2.899 1.785-2.93 3.545-5.82 5.452-8.29 1.842-2.386 3.853-4.424 6.21-5.762l.652.781c-2.259 1.242-4.222 3.198-6.07 5.592-1.87 2.422-3.589 5.243-5.366 8.16v.001c-.594.975-1.194 1.961-1.81 2.947-3.559 5.704-7.585 11.363-13.504 14.297zm11.531 0h-1.586c1.146-.872 2.199-1.881 3.184-2.988 2.575-2.896 4.66-6.433 6.707-9.908l.064-.107c2.054-3.487 4.084-6.918 6.524-9.438 1.396-1.441 2.937-2.596 4.704-3.301l.678.812c-1.742.628-3.262 1.738-4.663 3.185-2.341 2.417-4.312 5.736-6.382 9.25l-.087.148c-2.03 3.445-4.157 7.054-6.798 10.023a24.943 24.943 0 0 1-2.345 2.324zm10.222 0h-1.44a17.107 17.107 0 0 0 1.818-1.933c1.554-1.902 3.014-4.285 4.55-6.792l.599-.974c1.749-2.842 3.614-5.77 5.806-8.176a21.594 21.594 0 0 1 2.576-2.427l.64.768c-.87.684-1.692 1.47-2.477 2.332-2.12 2.328-3.943 5.181-5.694 8.027l-.592.965-.001.002-.004.006c-1.53 2.497-3.028 4.943-4.629 6.902-.375.458-.758.894-1.152 1.3zm8.87 0h-1.586c2.453-1.905 4.676-4.281 6.515-6.795 1.852-2.531 3.297-5.178 4.185-7.581.09-.247.176-.49.255-.73l.748.897-.065.18c-.925 2.502-2.418 5.23-4.316 7.824-1.632 2.231-3.576 4.379-5.735 6.205zm9.686 0h-1.21l.116-.171c1.739-2.56 3.703-5.166 6.777-7.735l.64.768c-2.834 2.369-4.692 4.767-6.323 7.138zm7.01 0h-1.614a46.061 46.061 0 0 1 4.3-3.09l.646.775a47.918 47.918 0 0 0-3.332 2.315z" fill="currentColor" fill-opacity=".5"/><path d="M145 87h4v13h2v-6.5h3v9.5h-5v8h-4V99h-5V89h3v7h2v-9z" fill="#fff"/><path d="M145 87h4v13h2v-6.5h3v9.5h-5v8h-4V99h-5V89h3v7h2v-9z" fill="currentColor" fill-opacity=".6"/></svg>
`}function hd(t){return t`
<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 0a1 1 0 0 1 1 1v2h2a1 1 0 1 1 0 2h-2v2a1 1 0 1 1-2 0V5h-2a1 1 0 1 1 0-2h2V1a1 1 0 0 1 1-1zm-6 4a1 1 0 0 1-1 1H2v11h13v-5a1 1 0 1 1 2 0v5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7a1 1 0 0 1 1 1zM3.5 9.25a1.25 1.25 0 1 0 2.5 0 1.25 1.25 0 0 0-2.5 0zm8.945.863a1 1 0 0 0-1.307-.092L8.5 12l-1.178-.587a1 1 0 0 0-.96.037L3.5 13.166V14.5h10v-3.332l-1.055-1.055z" fill="currentColor"/></svg>
`}var ar={text:{ratioX:1,ratioY:1},image:{ratioX:1,ratioY:1},imageWithText:{ratioX:1.7,ratioY:1}};var gd="#E73018",yd="#FF8400";var _d="#3CB46E";var Cd="#7C46B9";var kd="#42484E";var Ee="noColor";function Sd(t){let[e,r]=Q(()=>({width:0,height:0}));return H(()=>{let o=d(t.current),n=new ResizeObserver(([i])=>{r(i.contentRect)});return n.observe(o),()=>{n.disconnect()}},[t]),[e.width,e.height]}var Fg=[];function Ln(t,e=Fg){let[r,o]=Q(!1),[n,i]=Q(!1),[s,a]=Sd(t);return H(()=>{let c=t.current.scrollWidth>t.current.clientWidth;c!=r&&o(c);let l=t.current.scrollHeight>t.current.clientHeight;l!=n&&i(l),In(s,a,...e)},[t,r,n,s,a,e]),[r,n]}function xd(t,e){let[r]=Ln(t,e);return r}function bd(t){return{x:t.left,y:t.top}}function wd(t){return{x:t.width,y:t.height}}function Td(t,e){return{x:t.x/e.x,y:t.y/e.y}}function vd(t,e){return{x:t.x+e.x,y:t.y+e.y}}function Ed(t){return{x:t,y:t}}function Bd(t){return{width:t.offsetWidth,height:t.offsetHeight}}function Rd(t){return{width:t.right-t.left,height:t.bottom-t.top}}function Dd(t){let e=bd(t),r=Rd(t),o=wd(r);return vd(e,Td(o,Ed(2)))}function yo({elementSize:t={width:0,height:0},popoverSize:e,side:r,align:o,offsetX:n=0,offsetY:i=0}){let s={x:0,y:0};switch(r){case"top":s.y=-e.height-i;break;case"bottom":s.y=t.height+i;break;case"left":s.x=-e.width-n;break;case"right":s.x=t.width+n;break;default:F(r)}switch(o){case"start":switch(r){case"top":case"bottom":s.x=n;break;case"right":case"left":s.y=i;break;default:F(r)}break;case"center":switch(r){case"top":case"bottom":s.x=(t.width-e.width)/2;break;case"right":case"left":s.y=(t.height-e.height)/2;break;default:F(r)}break;case"end":switch(r){case"top":case"bottom":s.x=t.width-e.width-n;break;case"right":case"left":s.y=t.height-e.height-i;break;default:F(r)}break;default:F(o)}return s}function Zs(t,e,r){let o=0;switch(t){case"top":o=r.top-e.top;break;case"right":o=e.right-r.right;break;case"bottom":o=e.bottom-r.bottom;break;case"left":o=r.left-e.left;break;default:F(t)}return Math.max(0,o)}function Js(t,e,r,o){let n=0;switch(e){case"start":switch(t){case"top":case"bottom":n=r.right-o.right;break;case"right":case"left":n=r.bottom-o.bottom;break;default:F(t)}break;case"center":switch(t){case"top":case"bottom":n=Math.max(r.right-o.right,o.left-r.left);break;case"right":case"left":n=Math.max(r.bottom-o.bottom,o.top-r.top);break;default:F(t)}break;case"end":switch(t){case"top":case"bottom":n=o.left-r.left;break;case"right":case"left":n=o.top-r.top;break;default:F(t)}break;default:F(e)}return Math.max(0,n)}function ea(t){switch(t){case"top":return"bottom";case"right":return"left";case"bottom":return"top";case"left":return"right";default:throw F(t),new Error}}function ta(t){switch(t){case"start":return"end";case"center":throw new Error;case"end":return"start";default:throw F(t),new Error}}function Id(t,e,r){switch(t){case"top":case"bottom":if(e.right>=r.right)return"end";if(e.left<=r.left)return"start";break;case"right":case"left":if(e.bottom>r.bottom)return"end";if(e.top<r.top)return"start";break;default:F(t)}return"center"}function Md(t,e){switch(t){case"right":case"left":return{side:ea(t),align:e};case"top":case"bottom":return{side:t,align:e==="center"?e:ta(e)};default:throw F(t),new Error}}var de=(t,e,r)=>{let o=B(r);o.current=r;let n=r===null;H(()=>{if(n)return;let i=Xe(t.current,e,s=>d(o.current)(s));return()=>rt(i)},[t,e,n])};function $r(t){return t`
<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.707 5.707a1 1 0 0 0-1.414-1.414L10 8.586 5.707 4.293a1 1 0 0 0-1.414 1.414L8.586 10l-4.293 4.293a1 1 0 1 0 1.414 1.414L10 11.414l4.293 4.293a1 1 0 0 0 1.414-1.414L11.414 10l4.293-4.293z" fill="currentColor"/></svg>
`}function Ad(t,e){J(()=>{for(let r in e)e.hasOwnProperty(r)&&t.current.setAttributeNS(null,r,e[r].toString())},[t,...Object.keys(e),...Object.keys(e).map(r=>e[r])])}function ke(t){let e=B();return e.current=t,e}var Pg={pointer:{withMods:t=>__getCssClass("x0bad2__pointer",t)}},$n=22;function Ng({targetRect:t,hintRect:e}){if(e.left>=t.right)return"right";if(e.right<=t.left)return"left";if(e.top>=t.bottom)return"bottom";if(e.bottom<=t.top)return"top";throw new Error("Never")}function Lg({hintSide:t,hintRect:e,targetRect:r}){let o=Dd(r);switch(t){case"left":case"right":return o.y-e.top-$n/2;case"top":case"bottom":return o.x-e.left-$n/2;default:throw F(t),new Error}}function $g({hintSide:t,shift:e}){let r={left:"",right:"",top:"",bottom:""},o=U(t,{left:"top",right:"top",top:"left",bottom:"left"});return{...r,[t]:"calc(100% - 2px)",[o]:`${e}px`}}function Kg(t){return U(t,{left:"translateX(-6px) translateY(6px) rotate(90deg)",right:"translateX(6px) translateY(6px) rotate(-90deg)",top:"scaleY(-1)",bottom:""})}function Od(t,{color:e,getHintRect:r,getTargetRect:o}){let n=B(),i=ke(r),s=ke(o);return Ad(n,{width:$n,height:10,viewBox:`0 0 ${$n} 10`}),J(()=>{let a=i.current(),c=s.current(),l=Ng({hintRect:a,targetRect:c}),m=Lg({hintSide:l,hintRect:a,targetRect:c}),u=$g({hintSide:l,shift:m});n.current.style.left=u.left,n.current.style.right=u.right,n.current.style.top=u.top,n.current.style.bottom=u.bottom,n.current.style.transform=Kg(l)},[i,s,n]),t`
<svg
	xmlns="http://www.w3.org/2000/svg"
	save-ref=${n}
	class=${Pg.pointer.withMods({color:e})}
>
	<path
		fill-rule="evenodd"
		clip-rule="evenodd"
		d="M10 0C13 0 15.9999 8 20 8H0C3.9749 8 7 0 10 0Z"
	/>
	<rect x="0" y="8" width="20" height="2"></rect>
</svg>
`}var Kn={tooltip:{withMods:t=>__getCssClass("x17c2d__tooltip",t)},content:"x17c2d__content",closeButton:"x17c2d__close-button",text:"x17c2d__text"};function Fd(t,e){let r=ne(),{onClose:o=null,getPointerTargetRect:n,size:i="small",type:s="default",autotestData:a}=e,c=ne();de(c,"mousedown",m=>m.stopPropagation());let l=e.contentType==="text"?C(Vg,e.text):e.content;return de(r,"mousedown",o),t`
<div class=${Kn.tooltip.withMods({type:s,text:e.contentType==="text",size:i})}
	save-ref=${c}
	data-at=${ee(a)}
>
	${t.renderIf(Od,()=>n&&{color:Hg(s),getTargetRect:n,getHintRect:()=>c.current.getBoundingClientRect()})}
	${t(l,Kn.content)}
	${t.renderIf($r,()=>!!o,{className:Kn.closeButton,ref:r})}
</div>`}function Hg(t){return U(t,{default:"dark",onboarding:"purple"})}function Vg(t,e){return t`<div class=${Kn.text}>${e}</div>`}function Wg(t,e,r,o){t.current!==void 0&&(clearTimeout(t.current),t.current=void 0),o<=0?e(r):t.current=setTimeout(()=>{t.current=void 0,e(r)},o)}function Pd(t){let[e,r]=Q(typeof t=="function"?t:()=>t),o=B(void 0),n=Z((i,s)=>Wg(o,a=>r(a),i,s),[]);return[e,n]}function Hn(t){return{animate:e=>{t.forEach(r=>r.animate(e))},complete:()=>{t.forEach(e=>e.complete())},changedProperties:[]}}var Ug=!1;function Nd({propName:t,defaultValue:e,units:r,element:o,getCurrentValue:n}){let i=window.getComputedStyle(o),s=i&&i.getPropertyValue(t),a=s?parseFloat(s):e,c=o.style.getPropertyValue(t);return{animate:l=>{o.style.setProperty(t,`${n(l,a)}${r||""}`)},complete:()=>{o.style.setProperty(t,c)},changedProperties:[t]}}function zg(t,e){return Nd({propName:"opacity",defaultValue:1,element:t,getCurrentValue:e})}function Gg(t,e){return Nd({propName:"max-height",defaultValue:0,units:"px",element:t,getCurrentValue:e})}function Qg(t,e,r){let o=t.style.transform,n=on(t);return{animate:i=>{let s=[n],a=r&&r(i);if(a!=null){let[l,m]=a;s.push(`translate(${l}px, ${m}px)`)}let c=e&&e(i);if(c!=null)if(typeof c=="number")s.push(`scale(${c})`);else{let[l,m]=c;l!=null&&s.push(`scaleX(${l})`),m!=null&&s.push(`scaleY(${m})`)}t.style.transform=s.join(" ")},complete:()=>{t.style.transform=o},changedProperties:["transform"]}}function Yg({reducer:t,duration:e,abortSignal:r,before:o,after:n}){return new Promise(i=>{let s=Date.now(),a=!1,c=r?r.add(()=>{a=!0}):()=>{};function l(){let m=ht(Date.now()-s,0,e),u=m/e;t.animate(u),a||m>=e?(c(),t.complete(),i(),n&&n()):requestAnimationFrame(l)}o&&o(),l()})}function Ld({opacity:t,maxHeight:e,scale:r,translate:o,duration:n,before:i,after:s}){return Ug?{play:()=>Promise.resolve()}:{play:(a,c)=>Yg({reducer:Hn([t?zg(a,t):null,e?Gg(a,e):null,r||o?Qg(a,r,o):null].filter(Ko)),duration:n,abortSignal:c,before:i&&(()=>d(i)(a)),after:s&&(()=>d(s)(a))})}}function $d(t,e,r){let o=e-t;return n=>(r&&(n=r(n)),n>=1?e:t+o*n)}function Kd(t,e,r){let o=e[0]-t[0],n=e[1]-t[1];return i=>(r&&(i=r(i)),i>=1?e:[t[0]+o*i,t[1]+n*i])}function Hd(t,e){let r=t.getBoundingClientRect(),o=!1;function n(){if(o)return;let i=t.getBoundingClientRect();(Math.round(i.top)!=Math.round(r.top)||Math.round(i.left)!=Math.round(r.left)||i.width!=r.width||i.height!=r.height)&&(r=i,e()),requestAnimationFrame(n)}return requestAnimationFrame(n),()=>{o=!0}}function Vd({html:t,layer:e,createBinding:r,show:o,appearAnimation:n,hideAnimation:i}){let s=B(null),a=B(null),c=Z(()=>{a.current&&(a.current.parentElement==e&&e.removeChild(a.current),a.current=null)},[e]),l=Z(()=>{c();let g=s.current;g&&g.parentElement===e&&e.removeChild(g)},[c,e]);H(()=>l,[l]);let m=o?r():null,u=t(m);return J(()=>{s.current!=u&&(u?(c(),u.style.position="absolute",h.assert(s.current==null),e.appendChild(u),n&&n(u)):s.current&&(a.current=s.current,i?i(s.current).then(c):c()),s.current=u)}),s}function Wd({getPopoverRect:t,side:e,align:r,rootElementRect:o,args:n,offset:i}){let s=t(i),a=Zs(e,s,o);if(a){let l=ea(e),m=yo({...n,side:l}),u=t(m);Zs(l,u,o)<a&&(n.side=l,i=m)}let c=Js(n.side,r,s,o);if(c){let l=r=="center"?Id(n.side,s,o):ta(r),m=yo({...n,align:l}),u=t(m);Js(n.side,l,u,o)<c&&(n.align=l,i=m)}return i}function qg(t,e){let r=t?t.getBoundingClientRect():{top:0,right:document.body.scrollHeight-document.body.offsetHeight?document.body.offsetWidth:window.innerWidth,bottom:document.body.offsetHeight,left:0};return{top:r.top+e.y,right:r.right+e.x,bottom:r.bottom+e.y,left:r.left+e.x}}function Ud({element:t,popover:e,isTopLayer:r,side:o,align:n,getOffset:i,autoInvert:s,rootElement:a}){let c=r?{x:window.pageXOffset,y:window.pageYOffset}:{x:0,y:0},l=qg(a,c),m=t.getBoundingClientRect(),u={width:m.width,height:m.height},g=Bd(e);function b(k){let w=k.x+m.left+c.x,L=k.y+m.top+c.y;return{left:w,top:L,right:w+g.width,bottom:L+g.height}}let N=i&&i()||{x:0,y:0},I=Tr()?Md(o,n):{side:o,align:n},R={elementSize:u,popoverSize:g,side:I.side,align:I.align,offsetX:N.x,offsetY:N.y},y=yo(R);return s&&(y=Wd({getPopoverRect:b,side:I.side,align:I.align,rootElementRect:l,args:R,offset:y})),r&&(y.x+=m.left+c.x,y.y+=m.top+c.y),y}var zd=500;function Xg({tooltipElement:t,elementRef:e,position:r,setVisible:o,ignoreIsElementWithinViewport:n}){if(t.style.left="0",t.style.top="0",t.style.transform=`translateX(${r.x}px) translateY(${r.y}px)`,!n&&!jg(t))return t.style.display="none",o(!1,0),Promise.resolve();let i=r.y>e.current.getBoundingClientRect().top?-5:5;return Ld({opacity:$d(0,1),translate:Kd([0,i],[0,0]),duration:150}).play(t)}function Gd({html:t,elementRef:e,container:r,show:o=!0,stayOnHover:n=!1,side:i="top",align:s="center",offset:a={x:0,y:8},appearDelay:c=zd,hideDelay:l=n?zd:0,isPreventDefaultClick:m=!1,ignoreIsElementWithinViewport:u=!1}){let g=B(null),b=B(null),[N,I]=Pd(!1);H(()=>{In(o),o||I(!1,l)},[l,I,o]),de(e,"mouseover",()=>I(!0,c)),de(e,"mouseout",()=>I(!1,l)),de(e,"click",y=>m&&y.preventDefault());let R=Vd({html:t,layer:br("tooltip"),createBinding:()=>r,show:o&&N,appearAnimation:y=>{function k(){return Ud({element:e.current,popover:y,side:i,align:s,isTopLayer:!0,getOffset:()=>a,autoInvert:!0})}return g.current=Hd(e.current,()=>I(!1,0)),Xg({elementRef:e,tooltipElement:y,position:k(),setVisible:I,ignoreIsElementWithinViewport:!!u}).then(()=>{b.current=new ResizeObserver(()=>{let w=k();y.style.transform=`translateX(${w.x}px) translateY(${w.y}px)`}),b.current.observe(y)})},hideAnimation:()=>(g.current&&(g.current(),g.current=null),b.current&&(b.current.disconnect(),b.current=null),Promise.resolve())});return J(()=>{let y=R.current;if(!n||!y)return;let k=()=>I(!0,0),w=()=>I(!1,l);return y.addEventListener("mouseover",k),y.addEventListener("mouseout",w),()=>{y.removeEventListener("mouseover",k),y.removeEventListener("mouseout",w)}}),{visible:N,setVisible:I}}function jg(t){let e=t.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}function Qd(t){Gd({...t,container:C(Fd,{contentType:"text",text:t.text,size:t.size,autotestData:t.autotestData})})}function st(t){Qd(t)}var Zg={text:"x31b75__text"};function Yd(t,{text:e,disableTooltip:r,autotestData:o}){let n=ne(),i=xd(n,[typeof e=="string"?e:e.html]);return st({html:t,elementRef:n,text:e,show:!r&&i}),t`
<div
	class=${Zg.text}
	save-ref=${n}
	data-at=${ee(o)}
>
	${e}
</div>`}var ra="data-focus-visible-added",oa="focus-visible";function qd(t,{focused:e,onFocusedChange:r}){if(pe(e)&&!pe(r))throw new Error("useFocusProps: `focused` requires `onFocusedChange`");H(()=>{if(!pe(e))return;let o=t.current,n=o===document.activeElement;e&&!n?(o.focus(),o.setAttribute(ra,""),o.classList.add(oa)):!e&&n&&(o.blur(),o.removeAttribute(ra),o.classList.remove(oa))},[e,t]),de(t,"focus",()=>{r&&r(!0)}),de(t,"blur",()=>{r&&r(!1)})}var Jg={preloader:{withMods:t=>__getCssClass("x12792__preloader",t)},spin:"x12792__spin"};function Vn(t,{size:e="medium",color:r="accent"}){return t`
<svg
	class=${Jg.preloader.withMods({size:e,color:r})}
	viewBox="0 0 32 32"
	xmlns="http://www.w3.org/2000/svg"
>
	<path
		d="M30 16C30 23.732 23.732 30 16 30C8.26801 30 2 23.732 2 16C2 8.26801 8.26801 2 16 2"
		stroke="currentColor"
		stroke-width="2.5"
		stroke-linecap="round"
		fill="none"
	/>
</svg>
`}var _o={button:{withMods:t=>__getCssClass("xcc0a8__button",t)},icon:"xcc0a8__icon",text:"xcc0a8__text",preloader:"xcc0a8__preloader"},ey={button:{withMods:t=>__getCssClass("xeba1a__button",t)},icon:"xeba1a__icon",text:"xeba1a__text",preloader:"xeba1a__preloader"},ty={button:{withMods:t=>__getCssClass("x3e989__button",t)},icon:"x3e989__icon",text:"x3e989__text",preloader:"x3e989__preloader"},ry={button:{withMods:t=>__getCssClass("x1ebbb__button",t)},text:"x1ebbb__text",icon:"x1ebbb__icon",preloader:"x1ebbb__preloader"},oy={button:{withMods:t=>__getCssClass("xb6cd3__button",t)},icon:"xb6cd3__icon",text:"xb6cd3__text",preloader:"xb6cd3__preloader"},ny={button:{withMods:t=>__getCssClass("xa084d__button",t)},icon:"xa084d__icon",text:"xa084d__text",preloader:"xa084d__preloader"},iy={button:{withMods:t=>__getCssClass("x133d5__button",t)},text:"x133d5__text",icon:"x133d5__icon",preloader:"x133d5__preloader"},sy={button:{withMods:t=>__getCssClass("x959fd__button",t)},text:"x959fd__text",icon:"x959fd__icon",preloader:"x959fd__preloader"},ay={button:{withMods:t=>__getCssClass("x9131e__button",t)},text:"x9131e__text",icon:"x9131e__icon",preloader:"x9131e__preloader"},cy={button:{withMods:t=>__getCssClass("x08261__button",t)},text:"x08261__text",icon:"x08261__icon",preloader:"x08261__preloader"},ly={button:{withMods:t=>__getCssClass("xc515f__button",t)},text:"xc515f__text",icon:"xc515f__icon",preloader:"xc515f__preloader"},dy={button:{withMods:t=>__getCssClass("xea2c3__button",t)},text:"xea2c3__text",icon:"xea2c3__icon",preloader:"xea2c3__preloader"},my={button:{withMods:t=>__getCssClass("x2278a__button",t)},text:"x2278a__text",icon:"x2278a__icon",preloader:"x2278a__preloader"};function Me(t,e){let r=ne(),{size:o="medium",state:n="default",minWidth:i=!0,autotestData:s,tooltip:a}=e,{iconLeft:c,text:l,iconRight:m}=hy(e),u=fy(e),g=n=="loading",b=g||n=="disabled";function N(y){!b&&!y.defaultPrevented&&(y.preventDefault(),e.onClick&&e.onClick())}let I=U(e.style,{primary:ey,secondary:ty,destructive:oy,warning:ny,ghost:iy,ghostInversed:sy,link:ay,linkInversed:cy,linkSecondary:ly,linkSecondaryAlpha:dy,complementary:my,secondaryInversed:ry}),R=Oe(_o.button.withMods({size:o,spacing:e.structure=="icon"&&u=="default"?"icon":u,"min-width":e.structure!="icon"&&i,loading:g}),I.button.withMods({pressed:n=="pressed"}));return st({html:t,elementRef:r,show:!!a,text:typeof a=="string"?a:typeof a=="object"?a.text:"",size:typeof a=="object"?a.size:void 0,side:typeof a=="object"?a.side:void 0,align:typeof a=="object"?a.align:void 0,offset:typeof a=="object"?a.offset:void 0}),qd(r,e),t`
<button
	class=${R}
	disabled=${b}
	onclick=${N}
	save-ref=${r}
	data-at=${ee(s)}
>
	${t.renderIf(Xd,()=>!!c&&{className:Oe(_o.icon,I.icon),tooltip:a,icon:c})}
	${t.renderIf(uy,()=>!!l&&{className:Oe(_o.text,I.text),text:l,disableTooltip:!!a})}
	${t.renderIf(Xd,()=>!!m&&{className:Oe(_o.icon,I.icon),icon:m})}
	${t.renderIf(py,()=>g&&{className:Oe(_o.preloader,I.preloader),color:gy(e.style)})}
</button>
`}function Xd(t,{className:e,icon:r}){return t`
<div class=${e}>
	${t(r)}
</div>
`}function uy(t,{className:e,text:r,disableTooltip:o}){return t`
<div class=${e}>
	${t(Yd,{text:r,disableTooltip:o})}
</div>
`}function py(t,{className:e,color:r}){return t`
<div class=${e}>
	${t(Vn,{size:"small",color:r})}
</div>
`}function fy(t){switch(t.style){case"link":case"linkInversed":case"linkSecondary":case"linkSecondaryAlpha":return t.spacing||"default";case"primary":case"secondary":case"secondaryInversed":case"destructive":case"warning":case"ghost":case"ghostInversed":case"complementary":return"default";default:throw F(t),new Error}}function hy(t){switch(t.structure){case"icon":return{iconLeft:t.icon,text:null,iconRight:null};case"text":return{iconLeft:null,text:t.text,iconRight:null};case"iconAndText":return{iconLeft:t.icon,text:t.text,iconRight:null};case"textAndIcon":return{iconLeft:null,text:t.text,iconRight:t.icon};case"iconAndTextAndIcon":return t;default:throw F(t),new Error}}function gy(t){return U(t,{primary:"onColor",secondary:"subdued",destructive:"onColor",warning:"onColor",ghost:"subdued",ghostInversed:"onColor",link:"subdued",linkInversed:"onColor",linkSecondary:"subdued",linkSecondaryAlpha:"subdued",complementary:"subdued",secondaryInversed:"onColor"})}function jd(t){return t`
<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M6 2a1 1 0 0 0-2 0v2H2a1 1 0 0 0 0 2h2v8a2 2 0 0 0 2 2h8v2a1 1 0 1 0 2 0v-2h2a1 1 0 1 0 0-2H6V2zm3 2a1 1 0 0 0 0 2h5v5a1 1 0 1 0 2 0V6a2 2 0 0 0-2-2H9z" fill="currentColor"/></svg>
`}function Zd(t){return t`
<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.697 1.875 13.212 1l-.875.485-2.474 1.372a1 1 0 1 0 .97 1.749l.315-.175a4.497 4.497 0 0 0 3.215 5.497 4.5 4.5 0 0 0 3.102-8.402 1 1 0 0 0-.873 1.8 2.5 2.5 0 1 1-3.501 1.581l.228.411a1 1 0 1 0 1.749-.97l-1.371-2.473zM0 6a2 2 0 0 1 2-2h5a1 1 0 0 1 0 2H2v11h13v-3a1 1 0 1 1 2 0v3a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V6zm3.5 4.517a1.25 1.25 0 1 0 2.5 0 1.25 1.25 0 0 0-2.5 0zm8.945.864a1 1 0 0 0-1.307-.093L8.5 13.268l-1.178-.588a1 1 0 0 0-.96.038L3.5 14.434v1.333h10v-3.331l-1.055-1.055z" fill="currentColor"/></svg>
`}function Jd(t){return t`
<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1H8zM6 4H3a1 1 0 0 0 0 2v10a3 3 0 0 0 3 3h8a3 3 0 0 0 3-3V6a1 1 0 1 0 0-2h-3a3 3 0 0 0-3-3H9a3 3 0 0 0-3 3zm9 12V6H5v10a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1zm-7-1a1 1 0 0 1-1-1V9a1 1 0 0 1 2 0v5a1 1 0 0 1-1 1zm3-1a1 1 0 1 0 2 0V9a1 1 0 1 0-2 0v5z" fill="currentColor"/></svg>
`}var yy={top:0,right:0,bottom:0,left:0};function na(){return{...yy}}function em(t,e,r,o){let n=t,i=e;return r>o?(i=Math.min(t*(o/r),e),n=i*(r/o)):(n=Math.min(e*(r/o),t),i=n*(o/r)),{top:Math.ceil((e-i)/2),right:Math.ceil((t-n)/2),bottom:Math.ceil((e-i)/2),left:Math.ceil((t-n)/2)}}function Pe({width:t,height:e,crop:r,src:o}){return{src:o,crop:r||na(),width:r?t-r.left-r.right:t,height:r?e-r.top-r.bottom:e}}function tm(t){let{width:e,height:r}=t,o=Pe(t),n=e-o.width,i=r-o.height,s=n===0?0:o.crop.left/e*(e/n)*100,a=i===0?0:o.crop.top/r*(r/i)*100;return{width:e/o.width*100,height:r/o.height*100,positionX:s,positionY:a}}function ia(t){return t.crop?{src:t.src,width:t.width,height:t.height}:t}function rm(t,e,r){let[o,n]=Q(1),i=Fe(()=>Pe(t),[t]);return H(()=>{if(e.current){let s=e.current,a=r?r.width:s.clientWidth,c=r?r.height:s.clientHeight,l=i.width/a,m=i.height/c;l>1||m>1?n(Math.max(l,m)):n(1)}},[e,i,r]),o}var sa={imageSelection:"x9c461__image-selection",imageContainer:{withMods:t=>__getCssClass("x9c461__image-container",t)},image:{withMods:t=>__getCssClass("x9c461__image",t)}};function _y(t){return t`
<img
	class=${sa.imageSelection}
	src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="
	tabIndex="-1"
	aria-hidden=true
	draggable=false
/>
`}function Cy(t,{image:e,withImageSelection:r,width:o,height:n,onClick:i,withZoom:s}){let a=tm(e),c=o&&n?`width: ${o}px; height: ${n}px;`:"";return t`
<div
	class=${sa.image.withMods({withZoom:!!s})}
	style=${`
	    ${c}
		background: url(${Lt(e.src)}) no-repeat;
		background-size: ${a.width}% ${a.height}%;
		background-position: ${a.positionX}% ${a.positionY}%;`}
	onclick=${i}
>
	${t.renderIf(_y,()=>r)}
</div>
`}function ky(t,{image:e,withSize:r,withBackdrop:o,withImageSelection:n,withZoom:i,containerRef:s,containerLimit:a,className:c="",onClick:l}){let m=ne(),u=Fe(()=>Pe(e),[e]),g=rm(e,s||m,a);return t`
<div
	class=${c+" "+sa.imageContainer.withMods({fill:!r,origin:!!r,backdrop:!!o})}
	save-ref=${m}
>
	${t(Cy,{image:e,withZoom:i,withImageSelection:n,width:r?u.width/g:void 0,height:r?u.height/g:void 0,onClick:l})}
</div>
`}function $t(t,{image:e,...r}){let o=Fe(()=>({...e,crop:e.crop?e.crop:na()}),[e]);return Pt(t,C(ky,{...r,image:o}))}var Sy={imageTemp:"x11b01__image-temp"};function cr(t,{image:e,imageRatio:r,isTemporary:o}){let n=Fe(()=>({...e,crop:e.crop?e.crop:em(e.width,e.height,r.ratioX,r.ratioY)}),[e,r]),i=ne();return H(()=>{o&&i.current.classList.toggle(Sy.imageTemp)},[i,o]),Pt(t,C($t,{image:n}),i)}var Kr={image:"x003b0__image",imageToolbar:"x003b0__image-toolbar",divider:"x003b0__divider",imageContainer:"x003b0__image-container",overlay:"x003b0__overlay"};function xy(t,{image:e,imageRatio:r}){let o=ne();return J(()=>{e.overlay&&e.overlay.color!==Ee?(o.current.style.background=e.overlay.color,o.current.style.opacity=`${e.overlay.opacity}`):(o.current.style.background="",o.current.style.opacity="")},[e.overlay,o]),t`
<div class=${Kr.imageContainer}>
	${t(cr,{image:e,imageRatio:r})}
	<div
		class=${Kr.overlay}
		save-ref=${o}
	>
	</div>
</div>
`}function by(t,{onReplaceImage:e,onDeleteImage:r,onCropImage:o}){return t`
<div class=${Kr.imageToolbar}>
	${t(Me,{style:"ghostInversed",structure:"icon",icon:C(Zd),onClick:e,tooltip:x("Roll.Editor.ImageControls.MediaToolbar.Replace")})}
	<div class=${Kr.divider}></div>
	${t(Me,{style:"ghostInversed",structure:"icon",icon:C(jd),onClick:o,tooltip:x("Common.Editor.CropImage.TooltipText")})}
	<div class=${Kr.divider}></div>
	${t(Me,{style:"ghostInversed",structure:"icon",icon:C(Jd),onClick:r,tooltip:x("Common.Editor.DeleteImage.TooltipText")})}
</div>`}function om(t,{imageData:e,imageRatio:r,readonlyMode:o,onUploadImage:n,onDeleteImage:i,onCropImage:s,onOpenFileDialog:a}){let c=Nn(n),l=Z(()=>{c.browseRef.current(),a()},[c.browseRef,a]);function m(u){Fn(u)}return t`
<div class=${Kr.image} oninput=${m}>
	${t.renderIf(Pn,()=>!o&&c)}
	${t(xy,{image:e,imageRatio:r})}
	${t.renderIf(by,()=>!o&&{onReplaceImage:l,onDeleteImage:i,onCropImage:s})}
</div>`}var Hr={content:"x8d2e7__content",imageWithDownload:"x8d2e7__image-with-download",imageWithStub:"x8d2e7__image-with-stub",downloadStub:"x8d2e7__download-stub",downloadStubText:"x8d2e7__download-stub-text",stubIcon:"x8d2e7__stub-icon"};function wy(t,{onUploadImage:e,onOpenFileDialog:r}){let o=Nn(e),n=Z(()=>{o.browseRef.current(),r()},[o.browseRef,r]);function i(s){Fn(s)}return t`
<div
	class=${Hr.imageWithDownload}
	oninput=${i}
>
	${t(Pn,o)}
	<div
		class=${Hr.downloadStub}
		onclick=${n}
	>
		${t(hd,{})}
		<span class=${Hr.downloadStubText}>${x("Roll.Editor.FlipCardsBlock.AddImage.Placeholder")}</span>
	</div>
</div>
	`}function Ty(t){return t`
<div class=${Hr.imageWithStub}>
	${t(fd,{},Hr.stubIcon)}
</div>
`}function nm(t,{image:e,imageRatio:r,blobData:o,readonlyMode:n,onUploadImage:i,onOpenFileDialog:s,onDeleteImage:a,onCropImage:c}){return t`
<div class=${Hr.content}>
	${t.switch(()=>o?C(cr,{image:o,imageRatio:r,isTemporary:!0}):e?C(om,{imageData:e,imageRatio:r,readonlyMode:n,onDeleteImage:a,onUploadImage:i,onOpenFileDialog:s,onCropImage:c}):n?C(Ty):C(wy,{onUploadImage:i,onOpenFileDialog:s}))}
</div>`}var Vr=class extends Ae{constructor({cardKey:e,sideType:r,readonlyMode:o,contentType:n}){super(),this._sideType=r,this._readonlyMode=o,this._cardKey=e,this._commonSignalData={cardKey:this._cardKey,sideType:this._sideType},this._image=null,this._contentType=n,this.onUploadImageSignal=this._createSignal(),this.onFileDialogOpenSignal=this._createSignal(),this.onCropImageSignal=this._createSignal(),this.onRemoveImageSignal=this._createSignal(),this._imageBlobData=null}imageBlobData(){return this._imageBlobData}setImageBlobData(e){this._imageBlobData=e}renderImageContent(e,r){return this._image=e,ae(nm)({image:e,imageRatio:ar[this._contentType],blobData:this._imageBlobData,readonlyMode:this._readonlyMode,onUploadImage:this._onUploadImage.bind(this),onOpenFileDialog:this.onFileDialogOpenSignal.toFn(),onDeleteImage:this._onDeleteImage.bind(this),onCropImage:this._onCropImage.bind(this)},r)}_onDeleteImage(){this.onRemoveImageSignal.dispatch(this._commonSignalData)}_onCropImage(){this._image&&this.onCropImageSignal.dispatch({...this._commonSignalData,imageData:this._image,contentType:this._contentType})}_onUploadImage(e){this.onUploadImageSignal.dispatch({...this._commonSignalData,file:e})}};function Wn(t){return t`
<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.654 5.02a6 6 0 0 1 8.6 2.08l-.432-.173a1 1 0 0 0-.744 1.857l2.625 1.052a1 1 0 0 0 1.3-.556l1.052-2.626A1 1 0 0 0 17.2 5.91l-.134.335a8 8 0 0 0-14.533.889 1 1 0 1 0 1.867.716 6 6 0 0 1 2.255-2.83zm6.693 10.07a6 6 0 0 1-8.583-2.05l.335.162a1 1 0 0 0 .873-1.8l-2.545-1.235a1 1 0 0 0-1.336.463L.856 13.175a1 1 0 1 0 1.8.873l.181-.375a8 8 0 0 0 14.632-.696 1 1 0 1 0-1.868-.717 6 6 0 0 1-2.255 2.83z" fill="currentColor"/></svg>
`}var im={},Kt=class extends O{constructor({flipCardsBlockKey:e,cardData:r,sideData:o,sideType:n,onHyperlinkOverFn:i,readonlyMode:s,isLock:a,relatedData:c}){super({blockName:"flip-card-side",relatedData:c}),this._flipCardsBlockKey=e,this._cardData=r,this._sideType=n,this._sideData=o,this._onHyperlinkOverFn=i,this._readonlyMode=s,this._isLock=a,this._flipHint=this._renderFlipHint(),this.updateModifier("mobile",Ac())}setLockMode(e){this._isLock!==e&&(this._isLock=e,this._sheduleRender())}setSideData(e){this._sideData!==e&&(this._sideData=e,this._invalidateFlipHintStyle(),this._sheduleRender())}_getControlBackgroundData(){throw new Error("_getBackgroundData not implemented")}_renderCardContent(){}_renderFlipHint(){return D(im,`:flip-card-flip-button-${this._cardData.key}-${this._sideType}`)`
<div
	class='card-flip-hint'
	onconnected=${()=>this._invalidateFlipHintStyle()}
>
	${ae(Wn)({},this._renderFunctionEx(`:flip-card-flip-button-icon-${this._cardData.key}-${this._sideType}`))}
</div>
		`}_invalidateFlipHintStyle(){if(!this._flipHint)return;let e=r=>{let o=Br(),n=U(r,{dark:{background:o.overlayHovered,color:o.iconPlaceholder},light:{background:o.overlayBg,color:o.iconOncolorSecondary}});yt(this._flipHint,"--color",n.color),yt(this._flipHint,"--background",n.background)};Lr({background:this._getControlBackgroundData(),setStyle:e})}_render(){return D(im,`:flip-card-side-${this._cardData.key}-${this._sideType}-${this._sideData.type}`)`
<div class=${this._getCssClasses()}>
	${this._renderCardContent()}
	${this._readonlyMode?this._renderFlipHint():null}
</div>
		`}};var vy={},Co=class extends Kt{constructor({cardData:e,sideData:r,sideType:o,onHyperlinkOverFn:n,readonlyMode:i,isLock:s,relatedData:a,flipCardsBlockKey:c}){super({flipCardsBlockKey:c,cardData:e,sideData:r,sideType:o,onHyperlinkOverFn:n,readonlyMode:i,isLock:s,relatedData:a}),this._sideWithImageHelper=new Vr({readonlyMode:i,cardKey:e.key,sideType:o,contentType:"image"})}onUploadImageSignal(){return this._sideWithImageHelper.onUploadImageSignal}onCropImageSignal(){return this._sideWithImageHelper.onCropImageSignal}onRemoveImageSignal(){return this._sideWithImageHelper.onRemoveImageSignal}onFileDialogOpenSignal(){return this._sideWithImageHelper.onFileDialogOpenSignal}setImageBlobData(e){this._sideWithImageHelper.setImageBlobData(e),this._sheduleRender()}setSideData(e){this._sideWithImageHelper.setImageBlobData(null),super.setSideData(e)}_getControlBackgroundData(){return dd(this._sideData.image)}_renderCardContent(){return D(vy,`:flip-card-side-content-${this._cardData.key}-${this._sideType}-${this._sideData.type}`)`
<div class='image-side-content'>
	${this._sideWithImageHelper.renderImageContent(this._sideData.image,this._renderFunctionEx(`:flip-card-side-content-image-${this._cardData.key}-${this._sideType}-${this._sideData.type}`))}
</div>
		`}};var f={PARAGRAPH:"p",IMAGE:"i",COLLAGE:"c",EMBED:"e",EXERCISE:"E",ATTACHMENT:"a",NOTE:"n",TABLE:"t",FLIP_CARD:"fc"};function K(t){return!t||t.type!==f.PARAGRAPH?null:t}function Un(t){if(t.type==="image")return null;let e=We(t.meta,"charactersMeta");return e&&e.name==="charactersMeta"?e.data:null}var lr={FULL:1180,MEDIUM:739};function zn(){return window.innerWidth>lr.FULL}function Ht(){return window.innerWidth<=lr.FULL&&window.innerWidth>lr.MEDIUM}function at(){return window.innerWidth<=lr.MEDIUM}function Gn(t){let e=at();return t<=15?"1.5":t<=18?e?"2":"1.9":t<=21&&e?"1.7":t<=23&&!e?"1.75":"normal"}var dr={create({key:t,fileName:e,fileExtension:r,fileSize:o,src:n,isLoading:i}){return{key:t||v(),type:f.ATTACHMENT,fileName:e||"",fileExtension:r||"pdf",fileSize:o||0,src:n,isLoading:i||!1}},toAttachmentBlock(t){return t&&t.type===f.ATTACHMENT?t:null},getBlockType(t){return"attachment"}};var Ey="collage",ye={create({key:t,images:e=[],alignment:r}){let o=t||v(),n=e.map(i=>({...i,parentCollageKey:o}));return{key:o,type:f.COLLAGE,images:n,alignment:r||"inner"}},clone(t){let e=v();return{...t,key:e,images:t.images.map(r=>({...r,key:v(),parentCollageKey:e}))}},toCollageBlock(t){return t&&t.type===f.COLLAGE?t:null},getBlockType(t){return Ey},isCollageBlock(t){return!!t&&t.type===f.COLLAGE},getCollagedImage(t,e){return t.images.find(r=>r.key===e)||null},getCollagedImageIndex(t,e){return t.images.findIndex(r=>r.key===e)}};var ko={basicPaletteCrimson:"#B8195B",basicPaletteDeepSpace:"#02318A",basicPaletteSpaceBlue:"#0047CB",black60:"#00000099",black8:"#00000014",black80:"#000000CC",blackDefault:"#000000",blue16:"#4A90E229",blue30:"#4A90E24D",blue8:"#4A90E214",blue80:"#4A90E2CC",blueBlack:"#0D2E53",blueDark:"#287BDC",blueDarker:"#1E67BD",blueDefault:"#4A90E2",collaboration1:"#1F4198",collaboration10:"#5C247A",collaboration2:"#8069E5",collaboration3:"#EE5091",collaboration4:"#983484",collaboration5:"#80B43C",collaboration6:"#B8195B",collaboration7:"#FB8B28",collaboration8:"#462FAC",collaboration9:"#EEA811",dark12:"#42484E1F",dark14:"#42484E24",dark16:"#42484E29",dark20:"#42484E33",dark28:"#42484E47",dark40:"#42484E66",dark60:"#42484E99",dark72:"#42484EB8",dark8:"#42484E14",dark80:"#42484ECC",dark87:"#42484EDE",darkDark:"#2F3337",darkDefault:"#42484E",grayDark:"#D0D0D1",grayDarker:"#C0C0C1",grayDefault:"#EFEFF0",grayLight:"#F2F2F3",grayLighter:"#F6F6F7",green16:"#3CB46E29",green30:"#3CB46E4D",green8:"#3CB46E14",green80:"#3CB46ECC",greenBlack:"#091B10",greenDark:"#32955B",greenDarker:"#287748",greenDefault:"#3CB46E",orange16:"#FF9F3329",orange30:"#FF9F334D",orange8:"#FF9F3314",orange80:"#FF9F33CC",orangeBlack:"#603506",orangeDark:"#F08713",orangeDarker:"#CE720D",orangeDefault:"#FF9F33",purple16:"#6257BA29",purple30:"#6257BA4D",purple8:"#6257BA14",purple80:"#6257BACC",purpleBlack:"#262150",purpleDark:"#4F44A6",purpleDarker:"#413889",purpleDefault:"#6257BA",red16:"#F0513D29",red30:"#F0513D4D",red8:"#F0513D14",red80:"#F0513DCC",redBlack:"#5A1007",redDark:"#EE2F17",redDarker:"#CC250F",redDefault:"#F15541",slate10:"#8D98A21A",slate20:"#8D98A233",slate40:"#8D98A266",slate5:"#8D98A20D",slate60:"#8D98A299",slate80:"#8D98A2CC",slateDefault:"#8D98A2",white16:"#FFFFFF29",white30:"#FFFFFF4D",white60:"#FFFFFF99",white80:"#FFFFFFCC",whiteDefault:"#FFFFFF",yellow16:"#F9C60E29",yellow30:"#F9C60E4D",yellow8:"#F9C60E14",yellow80:"#F9C60ECC",yellowBlack:"#473800",yellowDark:"#E5B406",yellowDarker:"#C29800",yellowDefault:"#F9C60E"};var By="";function aa(){return By}function sm(t){return t.length===2}function am({offset:t,textLength:e,getCharacterByIndex:r}){let o=0,n=0;for(;o<e;++o,++n)if(sm(r(o))&&++n,n>=t)return o;return o}function cm({offset:t,textLength:e,getCharacterByIndex:r}){let o=0,n=0;for(;o<e;++o,++n){if(o>=t)return n;sm(r(o))&&++n}return n}var lm=["ul","ol"],dm=["blockquote","pullquote"],mm=["header","subheader"],Ry=[...mm,...dm,...lm,"text"];function ca(t,e){return t[e].meta.url}var E={create(t={}){!1&&d(t.viewType==null||Ry.includes(t.viewType));let e=t.characters||[];return typeof e=="string"&&(e=E.createCharacters(e,z.create())),t.viewType=="ol"?{type:f.PARAGRAPH,key:t.key||v(),viewType:t.viewType,textAlign:t.textAlign||"left",characters:e,isOrderedListFirstItem:t.isOrderedListFirstItem||!1}:{type:f.PARAGRAPH,key:t.key||v(),viewType:t.viewType||"text",textAlign:t.textAlign||"left",characters:e}},createCharacters(t,e){return[...t].map(r=>({text:r,meta:e}))},extendHyperlinksSelection(t,e,r=t.characters.length){let{characters:o}=t,n=ca.bind(null,o),i=n(e);if(i)for(;e>0&&i==n(e-1);)--e;let s=n(r-1);if(s)for(;r<o.length&&s==n(r);)++r;return{start:e,end:r}},hasHyperlink(t,e,r=t.characters.length){for(let o=e;o<r;++o)if(ca(t.characters,o))return!0;return!1},getHyperlinksInfo(t){let e=[],r=null;for(let o=0;o<t.length;++o){let n=ca(t,o);r&&r.url!=n&&(e.push({start:r.start,end:o,url:r.url}),r=null),n&&!r&&(r={start:o,url:n})}return r&&e.push({start:r.start,end:t.length,url:r.url}),e},getParagraphText(t){return t.characters.reduce((e,r)=>e+r.text,"")},getCharacters(t){return t.characters.map(e=>e.text)},getWordStartIndex(t,e){return Tc(E.getParagraphText(t),e)},getWordEndIndex(t,e){return vc(E.getParagraphText(t),e)},isList(t){let e=K(t);return!!e&&lm.includes(e.viewType)},isQuote(t){let e=K(t);return!!e&&dm.includes(e.viewType)},isHeading(t){let e=K(t);return!!e&&mm.includes(e.viewType)},isEmptyParagraph(t){let e=K(t);return!!e&&e.characters.length==0},getTextRuns(t,e){e||(e=n=>n);let r=t.characters;if(r.length==0)return[];let o=[{text:r[0].text,styles:e(r[0].meta),isLast:!1}];for(let n=1;n<r.length;++n){let i=r[n],s=e(i.meta),a=o.length-1,c=o[a].styles;z.compare(s,c)?o[a].text+=i.text:o.push({text:i.text,styles:s,isLast:!1})}return o[o.length-1].isLast=!0,o},convertBrowserToModelOffset(t,e){return am({offset:e,textLength:t.characters.length,getCharacterByIndex:r=>t.characters[r].text})},convertModelToBrowserOffset(t,e){return cm({offset:e,textLength:t.characters.length,getCharacterByIndex:r=>t.characters[r].text})}};var So={create(t={}){return{type:"",key:t.key||v(),alignment:t.alignment||"inner"}},toAbstractMediaBlock(t){let e=t;return!t||e.type!==f.EMBED&&e.type!==f.IMAGE&&e.type!==f.COLLAGE&&e.type!==f.TABLE?null:e},getBlockType(t){return t.type===f.COLLAGE?`collage-${t.alignment}`:`media-${t.alignment}`}};var ze={create(t={}){let e=t.characters||[];return typeof e=="string"&&(e=E.createCharacters(e,z.create())),{...So.create(t),width:t.width||0,height:t.height||0,characters:e}},toMediaBlock(t){return!t||t.type!==f.IMAGE&&t.type!==f.EMBED?null:t},getBlockType(t){return`media-${t.alignment}`}};var Wr=class{static create(e){return{captionSelected:e}}};var Je={create(t={}){let e=t.characters||[];return typeof e=="string"&&(e=E.createCharacters(e,z.create())),{type:f.NOTE,key:t.key||v(),noteType:t.noteType||"info",characters:e}},toNoteBlock(t){return t&&t.type===f.NOTE?t:null},getBlockType(t){return"note"}};function Dy(t,e){let r={};for(let o of t){r[o]={colsMap:{}};let i=r[o].colsMap;for(let s of e)i[s]=p.createCell()}return r}function um(t,e,r){let o=v();t.rowsOrder.splice(e,0,o);let n={};for(let i of t.colsOrder){let s=r&&r(i),a=K(s==null?void 0:s.content);n[i]=p.createCell({horizontalTextAlign:a==null?void 0:a.textAlign,verticalTextAlign:s==null?void 0:s.verticalTextAlign,meta:s==null?void 0:s.meta})}return t.rowsMap[o]={colsMap:n},o}function Iy(t,e,r){if(e.length!==t.rowsOrder.length)throw new Error("new rows count must be equal to original table rows count");let o={};for(let n=0;n<t.rowsOrder.length;n++){let i=e[n],s=t.rowsOrder[n];o[i]={colsMap:fm(t,s,r)}}return o}function fm(t,e,r){if(r.length!==t.colsOrder.length)throw new Error("new cols count must be equal to original table cols count");let o={};for(let n=0;n<t.colsOrder.length;n++){let i=r[n],s=t.colsOrder[n],a=t.rowsMap[e].colsMap[s];o[i]=p.cloneCell(a)}return o}function pm(t,e,r){let o=v();t.colsOrder.splice(e,0,o);for(let n of t.rowsOrder){let i=r&&r(n),s=K(i==null?void 0:i.content),a=t.rowsMap[n];a.colsMap[o]=p.createCell({horizontalTextAlign:s==null?void 0:s.textAlign,verticalTextAlign:i==null?void 0:i.verticalTextAlign,meta:i==null?void 0:i.meta})}return o}function la(t,e){return t.colsOrder[0]===e}function My(t,e,r){for(let o of e){let{colsMap:n}=t[o];for(let i of r)if(!n[i])throw new Error(`rowsMap is invalid: ${JSON.stringify(t)}`)}return t}var p={create(t={}){let e=t.rowsOrder||[v(),v(),v()],r=t.colsOrder||[v(),v(),v()];if(!r.length||!e.length)throw new Error("try to create table with 0 length of rowsCount or colsCount");return{type:f.TABLE,key:t.key||v(),alignment:"inner",rowsOrder:e,colsOrder:r,rowsMap:t.rowsMap?My(t.rowsMap,e,r):Dy(e,r),meta:[]}},addColumnBefore(t,e){la(t,e)&&p.removeTableMeta(t,"isHeaderColumnPinned");let r=t.colsOrder.indexOf(e);return pm(t,r,o=>this.getCell(t,o,e))},addColumnAfter(t,e){let r=t.colsOrder.indexOf(e)+1;return pm(t,r,o=>this.getCell(t,o,e))},addLastColumn(t){let e=t.colsOrder[t.colsOrder.length-1];return this.addColumnAfter(t,e)},addRowBefore(t,e){let r=t.rowsOrder.indexOf(e);return um(t,r,o=>this.getCell(t,e,o))},addRowAfter(t,e){let r=t.rowsOrder.indexOf(e)+1;return um(t,r,o=>this.getCell(t,e,o))},addLastRow(t){let e=t.rowsOrder[t.rowsOrder.length-1];return this.addRowAfter(t,e)},duplicateRow(t,e){let r=t.rowsOrder.indexOf(e)+1,o=v();return t.rowsMap[o]={colsMap:fm(t,e,t.colsOrder)},t.rowsOrder.splice(r,0,o),o},moveColumnLeft(t,e){t.colsOrder.length>=2&&t.colsOrder[1]===e&&p.removeTableMeta(t,"isHeaderColumnPinned");let r=t.colsOrder.indexOf(e);if(r<=0)return;let o=r-1,n=t.colsOrder;[n[r],n[o]]=[n[o],n[r]]},moveColumnRight(t,e){la(t,e)&&p.removeTableMeta(t,"isHeaderColumnPinned");let r=t.colsOrder.indexOf(e);if(r>=t.colsOrder.length-1)return;let o=r+1,n=t.colsOrder;[n[r],n[o]]=[n[o],n[r]]},removeColumn(t,e){la(t,e)&&p.removeTableMeta(t,"isHeaderColumnPinned"),t.colsOrder=t.colsOrder.filter(r=>r!==e),t.rowsOrder.forEach(r=>{delete t.rowsMap[r].colsMap[e]})},moveRowUp(t,e){let r=t.rowsOrder.indexOf(e);if(r<=0)return;let o=r-1,n=t.rowsOrder;[n[r],n[o]]=[n[o],n[r]]},moveRowDown(t,e){let r=t.rowsOrder.indexOf(e);if(r>=t.rowsOrder.length-1)return;let o=r+1,n=t.rowsOrder;[n[r],n[o]]=[n[o],n[r]]},duplicateColumn(t,e){let r=t.colsOrder.indexOf(e)+1,o=v();for(let n of t.rowsOrder){let i=t.rowsMap[n],s=i.colsMap[e];i.colsMap[o]=p.cloneCell(s)}return t.colsOrder.splice(r,0,o),o},removeRow(t,e){t.rowsOrder=t.rowsOrder.filter(r=>r!==e),delete t.rowsMap[e]},createCell(t={}){return{key:t.key||v(),content:t.paragraph||E.create({textAlign:t.horizontalTextAlign}),verticalTextAlign:t.verticalTextAlign||"top",meta:t.meta||[]}},toTableBlock(t){return t&&t.type===f.TABLE?t:null},getBlockType(t){return"table"},getCell(t,e,r){return t.rowsMap[e].colsMap[r]},cloneTable(t){let e=v(),r=[];for(let i=0;i<t.rowsOrder.length;i++)r.push(v());let o=[];for(let i=0;i<t.colsOrder.length;i++)o.push(v());let n=Iy(t,r,o);return{type:f.TABLE,key:e,alignment:t.alignment,rowsOrder:r,colsOrder:o,rowsMap:n,meta:t.meta}},cloneCell(t){return{key:v(),content:{...t.content,key:v()},verticalTextAlign:t.verticalTextAlign,meta:t.meta}},addCellMeta(t,e){t.meta=rr(t.meta,e)},addTableMeta(t,e){t.meta=rr(t.meta,e)},removeTableMeta(t,e){t.meta=dn(t.meta,[e])},setCellVerticalAlign(t,e){t.verticalTextAlign=e},setCellHorizontalAlign(t,e){let r=K(t.content);!r||(r.textAlign=e)}};function xo(t,e,r){let o=r.key;Qc(t.blockMap,e,r);let n=null;return ze.toMediaBlock(r)&&(n=Wr.create(!1)),ye.toCollageBlock(r)&&(n=Ar.create({})),Je.toNoteBlock(r)&&(n=Or.create({noteTextSelected:!0})),p.toTableBlock(r)&&(n=se.createTableSelection()),M.toFlipCardsBlock(r)&&(n=nt.createBlockSelection()),{selection:_.create({startKey:o,startOffset:0,endKey:o,endOffset:0,customSelection:n})}}var X=class{static _getFlipCardsBlock(e,r){let o=e.blockMap.blocks[r];return o?M.toFlipCardsBlock(o):null}static getFirstCard(e){return d(Rt(e.cardsBlockMap))}static changeBlockBackground(e,r,o){let n=X._getFlipCardsBlock(e,r);return n?(M.changeBackground(n,o),{selection:_.createFlipCardsBlockSelection(r)}):{selection:_.create()}}static changeSideContentType(e,r,o,n){let i=X._getFlipCardsBlock(e,r);return i?(je(i.cardsBlockMap,s=>{M.changeFlipCardContentType(s,o,n)}),{selection:_.createFlipCardsBlockSelection(r)}):{selection:_.create()}}static changeRowMaxCardsCount(e,r,o){let n=X._getFlipCardsBlock(e,r);return n?(M.changeRowMaxCardsCount(n,o),{selection:_.createFlipCardsBlockSelection(r)}):{selection:_.create()}}static changeBlockLayout(e,r,o){let n=X._getFlipCardsBlock(e,r);return n?(M.changeLayout(n,o),{selection:_.createFlipCardsBlockSelection(r)}):{selection:_.create()}}static addCard(e,r){let o=X._getFlipCardsBlock(e,r);return o?(M.addFlipCard(o),{selection:_.createFlipCardsBlockSelection(r)}):{selection:_.create()}}static changeSideVerticalAlignment(e,r,o,n){let i=X._getFlipCardsBlock(e,r);return i?(i.cardsBlockMap.order.forEach(s=>M.changeCardSideVerticalAlignment(i,s,o,n)),{selection:_.createFlipCardsBlockSelection(r)}):{selection:_.create()}}static changeCardTextVerticalAlignment(e,r,o){let{startKey:n}=r,{cardKey:i,cardSide:s}=r.customSelection,a=X._getFlipCardsBlock(e,n);return a?(M.changeCardSideVerticalAlignment(a,i,s,o),{selection:r}):{selection:_.create()}}static removeCard(e,r,o){let n=X._getFlipCardsBlock(e,r);return n?(M.removeFlipCard(n,o),M.getFlipCardsCount(n)?{selection:_.createFlipCardsBlockSelection(r)}:xo(e,r,E.create())):{selection:_.create()}}static duplicateCard(e,r,o){let n=X._getFlipCardsBlock(e,r);return n?(M.duplicateCard(n,o),{selection:_.createFlipCardsBlockSelection(r)}):{selection:_.create()}}static moveCardToLeft({contentState:e,blockKey:r,cardKey:o}){let n=X._getFlipCardsBlock(e,r);return n?(M.moveFlipCardToLeft(n,o),{selection:_.createFlipCardsBlockSelection(r)}):{selection:_.create()}}static moveCardToRight({contentState:e,blockKey:r,cardKey:o}){let n=X._getFlipCardsBlock(e,r);return n?(M.moveFlipCardToRight(n,o),{selection:_.createFlipCardsBlockSelection(r)}):{selection:_.create()}}static changeCardImage(e,r,o,n){let i=X._getFlipCardsBlock(e,r);return i?(M.changeFlipCardBackgroundImage({block:i,cardKey:o.key,sideType:o.sideType,image:n}),{selection:_.createFlipCardsBlockSelection(r)}):{selection:_.create()}}static changeCardsSideBackground(e,r,o,n){let i=X._getFlipCardsBlock(e,r);return i?(je(i.cardsBlockMap,s=>{M.changeFlipCardBackgroundColor(i,s.key,o,n)}),{selection:_.createFlipCardsBlockSelection(r)}):{selection:_.create()}}static changeCardBackgroundImage(e,r,o,n){let i=X._getFlipCardsBlock(e,r);return i?(M.changeFlipCardBackgroundImage({block:i,cardKey:o.key,sideType:o.sideType,image:n}),{selection:_.createFlipCardsBlockSelection(r)}):{selection:_.create()}}static changeCardsSideBackgroundImage(e,r,o,n){let i=X._getFlipCardsBlock(e,r);return i?(je(i.cardsBlockMap,s=>{M.changeFlipCardBackgroundImage({block:i,cardKey:s.key,sideType:o,image:n})}),{selection:_.createFlipCardsBlockSelection(r)}):{selection:_.create()}}static changeCardBackgroundColor(e,r,o,n){let i=X._getFlipCardsBlock(e,r);return i?(M.changeFlipCardBackgroundColor(i,o.key,o.sideType,n),{selection:_.createFlipCardsBlockSelection(r)}):{selection:_.create()}}static changeCardBackgroundImageOverlay(e,r,o,n){let i=X._getFlipCardsBlock(e,r);return i?(M.changeCardImageOverlay({block:i,cardKey:o.key,sideType:o.sideType,overlay:n}),{selection:_.createFlipCardsBlockSelection(r)}):{selection:_.create()}}static changeCardsSideBackgroundImageOverlay(e,r,o,n){let i=X._getFlipCardsBlock(e,r);return i?(je(i.cardsBlockMap,s=>{M.changeCardImageOverlay({block:i,cardKey:s.key,sideType:o,overlay:n})}),{selection:_.createFlipCardsBlockSelection(r)}):{selection:_.create()}}static changeCardImageOverlay(e,r,o,n){let i=X._getFlipCardsBlock(e,r);return i?(M.changeFlipCardBackgroundImageOverlay({block:i,cardKey:o.key,sideType:o.sideType,overlay:n}),{selection:_.createFlipCardsBlockSelection(r)}):{selection:_.create()}}static cropCardImage(e,r,o,n){let i=X._getFlipCardsBlock(e,r);return i?(M.cropFlipCardImage({block:i,cardKey:o.key,sideType:o.sideType,crop:n}),{selection:_.createFlipCardsBlockSelection(r)}):{selection:_.create()}}static cropCardBackgroundImage(e,r,o,n){let i=X._getFlipCardsBlock(e,r);return i?(M.cropFlipCardBackgroundImage({block:i,cardKey:o.key,sideType:o.sideType,crop:n}),{selection:_.createFlipCardsBlockSelection(r)}):{selection:_.create()}}};var bo={defaultMaxCardsInRow:3,defaultCardsLayout:"outer",defaultActiveSide:"front",maxCardsInRowInnerLayout:3,maxCardsInRowOuterLayout:4,maxCardsInRowFullLayout:5},wo={text:{frontSide:{getBackgroundColor:aa,opacity:1},backSide:{getBackgroundColor:()=>ko.blackDefault,opacity:.1},defaultOverlayColor:{color:kd,opacity:.3}},imageWithText:{frontSide:{getBackgroundColor:aa,opacity:1},backSide:{getBackgroundColor:()=>ko.blackDefault,opacity:.1},defaultOverlayColor:{color:Ee,opacity:.3}}},ua={front:z.create({style:$e.create([{name:"fontColor",color:ko.whiteDefault},{name:"fontSize",size:"auto"},{name:"bold"}])}),back:z.create({style:$e.create([{name:"fontColor",color:ko.darkDefault},{name:"fontSize",size:"auto"}])})};function pa(t={}){return{type:"image",image:t.image?ia(t.image):null}}function Sm(t){if(!t)return;let e=We(t,"charactersMeta");if(e&&e.name==="charactersMeta")return e.data}function xm(t,e){return[{name:"charactersMeta",data:e||ua[t]}]}function To(t){let e=t.characterMeta||Sm(t.meta),r=U(t.sideType,{front:wm(e),back:Tm(e)});return{type:"text",background:t.background||bm(t.sideType),text:E.create({key:t.paragraphKey,textAlign:t.textAlign||"center",characters:t.characters||r}),verticalTextAlign:t.verticalTextAlign||"middle",meta:t.meta||xm("front",e)}}function fa(t){let e=U(t.sideType,{front:wo.imageWithText.frontSide,back:wo.imageWithText.backSide}),r=t.characterMeta||Sm(t.meta),o=U(t.sideType,{front:wm(r),back:Tm(r)});return{type:"imageWithText",background:t.background||{type:"color",color:e.getBackgroundColor(),opacity:e.opacity},image:t.image?ia(t.image):null,text:E.create({key:t.paragraphKey,textAlign:t.textAlign||"center",characters:t.characters||o}),verticalTextAlign:t.verticalTextAlign||"middle",meta:t.meta||xm("front",r)}}function bm(t){let e=U(t,{front:wo.text.frontSide,back:wo.text.backSide});return{type:"color",color:e.getBackgroundColor(),opacity:e.opacity}}function wm(t){let e=t||ua.front;return E.createCharacters(x("Roll.Editor.FlipCardsBlock.DefaultText.FrontTextSide"),e)}function Tm(t){let e=t||ua.back;return E.createCharacters(x("Roll.Editor.FlipCardsBlock.DefaultText.BackTextSide"),e)}function da(t){let{contentType:e}=t;switch(e){case"image":return pa(t);case"text":return To(t);case"imageWithText":return fa(t);default:throw F(e),new Error(`Unknown card content type: ${e}`)}}function Ay(t,e){return t.cardsBlockMap.blocks[e]||null}function Qn(t,e,r){let o=Ay(t,e);if(!o)return null;switch(r){case"front":return o.frontSide;case"back":return o.backSide;default:throw F(r),Error()}}function Ur(t,e,r){switch(e){case"front":t.frontSide=r;break;case"back":t.backSide=r;break}}function Oy({cardData:t,sideData:e,sideType:r,contentType:o}){o==="image"&&Ur(t,r,pa({image:e.image})),o==="text"&&Ur(t,r,To({verticalTextAlign:e.verticalTextAlign,characters:e.text.characters,textAlign:e.text.textAlign,background:e.background,meta:e.meta,sideType:r}))}function Fy({cardData:t,sideData:e,sideType:r,contentType:o}){o==="imageWithText"&&Ur(t,r,fa({image:e.image,sideType:r})),o==="text"&&Ur(t,r,To({sideType:r}))}function Py({cardData:t,sideData:e,sideType:r,contentType:o}){o==="image"&&Ur(t,r,pa()),o==="imageWithText"&&Ur(t,r,fa({verticalTextAlign:e.verticalTextAlign,characters:e.text.characters,textAlign:e.text.textAlign,background:e.background&&e.background.type==="color"?e.background:null,meta:e.meta,sideType:r}))}function hm({block:t,cardKey:e,sideType:r,overlay:o}){let n=Qn(t,e,r);!n||((n.type==="image"||n.type==="imageWithText")&&n.image&&(n.image.overlay=o),n.type==="text"&&n.background.type==="image"&&(n.background.overlay=o))}function gm({block:t,cardKey:e,sideType:r,image:o}){var i;let n=Qn(t,e,r);!n||((n.type==="image"||n.type==="imageWithText")&&(n.image=o?{...o,overlay:(i=n.image)==null?void 0:i.overlay}:null),n.type==="text"&&(n.background.type==="image"&&!o&&(n.background=bm(r)),n.background.type==="image"&&o&&(n.background.image=o),n.background.type==="color"&&o&&(n.background={type:"image",image:o,overlay:wo.text.defaultOverlayColor})))}function ym({block:t,cardKey:e,sideType:r,crop:o}){let n=Qn(t,e,r);!n||(n.type!=="text"?n.image&&(n.image.crop=o):n.background.type==="image"&&(n.background.image.crop=o))}function ma(){return{key:v(),frontSide:To({sideType:"front"}),backSide:To({sideType:"back"})}}function Ny(){return rn([ma(),ma(),ma()],t=>t.key)}function _m(t){let e=ls(t);switch(t.type){case"image":return e;case"imageWithText":case"text":return{...e,text:{...t.text,key:v()}}}}function vm(t){return{key:v(),frontSide:_m(t.frontSide),backSide:_m(t.backSide)}}function Ly(t){let e={blocks:{},order:[]};return je(t.cardsBlockMap,r=>{let o=vm(r);ws(e,o)}),e}function Cm(t){switch(t.contentType){case"image":return da({contentType:"image"});case"text":return da({contentType:"text",sideType:t.sideType,meta:t.meta,verticalTextAlign:t.verticalTextAlign,textAlign:t.horizontalTextAlign,background:t.background,characterMeta:t.characterMeta});case"imageWithText":return da({contentType:"imageWithText",sideType:t.sideType,meta:t.meta,verticalTextAlign:t.verticalTextAlign,textAlign:t.horizontalTextAlign,background:t.background.type==="color"?t.background:void 0,characterMeta:t.characterMeta})}}function km(t,e){let{frontSideType:r,backSideType:o}=M.getFlipCardsSideTypes(t),n=U(e,{front:r,back:o});if(n==="image")return Cm({contentType:n});let i=d(M.getFlipCardsStyles(t,e));return Cm({contentType:n,sideType:e,horizontalTextAlign:i.horizontalTextAlign,verticalTextAlign:i.verticalTextAlign,background:i.background,meta:i.meta,characterMeta:z.create({style:i.styles})})}var M={create(t={}){return{type:f.FLIP_CARD,key:t.key||v(),cardsBlockMap:t.cardsBlockMap||Ny(),maxCardsInRow:t.maxCardsInRow||bo.defaultMaxCardsInRow,cardsLayout:t.cardsLayout||bo.defaultCardsLayout,background:t.background||null}},clone(t){return{type:f.FLIP_CARD,key:v(),cardsLayout:t.cardsLayout,background:ls(t.background),maxCardsInRow:t.maxCardsInRow,cardsBlockMap:Ly(t)}},getCardParagraph(t,e,r){let o=M.getFlipCardSideData(t,e,r);return o.type!=="image"?o.text:null},getCardData(t,e){return t.cardsBlockMap.blocks[e]||null},changeCardSideVerticalAlignment(t,e,r,o){let n=M.getFlipCardSideData(t,e,r);n.type!=="image"&&(n.verticalTextAlign=o)},addFlipCard(t){let e=km(t,"front"),r=km(t,"back"),o={key:v(),frontSide:e,backSide:r};ws(t.cardsBlockMap,o)},duplicateCard(t,e){let r=t.cardsBlockMap.blocks[e],o=vm(r);zc(t.cardsBlockMap,e,o)},removeFlipCard(t,e){Gc(t.cardsBlockMap,e);let r=Bt(t.cardsBlockMap);r<t.maxCardsInRow&&M.changeRowMaxCardsCount(t,r)},moveFlipCardToRight(t,e){let r=Bt(t.cardsBlockMap),o=t.cardsBlockMap.order.findIndex(s=>s===e);if(o===-1||o>=r-1)return;let n=o+1,i=t.cardsBlockMap.order;[i[o],i[n]]=[i[n],i[o]]},moveFlipCardToLeft(t,e){let r=t.cardsBlockMap.order.findIndex(i=>i===e);if(r===-1||r===0)return;let o=r-1,n=t.cardsBlockMap.order;[n[r],n[o]]=[n[o],n[r]]},changeFlipCardImage(t){gm(t)},changeFlipCardBackgroundImage(t){gm(t)},cropFlipCardImage(t){ym(t)},cropFlipCardBackgroundImage(t){ym(t)},getFlipCardSideData(t,e,r){let o=M.getCardData(t,e);return U(r,{front:o.frontSide,back:o.backSide})},getFlipCardsSideTypes(t){let e=t.cardsBlockMap.order[0],r=t.cardsBlockMap.blocks[e];return{frontSideType:r.frontSide.type,backSideType:r.backSide.type}},getBlockType(t){return"flip-cards"},toFlipCardsBlock(t){return t&&t.type===f.FLIP_CARD?t:null},changeFlipCardBackgroundColor(t,e,r,{color:o,opacity:n}){let i=Qn(t,e,r);!i||(i.type==="text"||i.type==="imageWithText")&&(i.background={type:"color",color:o,opacity:n})},changeFlipCardBackgroundImageOverlay(t){hm(t)},changeCardImageOverlay(t){hm(t)},changeFlipCardContentType(t,e,r){let o=U(e,{front:t.frontSide,back:t.backSide});o.type==="image"&&Fy({cardData:t,sideData:o,sideType:e,contentType:r}),o.type==="imageWithText"&&Oy({cardData:t,sideData:o,sideType:e,contentType:r}),o.type==="text"&&Py({cardData:t,sideData:o,sideType:e,contentType:r})},changeBackground(t,e){t.background=e},changeRowMaxCardsCount(t,e){t.maxCardsInRow=e},changeLayout(t,e){t.cardsLayout=e;let r=U(e,{inner:bo.maxCardsInRowInnerLayout,outer:bo.maxCardsInRowOuterLayout,"full-width":bo.maxCardsInRowFullLayout}),o=Bt(t.cardsBlockMap),n=Math.min(o,r);n<t.maxCardsInRow&&M.changeRowMaxCardsCount(t,n)},getFlipCardsCount(t){return Bt(t.cardsBlockMap)},addFlipCardSideMeta(t,e){t.type!=="image"&&(t.meta=rr(t.meta,e))},getFlipCardsStyles(t,e){var s;let r=X.getFirstCard(t),o=U(e,{front:r.frontSide,back:r.backSide});if(o.type==="image")return null;let n,i=o.text.characters;return i.length===0?n=((s=Un(o))==null?void 0:s.style)||[]:n=i[0].meta.style,{styles:n,verticalTextAlign:o.verticalTextAlign,horizontalTextAlign:o.text.textAlign,background:o.background,meta:o.meta}}};var Yn={create(t){return{...E.create({key:t.key,characters:t.characters,viewType:t.viewType,textAlign:t.textAlign,isOrderedListFirstItem:t.isOrderedListFirstItem}),tableKey:t.tableKey,rowKey:t.rowKey,colKey:t.colKey,cellKey:t.cellKey,meta:t.meta||[]}},toCellParagraph(t){if(t&&t.type===f.PARAGRAPH){let e=t;if(e.tableKey&&e.rowKey&&e.colKey&&e.cellKey&&e.meta)return t}return null}};function et(t,e){let r=K(t);if(r)return r;let o=ze.toMediaBlock(t);if(o)return o;let n=Je.toNoteBlock(t);if(n)return n;let i=ye.toCollageBlock(t);if(i&&e&&e.customSelection&&e.customSelection.collageItemCaptionSelected){let c=d(e.customSelection),l=ye.getCollagedImage(i,c.collageSelectedItemKey);if(l)return l}let s=p.toTableBlock(t);if(s&&e&&se.isCellSelected(e)){let c=e.customSelection,l=p.getCell(s,c.rowKey,c.colKey),m=K(l.content);if(m)return Yn.create({...m,tableKey:s.key,colKey:c.colKey,rowKey:c.rowKey,cellKey:l.key})}let a=M.toFlipCardsBlock(t);if(a&&e&&nt.isCardTextSelection(e)){let c=e.customSelection,l=M.getCardParagraph(a,c.cardKey,c.cardSide);if(l)return l}return null}function ha(t){return $y(t)||Ky(t)}function $y({contentState:t,selection:e}){let{startKey:r,customSelection:o}=e;return!!ze.toMediaBlock(t.blockMap.blocks[r])&&!!o&&o.captionSelected}function Ky({contentState:t,selection:e}){let{startKey:r,customSelection:o}=e;return!!ye.toCollageBlock(t.blockMap.blocks[r])&&!!o&&o.collageItemCaptionSelected}function qn(t){let e=et(t);return e?e.characters.length:0}function Xn(t,e,r){let o={"font-size":"","caret-color":"","line-height":""};if(qn(t)!==0)return o;let n=e==null?void 0:e.style;if(n){let i=We(n,"fontSize");if(i&&i.name==="fontSize"&&i.size!=="auto"&&(o["font-size"]=`${i.size}px`,o["line-height"]=r(i.size)),!Mc()){let s=We(n,"fontColor");s&&s.name==="fontColor"&&(o["caret-color"]=s.color)}}return o}var Ge={NBSP:String.fromCharCode(160),ZERO_WIDTH_SPACE:String.fromCharCode(8203),ELLIPSIS:"\u2026",NDASH:"\u2013",GREATER_THAN_OR_EQUAL_TO:String.fromCharCode(8805),LESS_THAN:String.fromCharCode(60),PERCENT:String.fromCharCode(37)};var zr=class{constructor(){this._ids={}}generate(e){return pe(this._ids[e])?`${e}_${++this._ids[e]}`:(this._ids[e]=0,e)}};var Qe=class{constructor({paragraph:e,subtitleKey:r="",bemInfo:o,blockBeforeType:n,idPrefix:i="",placeholder:s="",prompt:a="",paragraphIndex:c,direction:l}){this._paragraph=e,this._direction=l,this._subtitleKey=r,this.paragraphIndex=c,this._isPrompt=!!a,this._className=this._getClassName({bemInfo:o,blockBeforeType:n});let m=["subtitle"];this.ignoreInlineStyles=m.includes(this.type());let u=["header","subheader"];this.invertBold=u.includes(this.type());let g=["blockquote","pullquote"];this.invertItalic=g.includes(this.type()),this.renderId=i+e.key,this.placeholder=a||s}_getClassName({bemInfo:e,blockBeforeType:r}){let o=e||new le("paragraph-block"),n=`${o.className()}`;if(n+=` ${o.getModifierWithValueClassName("type",this.type())}`,n+=` ${o.getModifierWithValueClassName("align",this.textAlign())}`,this._direction&&(n+=` ${o.getModifierWithValueClassName("dir",this._direction)}`),r&&(n+=` ${o.getModifierWithValueClassName("after",r)}`),this._paragraph.characters.length==0){let i=this._isPrompt?"prompt":"empty";n+=` ${o.getModifierClassName(i)}`}return n}paragraph(){return this._paragraph}type(){return this._paragraph.key===this._subtitleKey?"subtitle":this._paragraph.viewType}textAlign(){return this._paragraph.textAlign}className(){return this._className}getLineHeightForFontSize(e){return Gn(e)}getFontSize(e){if(e==="auto")throw Error("cannot set 'auto' font-size in default paragraph");return e}};var jn={};function Hy(t){return jn[t]||(jn[t]={}),jn[t]}function Vy(t){delete jn[t]}function Wy(t,e,r,o,n){if(!t)return null;let i=t.style,s="",a=[],c="",l=1;if(i.forEach(m=>{switch(m.name){case"bold":s+=`font-weight: ${r?"normal":"bold"};`;break;case"italic":s+=`font-style: ${e?"normal":"italic"};`;break;case"underline":a.push("underline");break;case"strikethrough":a.push("line-through");break;case"fontSize":{let u=o(m.size);s+=`font-size: ${u}px;`,s+=`line-height: ${n(u)};`;break}case"fontColor":s+=`color: ${m.color};`;break;case"textHighlightColor":{c=m.color;break}case"textHighlightOpacity":l=m.opacity;break;default:F(m)}}),a.length&&(s+=`text-decoration: ${a.join(" ")};`),c&&c!==Ee){let[m,u,g]=ie(c);s+=`background-color: rgba(${m}, ${u}, ${g}, ${l});`}return s}function Em({styles:t,ignoreInlineStyles:e}){return e?z.create({url:t.url}):t}function Uy({characters:t,ignoreInlineStyles:e}){if(t.length==0)return[];let r=[{text:t[0].text,styles:Em({styles:t[0].meta,ignoreInlineStyles:e})}];for(let o=1;o<t.length;++o){let n=t[o],i=Em({styles:n.meta,ignoreInlineStyles:e}),s=r.length-1,a=r[s].styles;z.compare(i,a)?r[s].text+=n.text:r.push({text:n.text,styles:i})}return r}function Bm(t,e,r,o){return D(t,`:${e}`)`
		<span style=${r}>${o}</span>`}function zy(t,e,r,o,n,i){return D(t,`:${e}`)`
		<a href=${n} target=_blank onmouseover=${i}><span style=${r}>${o}</span></a>`}function ct(t,e,r=!1,o=!1){let n=t.paragraph(),i=Uy({characters:n.characters,ignoreInlineStyles:t.ignoreInlineStyles}),s=[],a=new zr,c=!1,l=Hy(t.renderId);if(i.forEach((k,w)=>{let L=Wy(k.styles,t.invertItalic,t.invertBold,t.getFontSize.bind(t),t.getLineHeightForFontSize.bind(t)),j=a.generate(`${t.renderId}_${k.text}_${L}`),ce=k.text;w==i.length-1&&ce.endsWith(`
`)&&(ce+=Ge.ZERO_WIDTH_SPACE);let He=k.styles.url,De=He?zy(l,j,L,ce,He,e):Bm(l,j,L,ce);He&&(c=!0),s.push(De)}),s.length)c&&Vy(t.renderId);else{let k=a.generate(`${t.renderId}_empty`),w=Bm(l,k,null,Ge.ZERO_WIDTH_SPACE);s.push(w)}let m=`enter-blockquote-field-${t.paragraphIndex}`,u=`enter-list-item-field-${t.paragraphIndex}`,g=`enter-paragraph-field-${t.paragraphIndex}`,b=D(l,`:${t.renderId}`),N=o?" lock-block":"",I=r?" read-only-block":"",R=t.className()+N+I,y=!o&&!r;switch(n.viewType){case"header":return b`<h3 class=${R} data-key=${n.key} contenteditable=${y}>${s}</h3>`;case"subheader":return b`<h4 class=${R} data-key=${n.key} contenteditable=${y}>${s}</h4>`;case"blockquote":case"pullquote":return b`<blockquote class=${R} data-key=${n.key} data-at=${ee(m)} contenteditable=${y}>${s}</blockquote>`;case"ol":case"ul":return b`<li class=${R} data-key=${n.key} data-at=${ee(u)} contenteditable=${y}>${s}</li>`}return b`
		<p
			class=${R}
			data-key=${n.key}
			data-placeholder=${o||I?null:t.placeholder}
			data-at=${ee(g)}
			contenteditable=${y}
		>${s}</p>`}var Zn=class extends Qe{constructor({paragraph:e,subtitleKey:r,bemInfo:o,blockBeforeType:n,idPrefix:i,placeholder:s,prompt:a,paragraphIndex:c,flipCardSideRef:l}){super({paragraph:e,subtitleKey:r,bemInfo:o,blockBeforeType:n,idPrefix:i,placeholder:s,prompt:a,paragraphIndex:c}),this._flipCardSideElement=l}getFontSize(e){if(e!=="auto")return e;let r=this._flipCardSideElement.current;if(!r)return 0;let{width:o}=r.getBoundingClientRect();return o>=420?24:o>=260?20:o>=200?18:16}};var Gy={},Gr=class extends Ae{constructor({cardKey:e,flipCardsBlockKey:r,sideType:o,contentType:n,onHyperlinkOverFn:i,isLock:s,readonlyMode:a}){super(),this._cardKey=e,this._flipCardsBlockKey=r,this._sideType=o,this._contentType=n,this._onHyperlinkOverFn=i,this._readonlyMode=a,this._isLock=s,this.onSheduleRenderSignal=this._createSignal(),this._cardRef={current:null},this._cardResizeObserver=new ResizeObserver(()=>this._invalidateSideRenderer()),this._paragraphResizeObserver=new ResizeObserver(()=>this._invalidateSideRenderer())}setLockMode(e){this._isLock!==e&&(this._isLock=e)}cardRef(){return this._cardRef}renderParagraphWrapper(e,r,o,n){return D(Gy,`:flip-card-side-content-paragraph-${this._cardKey}-${this._sideType}-${this._contentType}`)`
			<div
				contenteditable=${!this._readonlyMode&&!this._isLock}
				class=${this._getParagraphWrapperClasses(r)}
				onscroll=${this._invalidateSideRenderer.bind(this)}
				data-flip-cards-key=${this._flipCardsBlockKey}
				data-card-key=${this._cardKey}
				data-side=${this._sideType}
			>
				${this._renderParagraph(e,r,o,n)}
			</div>
		`}getBackgroundStyles(e){if(e.type!=="color"||e.color===Ee)return null;let[r,o,n]=ie(e.color),i=e.opacity;return`background: rgba(${r}, ${o}, ${n}, ${i})`}getParagraphStyles(e){return e.type==="image"?{}:Xn(e.text,Un(e),Gn)}getControlBackgroundData(e){return go(e)}onConnected(e){this._cardResizeObserver.observe(e);let r=d(e.querySelector(".flip-card-paragraph"));this._paragraphResizeObserver.observe(r)}onDisconnected(){this._cardResizeObserver.disconnect(),this._paragraphResizeObserver.disconnect()}_setPlaceholderColor(e,r){if(!e)return;let o=n=>{let i=Br(),s=U(n,{dark:i.textSubdued,light:i.textOncolorSecondary});yt(e,"--placeholder-color",s)};Lr({background:go(r),setStyle:o})}_renderParagraph(e,r,o,n){let i=K(e);if(!i)throw new Error;let s=ct(new Zn({paragraph:i,placeholder:x("Roll.Editor.FlipCardsBlock.Card.TextPlaceholder"),idPrefix:"flip-card-paragraph",blockBeforeType:null,flipCardSideRef:this._cardRef}),this._onHyperlinkOverFn,this._readonlyMode,this._isLock);return s.classList.add("flip-card-paragraph"),this._setPlaceholderColor(s,o),Er(s,n),s}_getParagraphWrapperClasses(e){let r=new le("card-paragraph-wrapper"),o=`${r.className()}`;return o+=` ${r.getModifierWithValueClassName("vertical-align",e)}`,o}_invalidateSideRenderer(){this.onSheduleRenderSignal.dispatch()}};var Qy={},vo=class extends Kt{constructor({cardData:e,sideData:r,sideType:o,onHyperlinkOverFn:n,readonlyMode:i,isLock:s,relatedData:a,flipCardsBlockKey:c}){super({flipCardsBlockKey:c,cardData:e,sideData:r,sideType:o,onHyperlinkOverFn:n,readonlyMode:i,isLock:s,relatedData:a}),this._sideWithImageHelper=new Vr({readonlyMode:i,cardKey:e.key,sideType:o,contentType:"imageWithText"}),this._sideWithTextHelper=new Gr({readonlyMode:i,onHyperlinkOverFn:n,sideType:o,contentType:"imageWithText",cardKey:this._cardData.key,flipCardsBlockKey:c,isLock:s}),this._addSignal(this._sideWithTextHelper.onSheduleRenderSignal,()=>this._sheduleRender())}onUploadImageSignal(){return this._sideWithImageHelper.onUploadImageSignal}onCropImageSignal(){return this._sideWithImageHelper.onCropImageSignal}onRemoveImageSignal(){return this._sideWithImageHelper.onRemoveImageSignal}onFileDialogOpenSignal(){return this._sideWithImageHelper.onFileDialogOpenSignal}setImageBlobData(e){this._sideWithImageHelper.setImageBlobData(e),this._sheduleRender()}setSideData(e){this._sideWithImageHelper.setImageBlobData(null),super.setSideData(e)}setLockMode(e){this._sideWithTextHelper.setLockMode(e),super.setLockMode(e)}_getControlBackgroundData(){return this._sideWithTextHelper.getControlBackgroundData(this._sideData.background)}_onConnected(){let e=this.domElement();this._sideWithTextHelper.onConnected(e)}_onDisconnected(){this._sideWithTextHelper.onDisconnected()}_renderCardContent(){let e=this._sideData.text;return D(Qy,`:flip-card-side-content-${this._cardData.key}-${this._sideType}-${this._sideData.type}`)`
<div
	class='image-with-text-side-content'
	save-ref=${this._sideWithTextHelper.cardRef()}
	onconnected=${this._onConnected.bind(this)}
	ondisconnected=${this._onDisconnected.bind(this)}
>
	<div class='image-wrapper'>
		${this._sideWithImageHelper.renderImageContent(this._sideData.image,this._renderFunctionEx(`:flip-card-side-content-image-${this._cardData.key}-${this._sideType}-${this._sideData.type}`))}
	</div>
	<div
		class='text-wrapper'
		style=${this._sideWithTextHelper.getBackgroundStyles(this._sideData.background)}
	>
		${this._sideWithTextHelper.renderParagraphWrapper(e,this._sideData.verticalTextAlign,this._sideData.background,this._sideWithTextHelper.getParagraphStyles(this._sideData))}
	</div>
</div>
		`}};var Yy={},Jn=class extends O{constructor(e,r,o){super({blockName:"text-side-background-image"}),this._cardKey=e,this._sideType=r,this._backgroundImageBlobData=null,this._imageBackground=o.type==="image"?o:null}setBackgroundImageBlobData(e){this._backgroundImageBlobData=e,this._sheduleRender()}setBackgroundImageData(e){this._imageBackground=e,this._sheduleRender()}hasImageOnBackground(){return!!this._imageBackground||!!this._backgroundImageBlobData}_getBackgroundImageOverlayStyles(){var s;let e=(s=this._imageBackground)==null?void 0:s.overlay;if(!e||e.color===Ee)return null;let[r,o,n]=ie(e.color),i=e.opacity;return`background: rgba(${r}, ${o}, ${n}, ${i})`}_renderBlobBackgroundImage(){if(!this._backgroundImageBlobData)return null;let e={image:this._backgroundImageBlobData,imageRatio:{ratioX:ar.text.ratioX,ratioY:ar.text.ratioY},isTemporary:!0};return ae(cr)(e)}_renderBackgroundImage(){if(this._backgroundImageBlobData)return this._renderBlobBackgroundImage();if(!this._imageBackground)return null;let e={image:this._imageBackground.image,imageRatio:{ratioX:ar.text.ratioX,ratioY:ar.text.ratioY}};return ae(cr)(e,this._renderFunctionEx(`:flip-card-side-image-${this._cardKey}-${this._sideType}`))}_render(){return D(Yy,`:flip-card-side-background-image-${this._cardKey}-${this._sideType}`)`
<div class="text-side-background-image">
	${this._renderBackgroundImage()}
	<div
		class="text-side-background-image-overlay"
		style=${this._getBackgroundImageOverlayStyles()}
	>
	</div>
</div>
		`}};var qy={},Eo=class extends Kt{constructor({cardData:e,sideData:r,sideType:o,onHyperlinkOverFn:n,readonlyMode:i,relatedData:s,flipCardsBlockKey:a,isLock:c}){super({flipCardsBlockKey:a,cardData:e,sideData:r,sideType:o,onHyperlinkOverFn:n,readonlyMode:i,relatedData:s,isLock:c}),this._backgroundImage=new Jn(e.key,o,r.background),this._sideWithTextHelper=new Gr({readonlyMode:i,onHyperlinkOverFn:n,sideType:o,contentType:"text",cardKey:this._cardData.key,flipCardsBlockKey:a,isLock:c}),this._addSignal(this._sideWithTextHelper.onSheduleRenderSignal,()=>this._sheduleRender())}_getControlBackgroundData(){return this._sideWithTextHelper.getControlBackgroundData(this._sideData.background)}setLockMode(e){this._sideWithTextHelper.setLockMode(e),super.setLockMode(e)}setBackgroundImageBlobData(e){this._backgroundImage.setBackgroundImageBlobData(e),this._sheduleRender()}setSideData(e){e.background.type==="image"?this._backgroundImage.setBackgroundImageData(e.background):this._backgroundImage.setBackgroundImageData(null),this._backgroundImage.setBackgroundImageBlobData(null),super.setSideData(e)}_getBackgroundStyles(){let e=this._sideData.background;if(e.type!=="color"||this._backgroundImage.hasImageOnBackground()||e.color===Ee)return null;let[o,n,i]=ie(e.color),s=e.opacity;return`background: rgba(${o}, ${n}, ${i}, ${s})`}_onConnected(){let e=this.domElement();this._sideWithTextHelper.onConnected(e)}_onDisconnected(){this._sideWithTextHelper.onDisconnected()}_renderCardContent(){let e=this._sideData.text;return D(qy,`:flip-card-side-content-${this._cardData.key}-${this._sideType}-${this._sideData.type}`)`
<div
	class='text-side-content'
	save-ref=${this._sideWithTextHelper.cardRef()}
	onconnected=${this._onConnected.bind(this)}
	ondisconnected=${this._onDisconnected.bind(this)}
	style=${this._getBackgroundStyles()}
>
	${this._backgroundImage.domElement()}
	${this._sideWithTextHelper.renderParagraphWrapper(e,this._sideData.verticalTextAlign,this._sideData.background,this._sideWithTextHelper.getParagraphStyles(this._sideData))}
</div>
		`}};var Xy={},kt=new WeakMap,ei=class extends O{constructor({flipCardsBlockKey:e,cardData:r,onHyperlinkOverFn:o,readonlyMode:n,isLock:i,relatedData:s}){super({blockName:"flip-card",relatedData:s}),this._flipCardsBlockKey=e,this._cardData=r,this._readonlyMode=n,this._isLock=i,this._onHyperlinkOverFn=o,this._activeSideType="front",this.onClickSignal=this._createSignal(),this.onMouseEnterSignal=this._createSignal(),this.onMouseLeaveSignal=this._createSignal(),this.onUploadImageSignal=this._createSignal(),this.onCropImageSignal=this._createSignal(),this.onRemoveImageSignal=this._createSignal(),this.onFileDialogOpenSignal=this._createSignal(),this._frontSideRenderer=this._getSideRenderer("front"),this._backSideRenderer=this._getSideRenderer("back"),this.updateModifier("active-side",this._activeSideType),this.updateModifier("readonly",this._readonlyMode)}key(){return this._cardData.key}setLockMode(e){this._isLock!==e&&(this._isLock=e,this._frontSideRenderer.setLockMode(e),this._backSideRenderer.setLockMode(e))}setCardData(e){e!==this._cardData&&(this._cardData=e,this._invalidateSidesRenderer(),this._sheduleRender())}activeSide(){return this._activeSideType}setActiveSide(e){this._activeSideType!==e&&(this._activeSideType=e,this.updateModifier("active-side",e))}setImageBlobOnActiveSide(e){let r=this._getActiveSideRenderer();(r instanceof Co||r instanceof vo)&&r.setImageBlobData(e)}setBackgroundImageBlobOnActiveSide(e){let r=this._getActiveSideRenderer();r instanceof Eo&&r.setBackgroundImageBlobData(e)}_getActiveSideRenderer(){return U(this._activeSideType,{front:this._frontSideRenderer,back:this._backSideRenderer})}_invalidateSidesRenderer(){this._frontSideRenderer=this._getSideRenderer("front"),this._backSideRenderer=this._getSideRenderer("back")}_addSideRendererClassname(e,r){let o=U(r,{front:"front-side",back:"back-side"});e.addBemInfo(o)}_createImageSideRenderer(e,r){let o=Fr(`FlipCardSideRenderer-${this._cardData.key}-${e}-${r.type}`);if(kt.has(o)){let i=d(kt.get(o));return i.setSideData(r),i}let n=new Co({flipCardsBlockKey:this._flipCardsBlockKey,cardData:this._cardData,sideType:e,sideData:r,isLock:this._isLock,readonlyMode:this._readonlyMode,onHyperlinkOverFn:this._onHyperlinkOverFn,relatedData:o});return this._addSideRendererClassname(n,e),kt.set(o,n),this._readonlyMode||this._invalidateImageChangeDispatcher(n),n}_createTextSideRenderer(e,r){let o=Fr(`FlipCardSideRenderer-${this._cardData.key}-${e}-text`);if(kt.has(o)){let i=d(kt.get(o));return i.setSideData(r),i}let n=new Eo({flipCardsBlockKey:this._flipCardsBlockKey,cardData:this._cardData,sideType:e,sideData:r,readonlyMode:this._readonlyMode,isLock:this._isLock,onHyperlinkOverFn:this._onHyperlinkOverFn,relatedData:o});return this._addSideRendererClassname(n,e),kt.set(o,n),n}_createImageWithTextSideRenderer(e,r){let o=Fr(`FlipCardSideRenderer-${this._cardData.key}-${e}-${r.type}`);if(kt.has(o)){let i=d(kt.get(o));return i.setSideData(r),i}let n=new vo({flipCardsBlockKey:this._flipCardsBlockKey,cardData:this._cardData,sideType:e,sideData:r,readonlyMode:this._readonlyMode,isLock:this._isLock,onHyperlinkOverFn:this._onHyperlinkOverFn,relatedData:o});return this._addSideRendererClassname(n,e),kt.set(o,n),this._readonlyMode||this._invalidateImageChangeDispatcher(n),n}_getSideRenderer(e){let r=this._getCardSideData(e);return U(r.type,{image:()=>this._createImageSideRenderer(e,r),text:()=>this._createTextSideRenderer(e,r),imageWithText:()=>this._createImageWithTextSideRenderer(e,r)})()}_getCardSideData(e){return U(e,{front:this._cardData.frontSide,back:this._cardData.backSide})}_invalidateImageChangeDispatcher(e){this._addSignal(e.onUploadImageSignal(),this.onUploadImageSignal.toFn()),this._addSignal(e.onFileDialogOpenSignal(),this.onFileDialogOpenSignal.toFn()),this._addSignal(e.onCropImageSignal(),this.onCropImageSignal.toFn()),this._addSignal(e.onRemoveImageSignal(),this.onRemoveImageSignal.toFn())}_onCardClick(e){let r=e.target&&this._checkClickAtLink(e.target);!e.defaultPrevented&&!r&&this.onClickSignal.dispatch(this._cardData.key)}_checkClickAtLink(e){return d(e.parentElement).tagName===Nt.A}_onMouseEnter(){this.onMouseEnterSignal.dispatch(this._cardData.key)}_onMouseLeave(){this.onMouseLeaveSignal.dispatch(this._cardData.key)}_render(){let e=this._cardData;return D(Xy,`:flip-card-${e.key}`)`
<div
	class=${this._getCssClasses()}
	onclick=${this._onCardClick.bind(this)}
	onmouseenter=${this._onMouseEnter.bind(this)}
	onmouseleave=${this._onMouseLeave.bind(this)}
	data-card-key=${e.key}
>
	<div class='card-flip-container'>
		${this._frontSideRenderer.domElement()}
		${this._backSideRenderer.domElement()}
	</div>
</div>`}};var Rm={},Dm=180,jy=468,Zy=.93;var Jy=599;var e_={inner:{defaultScreen:{gap:24,horizontalPadding:0},smallScreen:{gap:20,horizontalPadding:0}},outer:{defaultScreen:{gap:24,horizontalPadding:56},smallScreen:{gap:20,horizontalPadding:20}},"full-width":{defaultScreen:{gap:24,horizontalPadding:56},smallScreen:{gap:20,horizontalPadding:20}}},ga=new WeakMap,ti=class extends O{constructor({block:e,readonlyMode:r,isLock:o,onHyperlinkOverFn:n}){super({blockName:"flip-cards-list"}),this._block=e,this._readonlyMode=r,this._isLock=o,this._onHyperlinkOverFn=n,this._activeSide="front",this._cardsRenderers=[],this._resizeObserver=new ResizeObserver(()=>this._invalidateCardsGrid()),this.onUploadCardImageSignal=this._createSignal(),this.onFileDialogOpenSignal=this._createSignal(),this.onPasteFromBufferCardImageSignal=this._createSignal(),this.onAddExternalCardImageSignal=this._createSignal(),this.onCropCardImageSignal=this._createSignal(),this.onRemoveCardImageSignal=this._createSignal(),this.onCardClickSignal=this._createSignal(),this.onCardMouseEnterSignal=this._createSignal(),this.onCardMouseLeaveSignal=this._createSignal(),this.onSelectBlockSignal=this._createSignal(),this._showAddingAnimation=!1,this._transitionStart=!1,this._placeholderRef={current:null},this._invalidateCardsRenderers(),this._invalidateModifiers()}setBlock(e){this._block!==e&&(this._block=e,this._invalidateCardsRenderers(),this._invalidateModifiers(),this._invalidateCardsGrid(),this._sheduleRender())}setLockMode(e){this._isLock!==e&&(this._isLock=e,this._cardsRenderers.forEach(r=>r.setLockMode(e)))}getCardRendererByKey(e){return this._cardsRenderers.find(r=>r.key()===e)||null}setCardsActiveSide(e){this._activeSide=e,this._cardsRenderers.forEach(r=>r.setActiveSide(e))}setAddingAnimationShow(e){this._showAddingAnimation!==e&&(this._showAddingAnimation=e,this._invalidatePlaceholder(),this._invalidateCardsGrid())}_invalidateModifiers(){this.updateModifier("align",this._block.cardsLayout)}_invalidatePlaceholder(){let e=this._placeholderRef.current;!e||(this._showAddingAnimation?this._showPlaceholderWithAnimation(e):this._playHideAddingAnimation(e))}_playShowAddingAnimation(e){Ce(()=>{e.style.setProperty("transform","scale(1)")})}_invalidatePlaceholderVisibility(){Ce(()=>{this._transitionStart||this._hidePlaceholder()})}_playHideAddingAnimation(e){getComputedStyle(e).display==="block"&&Ce(()=>{e.style.setProperty("transform","scale(0)"),this._invalidatePlaceholderVisibility()})}_invalidateCardsRenderers(){let e=[];je(this._block.cardsBlockMap,r=>{let o=this._createFlipCard(r);e.push(o)}),this._cardsRenderers=e}_createFlipCard(e){let r=e.key,o=Fr(`FlipCardRenderer${r}`);if(ga.has(o)){let i=d(ga.get(o));return i.setCardData(e),i}let n=new ei({flipCardsBlockKey:this._block.key,cardData:e,onHyperlinkOverFn:this._onHyperlinkOverFn,readonlyMode:this._readonlyMode,isLock:this._isLock,relatedData:o});return n.setActiveSide(this._activeSide),ga.set(o,n),this._invalidateMouseEventDispatcher(n),this._readonlyMode||this._invalidateImageChangedDispatcher(n),n}_getGridParams(e){let{defaultScreen:r,smallScreen:o}=e_[this._block.cardsLayout];return e>Jy?r:o}_invalidateCardsGrid(){let e=M.getFlipCardsCount(this._block);this._showAddingAnimation&&(e+=1);let r=Math.min(this._block.maxCardsInRow,e),o=this.domElement(),n=o.querySelector(".flip-cards-container"),{gap:i,horizontalPadding:s}=this._getGridParams(o.offsetWidth),a=s*2,c=Math.floor((o.offsetWidth+i-a)/(Dm+i)),l=Math.min(r,c);Ce(()=>{n.style.setProperty("grid-template-columns",`repeat(${l}, minmax(${Dm}px, ${jy}px))`),n.style.setProperty("gap",`${i}px`),o.style.setProperty("padding",`0 ${s}px`)})}_invalidateMouseEventDispatcher(e){this._addSignal(e.onClickSignal,this.onCardClickSignal.toFn()),this._addSignal(e.onMouseEnterSignal,this.onCardMouseEnterSignal.toFn()),this._addSignal(e.onMouseLeaveSignal,this.onCardMouseLeaveSignal.toFn())}_invalidateImageChangedDispatcher(e){this._addSignal(e.onUploadImageSignal,this.onUploadCardImageSignal.toFn()),this._addSignal(e.onFileDialogOpenSignal,this.onFileDialogOpenSignal.toFn()),this._addSignal(e.onCropImageSignal,this.onCropCardImageSignal.toFn()),this._addSignal(e.onRemoveImageSignal,this.onRemoveCardImageSignal.toFn())}_onConnected(){this._resizeObserver.observe(this.domElement())}_onDisconnected(){this._resizeObserver.unobserve(this.domElement()),this._showAddingAnimation=!1,this._hidePlaceholder()}_invalidatePlaceholderColor(){let e=this._placeholderRef.current;if(!e)return;let r=o=>{let n=Br(),i=U(o,{dark:n.borderDefault,light:n.borderOncolorDefault});yt(e,"--placeholder-color",i)};Lr({background:go(this._block.background),lightnessLimitValue:Zy,setStyle:r})}_showPlaceholderWithAnimation(e){this._invalidatePlaceholderColor(),e.style.setProperty("display","block"),this._playShowAddingAnimation(e)}_hidePlaceholder(){let e=this._placeholderRef.current;!e||e.style.setProperty("display","none")}_onPlaceholderTransitionEnd(){this._transitionStart=!1,this._showAddingAnimation||this._hidePlaceholder()}_onMousedown(e){e.target===this.domElement()&&(e.preventDefault(),this.onSelectBlockSignal.dispatch())}_onCardsContainerMousedown(e){let r=this.domElement().querySelector(".flip-cards-container");e.target===r&&(e.preventDefault(),this.onSelectBlockSignal.dispatch())}_renderNewCardPlaceholder(){return D(Rm,`:new-card-placeholder-${this._block.key}`)`
<div
	class="new-card-placeholder"
	style="display: none"
	save-ref=${this._placeholderRef}
	ontransitionstart=${()=>{this._transitionStart=!0}}
	ontransitionend=${this._onPlaceholderTransitionEnd.bind(this)}
></div>`}_render(){let e=this._block;return D(Rm,`:flip-cards-list-${e.key}`)`
			<div
				class=${this._getCssClasses()}
				onconnected=${this._onConnected.bind(this)}
				ondisconnected=${this._onDisconnected.bind(this)}
				onmousedown=${this._onMousedown.bind(this)}
			>
				<div
					class="flip-cards-container"
					onmousedown=${this._onCardsContainerMousedown.bind(this)}
				>
					${this._cardsRenderers.map(r=>r.domElement())}
					${this._renderNewCardPlaceholder()}
				</div>
			</div>`}};var ri=class extends O{constructor({block:e,onHyperlinkOverFn:r,readonlyMode:o,isLock:n}){super({blockName:"flip-cards-block"}),this._block=e,this._readonlyMode=o,this._cardsListRenderer=new ti({block:e,onHyperlinkOverFn:r,readonlyMode:o,isLock:n}),this.cardsCountChangedSignal=this._createSignal(),this.cardsLayoutChangedSignal=this._createSignal(),this.maxCardsInRowChangedSignal=this._createSignal()}setBlock(e){this._block!==e&&(Bt(e.cardsBlockMap)!==Bt(this._block.cardsBlockMap)&&this.cardsCountChangedSignal.dispatch(),e.cardsLayout!==this._block.cardsLayout&&this.cardsLayoutChangedSignal.dispatch(),e.maxCardsInRow!==this._block.maxCardsInRow&&this.maxCardsInRowChangedSignal.dispatch(),this._block=e,this._cardsListRenderer.setBlock(e),this._sheduleRender())}_getCssStyles(){let r=this._block.background,o={};if(r&&r.type==="color"&&r.color!==Ee){let n=ie(r.color),i=r.opacity;o={"background-color":`rgba(${n[0]}, ${n[1]}, ${n[2]}, ${i})`}}return o}};immer.enableAllPlugins();var Qr=immer.produce,II=immer.applyPatches;!1&&immer.setAutoFreeze(!0);function Im(t){return t`
<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2 6a1 1 0 0 1 1-1h14a1 1 0 1 1 0 2H3a1 1 0 0 1-1-1zm0 4a1 1 0 0 1 1-1h14a1 1 0 1 1 0 2H3a1 1 0 0 1-1-1zm1 3a1 1 0 1 0 0 2h14a1 1 0 1 0 0-2H3z" fill="currentColor"/></svg>
`}function ya(t,e){let r=ke(e);J(()=>{let o=t instanceof Element?t:t&&t.current;if(!o)return;let n=new ResizeObserver(([i])=>{r.current&&r.current(i.contentRect)});return n.observe(o),()=>{n.disconnect()}},[t,r])}var t_={container:"x6e61f__container"};function Mm(t,e){return t`
<div class=${t_.container}>
	${t(Vn,e)}
</div>`}var lt=(t,e,r)=>Xe(t,e,o=>{try{r(o)===!0&&o.preventDefault(),Zl()||Ks()}catch(n){h.error(n)}});var Vt={WIN_KEY_FF_LINUX:0,MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PLUS_SIGN:43,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,FF_SEMICOLON:59,FF_EQUALS:61,FF_DASH:173,QUESTION_MARK:63,AT_SIGN:64,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLL_LOCK:145,FIRST_MEDIA_KEY:166,LAST_MEDIA_KEY:183,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,TILDE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,MAC_WK_CMD_LEFT:91,MAC_WK_CMD_RIGHT:93,WIN_IME:229,VK_NONAME:252,PHANTOM:255};function Yr(t,e,r,o,n=!1){let i=o||{};de(t,"keydown",n?null:s=>{s.defaultPrevented||s.keyCode===e&&(i.ctrl===void 0||s.ctrlKey===i.ctrl)&&(i.shift===void 0||s.shiftKey===i.shift)&&(i.metaKey===void 0||s.metaKey===i.metaKey)&&(s.preventDefault(),r(s))})}function r_(){let t=!1;try{t=!!window.Animation}catch(e){}return t}function _a({element:t,createKeyframes:e,abortSignal:r}){if(!r_())return Promise.resolve();let o=new Animation(e(t));return new Promise(n=>{let i=t.style.pointerEvents;t.style.pointerEvents="none";function s(){c(),n()}function a(){c(),n("aborted")}function c(){t.style.pointerEvents=i,r&&r.removeEventListener("abort",a),o.removeEventListener("cancel",a),o.removeEventListener("finish",s)}r&&r.addEventListener("abort",a),o.addEventListener("cancel",a),o.addEventListener("finish",s),o.play()})}function oi({element:t,getAppearKeyframes:e,getHideKeyframes:r,onAppeared:o,onHidden:n}){let[i,s]=Q(!1),a=An(),c=B(new AbortController),l=B(t),m=B(null);t!==l.current&&(m.current=l.current),l.current=t;let u=ke({getAppearKeyframes:e,getHideKeyframes:r,onAppeared:o||(()=>{}),onHidden:n||(()=>{})});return J(()=>{if(!t)return;c.current.abort(),c.current=new AbortController;let g=c.current.signal,b=u.current.getAppearKeyframes,N=u.current.getHideKeyframes;return b?(s(!0),_a({element:t,createKeyframes:b,abortSignal:g}).then(()=>{s(!1),u.current.onAppeared()})):u.current.onAppeared(),()=>{if(!N||g.aborted){m.current=null,a(),u.current.onHidden();return}s(!0),_a({element:t,createKeyframes:N,abortSignal:g}).then(()=>{m.current=null,s(!1),u.current.onHidden()})}},[u,t,a]),{animating:i,element:m.current||t}}function ni({layer:t,element:e,onAppend:r,beforeAppend:o,beforeUnmount:n}){let i=B(null),s=br(t),a=ke(n),c=Z(()=>{let l=i.current;l&&(d(l.parentElement==s,`useExternalLayer(): layer "${t}" doesn't contain element`),a.current&&a.current(),s.removeChild(l),i.current=null)},[s,t,a]);J(()=>c,[c]),e!=i.current&&(c(),e&&(o&&o(e),e.style.position="absolute",s.appendChild(e),r&&r(e)),i.current=e)}var o_={};function Am(t){return o_[t.key]}var qr={getBlockByIndex(t,e){return vr(t,e)},getFirstBlock(t){return d(Kc(t))},getLastBlock(t){return d(Hc(t))},getBlockBefore(t,e){return Vc(t,e)},getBlockAfter(t,e){return Wc(t,e)},forEach(t,e){Uc(t,e)},getBlocksArray(t){return t.order.map(e=>t.blocks[e])},hasBlock(t,e){return t.blocks.hasOwnProperty(e)}};var Om={create(t){return{...E.create({key:t.key,characters:t.characters,viewType:t.viewType,textAlign:t.textAlign,isOrderedListFirstItem:t.isOrderedListFirstItem}),flipCardsBlockKey:t.flipCardsBlockKey,cardKey:t.cardKey,cardSide:t.cardSide,meta:t.meta||[]}},toFlipCardParagraph(t){if(t&&t.type===f.PARAGRAPH){let e=t;if(e.flipCardsBlockKey&&e.cardKey&&e.cardSide&&e.meta)return t}return null}};var G={createBlocks(t){let e={order:[],blocks:{}};for(let r of t)e.order.push(r.key),e.blocks[r.key]=r;return e},cloneBlock(t){let e=ye.toCollageBlock(t);if(e)return ye.clone(e);let r=p.toTableBlock(t);if(r)return p.cloneTable(r);let o=M.toFlipCardsBlock(t);return o?M.clone(o):{...t,key:v()}},replaceBlocksFragment(t,e,r,o=[]){let n=t.order.indexOf(e),i=t.order.indexOf(r);if(n<0||i<0){h.warn("incorrect block keys");return}let s=[...t.order],a=s.splice(n,i-n+1);for(let l of a)delete t.blocks[l];let c=[];for(let l of o)c.push(l.key),t.blocks[l.key]=l;s.splice(n,0,...c),t.order.splice(0,t.order.length,...s)},replaceBlockWithFragment(t,e,r){return G.replaceBlocksFragment(t,e,e,r)},updateBlockWithKey(t,e,r){let o=t.blockMap.blocks[e];!o||_c(o,r)},updateCollageBlockWithKey(t,e,r){let o=ye.toCollageBlock(t.blockMap.blocks[e]);if(o){let n=ye.getCollagedImage(o,r.key);if(!n)return;for(let i of Object.keys(r))n[i]=r[i]}},removeBlocks(t,e){for(let r of e)G.replaceBlockWithFragment(t.blockMap,r)},create(t=[E.create()]){return{blockMap:G.createBlocks(t)}},createFromBlockMap(t){return t},getDefaultSelection(t){let e=t.blockMap.order[0],r=t.blockMap.blocks[e],o=null;return ze.toMediaBlock(r)&&(o=Wr.create(!1)),_.create({startKey:r.key,startOffset:0,endKey:r.key,endOffset:0,customSelection:o})},getAllBlocksFromSelection(t,e){let{startKey:r,endKey:o}=e,{order:n,blocks:i}=t.blockMap,s=n.indexOf(r),a=n.indexOf(o);return s<0||a<0?(h.warn("incorrect selection"),[]):n.slice(s,a+1).map(c=>i[c])},getAllTableCellsCharactersBlocks(t){let e=[];return t.rowsOrder.forEach(r=>{t.colsOrder.forEach(o=>{let n=p.getCell(t,r,o),i=n&&K(n.content);i&&e.push({paragraph:i,location:{tableKey:t.key,colKey:o,rowKey:r,cellKey:n.key},meta:n.meta})})}),e},getAllFlipCardsCharactersBlocks(t,e){let r=[];return t.cardsBlockMap.order.forEach(o=>{let n=M.getFlipCardSideData(t,o,e);n.type!=="image"&&r.push({paragraph:n.text,location:{flipCardsBlockKey:t.key,cardKey:o,cardSide:e},meta:n.meta})}),r},getTableRowCellsCharactersBlocks(t,e){let r=[];return t.colsOrder.forEach(o=>{let n=p.getCell(t,e,o),i=n&&K(n.content);i&&r.push({paragraph:i,location:{tableKey:t.key,colKey:o,rowKey:e,cellKey:n.key},meta:n.meta})}),r},getTableColumnCellsCharactersBlocks(t,e){let r=[];return t.rowsOrder.forEach(o=>{let n=p.getCell(t,o,e),i=n&&K(n.content);i&&r.push({paragraph:i,location:{tableKey:t.key,colKey:e,rowKey:o,cellKey:n.key},meta:n.meta})}),r},getSelectedTableCharactersBlocks(t,e){if(se.isCellSelected(e)){let r=e.customSelection,o=p.getCell(t,r.rowKey,r.colKey);return[{paragraph:d(K(o.content)),location:{tableKey:t.key,colKey:r.colKey,rowKey:r.rowKey,cellKey:o.key},meta:o.meta}]}if(se.isRowSelected(e)){let{rowKey:r}=e.customSelection;return G.getTableRowCellsCharactersBlocks(t,r)}if(se.isColumnSelected(e)){let{colKey:r}=e.customSelection;return G.getTableColumnCellsCharactersBlocks(t,r)}return G.getAllTableCellsCharactersBlocks(t)},getSelectedFlipCardsParagraphBlocks(t,e){if(nt.isCardTextSelection(e)){let o=e.customSelection,n=M.getFlipCardSideData(t,o.cardKey,o.cardSide);if(n.type!=="image")return[{paragraph:n.text,location:{flipCardsBlockKey:t.key,cardKey:o.cardKey,cardSide:o.cardSide},meta:n.meta}]}let r=Am(t);if(r){let o=r.activeSide();return G.getAllFlipCardsCharactersBlocks(t,o)}return[]},getCharactersBlockFromSelection(t,e){let r=G.getAllBlocksFromSelection(t,e).filter(n=>!!et(n,e)||!!ye.toCollageBlock(n)||!!p.toTableBlock(n)||!!M.toFlipCardsBlock(n)),o=[];for(let n=0;n<r.length;n++){let i=ye.toCollageBlock(r[n]);if(i&&ha({contentState:t,selection:e})){let l,m=e.customSelection.collageSelectedItemKey,u=ye.getCollagedImage(i,m);u&&(l=et(u)),o.push(l||r[n]);continue}if(i&&!ha({contentState:t,selection:e})){i.images.forEach(l=>{let m=d(et(l));o.push(m)});continue}let s=Je.toNoteBlock(r[n]);if(s){let l=d(et(s));o.push(l);continue}let a=p.toTableBlock(r[n]);if(a){let m=this.getSelectedTableCharactersBlocks(a,e).map(u=>Yn.create({...u.paragraph,...u.location,meta:u.meta}));o.push(...m);continue}let c=M.toFlipCardsBlock(r[n]);if(c){let m=this.getSelectedFlipCardsParagraphBlocks(c,e).map(u=>Om.create({...u.paragraph,...u.location,meta:u.meta}));o.push(...m);continue}o.push(r[n])}return o},getMediaBlocksFromSelection(t,e){return G.getAllBlocksFromSelection(t,e).filter(r=>!!ze.toMediaBlock(r))},getCollageBlocksFromSelection(t,e){return G.getAllBlocksFromSelection(t,e).filter(r=>!!ye.toCollageBlock(r))},getTableBlockFromSelection(t,e){return G.getAllBlocksFromSelection(t,e).filter(r=>!!p.toTableBlock(r))},getAttachmentBlocksFromSelection(t,e){return G.getAllBlocksFromSelection(t,e).filter(r=>!!dr.toAttachmentBlock(r))},getNoteBlocksFromSelection(t,e){return G.getAllBlocksFromSelection(t,e).filter(r=>!!Je.toNoteBlock(r))},getTableBlocksFromSelection(t,e){return G.getAllBlocksFromSelection(t,e).filter(r=>!!p.toTableBlock(r))},getFlipCardsBlocksFromSelection(t,e){return G.getAllBlocksFromSelection(t,e).filter(r=>!!M.toFlipCardsBlock(r))},getParagraphsFromSelection(t,e){let r=G.getAllBlocksFromSelection(t,e),o=[];return r.forEach(n=>{let i=K(n);if(i){o.push(i);return}let s=p.toTableBlock(n);if(s){let c=this.getSelectedTableCharactersBlocks(s,e).map(l=>l.paragraph);o.push(...c)}let a=M.toFlipCardsBlock(n);if(a){let c=this.getSelectedFlipCardsParagraphBlocks(a,e).map(l=>l.paragraph);o.push(...c)}}),o},getConvertableBlocksFromSelection(t,e){return G.getAllBlocksFromSelection(t,e).filter(r=>!!Je.toNoteBlock(r)||K(r))},getBlockBefore(t,e){let{order:r,blocks:o}=t.blockMap,n=r.indexOf(e);if(n<0)return h.warn("incorrect key"),null;if(n==0)return null;let i=r[n-1];return o[i]},getBlockAfter(t,e){let r=t.blockMap.order,o=t.blockMap.blocks,n=r.indexOf(e);if(n<0)return h.warn("incorrect key"),null;if(n==r.length-1)return null;let i=r[n+1];return o[i]},getExercisesFromSelection(t,e){return G.getAllBlocksFromSelection(t,e).filter(n=>!!St.toExerciseBlock(n))},atLeastOneNotEmptyCharactersBlockSelected(t,e){return G.getCharactersBlockFromSelection(t,e).some(r=>r.characters.length>0)},isOneNoteBlockSelected(t,e){return G.getNoteBlocksFromSelection(t,e).length===1},convertBrowserToModelSelection(t,e){let r=t.blockMap.blocks,o=et(r[e.startKey]),n=o?E.convertBrowserToModelOffset(o,e.startOffset):e.startOffset,i=et(t.blockMap.blocks[e.endKey]),s=i?E.convertBrowserToModelOffset(i,e.endOffset):e.endOffset;return{...e,startOffset:n,endOffset:s}},convertModelToBrowserSelection(t,e){let r=et(t.blockMap.blocks[e.startKey],e),o=r?E.convertModelToBrowserOffset(r,e.startOffset):e.startOffset,n=et(t.blockMap.blocks[e.endKey],e),i=n?E.convertModelToBrowserOffset(n,e.endOffset):e.endOffset;return{...e,startOffset:o,endOffset:i}},isValidSelection(t,e){return[e.startKey,e.endKey].every(r=>qr.hasBlock(t.blockMap,r))}};var Fm={create({type:t,width:e,height:r,src:o,crop:n,title:i,previewSrc:s}){let a={type:t,width:e,height:r,src:o};return n&&(a={...a,crop:n}),i&&(a={...a,title:i}),s&&(a={...a,previewSrc:s}),a}};function ii(t){let e=[];for(let r of t)e.push({text:r,meta:z.create()});return e}function si(t){let e=K(Rt(t.blockMap));return e?E.getParagraphText(e):(h.error("first block is not text pararaph"),"")}var Xr={create(t={}){let{key:e=v(),correct:r=!1,text:o=[]}=t;return{key:e,correct:r,content:G.create([E.create({characters:o})])}},getChoiceText(t){return d(si(t.content))}};var ai={create(t={}){let{choices:e=[Xr.create({correct:!0,text:ii(`${x("Roll.Exercise.Question.Content.PossibleAnswer")} 1`)}),Xr.create({text:ii(`${x("Roll.Exercise.Question.Content.PossibleAnswer")} 2`)}),Xr.create({text:ii(`${x("Roll.Exercise.Question.Content.PossibleAnswer")} 3`)})]}=t;return{choices:e}}};var ci={create(t={}){let{key:e=v(),text:r=""}=t;return{key:e,text:r}}};var li={create(t={}){let{caseSensitive:e=!1,answers:r=[ci.create({text:`${x("Roll.Exercise.TypeIn.Answer")} 1`})]}=t;return{caseSensitive:e,answers:r}}};var Ca={ANSWERED:"answered",CORRECT_INCORRECT:"correctIncorrect"};var Wt={create(t={}){let{type:e=Ca.CORRECT_INCORRECT,answered:r=[],correct:o=[],incorrect:n=[]}=t;return{type:e,answered:G.create([E.create({characters:r})]),correct:G.create([E.create({characters:o})]),incorrect:G.create([E.create({characters:n})])}},getFeedbackText(t,e){let r=t.type==Ca.ANSWERED?t.answered:e?t.correct:t.incorrect,o=K(Rt(r.blockMap));return d(o)}};function n_(t){switch(t){case"mc":case"mr":return ai.create();case"ti":return li.create();default:throw F(t),new Error(`Unknown question type: ${t}`)}}var di={create(t){let{key:e=v(),type:r,attachment:o=null,description:n="",content:i=n_(t.type),feedback:s=Wt.create()}=t;return{key:e,type:r,attachment:o,description:G.create([E.create({characters:n})]),content:i,feedback:s}},getDescriptionText(t){return si(t.description)}};var mi={create(t={}){let{includeInProgress:e=!1,shuffleAnswers:r=!1,showCorrectAnswers:o=!0}=t;return{includeInProgress:e,shuffleAnswers:r,showCorrectAnswers:o}}};var St={create(t={}){let{key:e=v(),settings:r=mi.create(),questions:o=[di.create({type:"mc"})]}=t;return{key:e,type:f.EXERCISE,settings:r,questions:o}},toExerciseBlock(t){return t&&t.type===f.EXERCISE?t:null},getBlockType(t){return"exercise"}};function i_(t){switch(t){case 4:return pl;case 5:return hl;case 6:return yl;case 7:return Cl;case 8:return Sl;case 9:return kn;case 10:return bl;case 11:return Dl;case 12:return wn;case 13:return Ml;default:throw Error(`cannot decode json document with version ${t}`)}}function Pm(t,e){let r=i_(e),o=tr(t,r,[]);return Wo(o,cl)}var Nm=protobuf.Type,Bo=protobuf.Field,s_=protobuf.Root;var ui={string:"string",int:"int32",float:"float",bool:"bool"},a_=0,Be={String:t=>T(t,ui.string),Int:t=>T(t,ui.int),Bool:t=>T(t,ui.bool),Float:t=>T(t,ui.float)},c_=new s_;function S(t,e){e=e||`Type${++a_}`;let r=new Nm(e);for(let o of Object.keys(t)){let n=t[o],i=n.ref;if(typeof i=="string")r=r.add(new Bo(o,n.id,i,n.rule));else if(i instanceof Nm){let s=i;r=r.add(new Bo(o,n.id,s.name,n.rule))}else{let s=S(i);r=r.add(new Bo(o,n.id,s.name,n.rule))}}return c_.add(r),r}function T(t,e,r="required"){return{id:t,ref:e,rule:r}}function P(t,e){return typeof e=="function"&&(e=e(t).ref),T(t,e,"repeated")}function V(t,e){return typeof e=="function"&&(e=e(t).ref),T(t,e,"optional")}function Ne(t){let e="type",r=S({}),o=S({}).add(new Bo(e,0,"string","required"));for(let n of Object.keys(t))t[n]=t[n].add(new Bo(e,0,"string","required"));return r.fromObject=function(n){return t[n[e]].fromObject(n)},r.toObject=function(n){return t[n[e]].toObject(n)},r.encode=function(n,i){return t[n[e]].encode(n,i)},r.decode=function(n,...i){if(n instanceof protobuf.Reader){let s=n.pos,a=o.decode(n,...i),c=t[a[e]];return n.pos=s,c.decode(n,...i)}throw new Error("top level union is not supported")},r.verify=function(n){let i=t[n[e]];return i?i.verify(n):`unknown type ${n[e]}`},r}var dt={ACCENT_COLOR:"ACCENT_COLOR",PLAYER_MAIN_FONT:"PLAYER_MAIN_FONT",CONTENT_FONT:"CONTENT_FONT"};var{String:Ke,Int:Ut,Bool:Ro}=Be,l_=S({start:Ut(1),end:Ut(2),style:Ke(3)}),d_=S({start:Ut(1),end:Ut(2),url:Ke(3)}),mr=S({text:Ke(1),inlineStyleRanges:P(2,l_),urls:P(3,d_)}),m_=S({src:Ke(1),width:Ut(2),height:Ut(3)}),u_=S({src:Ke(1),width:Ut(2),height:Ut(3)}),ka=Ne({i:u_,e:m_}),Lm=S({key:Ke(1),text:T(2,mr),correct:Ro(3)}),p_=S({choices:P(1,Lm)}),f_=S({choices:P(1,Lm)}),h_=S({key:Ke(1),text:Ke(2)}),g_=S({caseSensitive:Ro(1),answers:P(2,h_)}),Sa=S({type:Ke(1),correct:T(2,mr),incorrect:T(3,mr),answered:T(4,mr)}),y_=S({includeInProgress:Ro(1),shuffleAnswers:Ro(2),showCorrectAnswers:Ro(3)}),__=S({key:Ke(1),description:T(2,mr),attachment:V(3,ka),content:T(4,p_),feedback:T(5,Sa)}),C_=S({key:Ke(1),description:T(2,mr),attachment:V(3,ka),content:T(4,f_),feedback:T(5,Sa)}),k_=S({key:Ke(1),description:T(2,mr),attachment:V(3,ka),content:T(4,g_),feedback:T(5,Sa)}),S_=Ne({mc:__,mr:C_,ti:k_}),$m=S({key:Ke(1),settings:T(2,y_),questions:P(3,S_)});var{String:ue,Int:mt,Float:x_}=Be,ur=S({start:mt(1),end:mt(2),url:ue(3)}),xa=S({start:mt(1),end:mt(2),style:ue(3)}),b_=S({key:ue(1),text:ue(2),viewType:ue(3),inlineStyleRanges:P(4,xa),urls:P(5,ur)}),w_=S({key:ue(1),src:ue(2),width:mt(3),height:mt(4),alignment:ue(5),text:ue(6),inlineStyleRanges:P(7,xa),urls:P(8,ur)}),T_=S({key:ue(1),src:ue(2),width:mt(3),height:mt(4),alignment:ue(5),text:ue(6),inlineStyleRanges:P(7,xa),urls:P(8,ur)}),Km=Ne({[f.PARAGRAPH]:b_,[f.IMAGE]:w_,[f.EMBED]:T_,[f.EXERCISE]:$m}),Hm=S({intro:T(1,{kicker:ue(1),title:ue(2),coverSrc:V(3,ue),coverWidth:V(4,mt),coverHeight:V(5,mt),blocks:P(6,Km),coverColor:V(7,ue),coverOpacity:V(8,x_)}),chapters:P(2,{key:ue(1),title:ue(2),blocks:P(3,Km)})});var{String:pr,Bool:pi}=Be,v_=S({content:T(1,Hm),publishSettings:T(2,{navigationType:pr(1),searchEnabled:pi(2),numberingEnabled:pi(3),nextButtonEnabled:pi(4),copyingEnabled:V(6,pi),fonts:T(5,{[Ze.TOOLTIP]:pr(1),[Ze.PLAYER_MAIN]:pr(2),[Ze.CONTENT]:pr(3)})}),cssReplacements:T(3,{[dt.ACCENT_COLOR]:pr(1),[dt.CONTENT_FONT]:pr(2),[dt.PLAYER_MAIN_FONT]:pr(3)})}),fi=new Mt(v_);var Vm=fi;var{String:Le,Int:xt,Bool:Do,Float:E_}=Be,B_=S({start:xt(1),end:xt(2),style:T(3,{name:Le(1),size:V(2,xt),color:V(3,Le),opacity:V(4,E_)})}),R_=S({start:xt(1),end:xt(2),url:Le(3)}),fr=S({text:Le(1),inlineStyleRanges:P(2,B_),urls:P(3,R_)}),D_=S({src:Le(1),width:xt(2),height:xt(3)}),I_=S({src:Le(1),width:xt(2),height:xt(3)}),ba=Ne({i:I_,e:D_}),Wm=S({key:Le(1),text:T(2,fr),correct:Do(3)}),M_=S({choices:P(1,Wm)}),A_=S({choices:P(1,Wm)}),O_=S({key:Le(1),text:Le(2)}),F_=S({caseSensitive:Do(1),answers:P(2,O_)}),wa=S({type:Le(1),correct:T(2,fr),incorrect:T(3,fr),answered:T(4,fr)}),P_=S({includeInProgress:Do(1),shuffleAnswers:Do(2),showCorrectAnswers:Do(3)}),N_=S({key:Le(1),description:T(2,fr),attachment:V(3,ba),content:T(4,M_),feedback:T(5,wa)}),L_=S({key:Le(1),description:T(2,fr),attachment:V(3,ba),content:T(4,A_),feedback:T(5,wa)}),$_=S({key:Le(1),description:T(2,fr),attachment:V(3,ba),content:T(4,F_),feedback:T(5,wa)}),K_=Ne({mc:N_,mr:L_,ti:$_}),Um=S({key:Le(1),settings:T(2,P_),questions:P(3,K_)});var{String:te,Int:ut,Float:Gm,Bool:H_}=Be,Ta=S({start:ut(1),end:ut(2),style:T(3,{name:te(1),size:V(2,ut),color:V(3,te),opacity:V(4,Gm)})}),V_=S({key:te(1),text:te(2),viewType:te(3),inlineStyleRanges:P(4,Ta),urls:P(5,ur),textAlign:V(6,te),isOrderedListFirstItem:V(7,H_)}),W_=S({key:te(1),src:te(2),width:ut(3),height:ut(4),alignment:te(5),text:te(6),inlineStyleRanges:P(7,Ta),urls:P(8,ur)}),U_=S({key:te(1),src:te(2),width:ut(3),height:ut(4),alignment:te(5),text:te(6),inlineStyleRanges:P(7,Ta),urls:P(8,ur)}),z_=S({key:te(1),fileName:te(2),fileExtension:te(3),fileSize:ut(4)}),zm=Ne({[f.PARAGRAPH]:V_,[f.IMAGE]:W_,[f.EMBED]:U_,[f.EXERCISE]:Um,[f.ATTACHMENT]:z_}),Qm=S({intro:T(1,{kicker:te(1),title:te(2),coverSrc:V(3,te),coverWidth:V(4,ut),coverHeight:V(5,ut),blocks:P(6,zm),coverColor:V(7,te),coverOpacity:V(8,Gm)}),chapters:P(2,{key:te(1),title:te(2),blocks:P(3,zm)})});var{String:hr,Bool:hi}=Be,G_=S({content:T(1,Qm),publishSettings:T(2,{navigationType:hr(1),searchEnabled:hi(2),numberingEnabled:hi(3),nextButtonEnabled:hi(4),copyingEnabled:V(6,hi),fonts:T(5,{[Ze.TOOLTIP]:hr(1),[Ze.PLAYER_MAIN]:hr(2),[Ze.CONTENT]:hr(3)})}),cssReplacements:T(3,{[dt.ACCENT_COLOR]:hr(1),[dt.CONTENT_FONT]:hr(2),[dt.PLAYER_MAIN_FONT]:hr(3)})}),Ym=new Mt(G_);var gi=class{constructor({initialVersion:e,upgraders:r,fixers:o=[]}){this._initialVersion=e,this._upgraders=new Map,r.forEach((n,i)=>{this._validateUpgrader(e,n,i),this._upgraders.set(n.targetVersion,n.upgradeFn)}),this._fixers=new Map,o.forEach(n=>this._fixers.set(n.targetVersion,n.fixFn))}upgradeDocument(e,r){let o=!1;if(r.from==r.to){let i=this._fixDocument(e,r.to);return{upgradedDocument:i.document,isDocumentFixed:i.fixed}}if(r.from<this._initialVersion||r.to>this._initialVersion+this._upgraders.size)throw new Error;let n=this._fixDocument(e,r.from);e=n.document,o=n.fixed;for(let i=r.from+1;i<=r.to;++i)e=d(this._upgraders.get(i))(e),n=this._fixDocument(e,i),e=n.document,o=o||n.fixed;return{upgradedDocument:e,isDocumentFixed:o}}_fixDocument(e,r){let o=this._fixers.get(r),n={document:e,fixed:!1};return o&&(n=o(e)),{document:n.document,fixed:n.fixed}}_validateUpgrader(e,{targetVersion:r},o){if(e!=r-o-1)throw new Error}};var qm="data-1.bin",Xm="data-1.json";function jm(t){return t}function Q_(t){return{...t,verticalTextAlign:"top"}}function Y_(t){for(let e of t.rowsOrder)for(let r of t.colsOrder){let o=p.getCell(t,e,r);t.rowsMap[e].colsMap[r]=Q_(o)}}function Zm(t){return t.type==="image"?t:{...t,meta:[]}}function q_(t){t.frontSide=Zm(t.frontSide),t.backSide=Zm(t.backSide)}function X_(t){je(t.cardsBlockMap,q_)}function Jm(t){let e=t.blocks;for(let r of Object.keys(e)){let o=e[r];o.type===f.TABLE&&Y_(o),o.type===f.FLIP_CARD&&X_(o)}}function eu(t){return Qr(t,e=>{Jm(e.intro.contentState.blockMap);for(let r of Object.values(e.chapters.blocks))r&&Jm(r.contentState.blockMap)})}function tu({content:t,settings:e}){return{content:eu(t),settings:e}}function ru(t){return{...t,advanced:{direction:"ltr"}}}function ou({content:t,settings:e}){return{content:t,settings:ru(e)}}function nu(t){return t.publishSettings.copyingEnabled=!0,t}function zt(t){t.inlineStyleRanges&&t.inlineStyleRanges.forEach(e=>{e.style={name:e.style}}),t.urls&&t.urls.forEach(e=>{let r={start:e.start,end:e.end,style:{name:"underline"}};t.inlineStyleRanges?t.inlineStyleRanges.push(r):t.inlineStyleRanges=[r]})}function j_(t){zt(t),t.textAlign=t.viewType==="pullquote"?"center":"left"}function va(t){let e=null;t.forEach(r=>{if(r.type===f.PARAGRAPH){j_(r);let o=r;o.viewType==="ol"&&(!e||e!=="ol")&&(o.isOrderedListFirstItem=!0),e=o.viewType}else if(r.type===f.IMAGE)zt(r),e=null;else if(r.type===f.EMBED)zt(r),e=null;else if(r.type===f.EXERCISE){let o=r;o.questions&&o.questions.forEach(n=>{zt(n.description),(n.type==="mc"||n.type==="mr")&&n.content.choices&&n.content.choices.forEach(i=>zt(i.text)),zt(n.feedback.answered),zt(n.feedback.correct),zt(n.feedback.incorrect)}),e=null}else e=null})}function iu(t){return va(t.content.intro.blocks),t.content.chapters&&t.content.chapters.forEach(e=>{va(e.blocks)}),t}function jr({text:t,inlineStyleRanges:e,urls:r}){let o=z.create(),n=[...t].map(i=>({text:i,meta:o}));return e&&e.forEach(i=>{for(let s=i.start;s<i.end;++s){if(s>=n.length){h.warn("incorrect style ranges");break}n[s].meta=z.applyStyle(n[s].meta,i.style)}}),r&&r.forEach(i=>{for(let s=i.start;s<i.end;++s){if(s>=n.length){h.warn("incorrect url ranges");break}n[s].meta=z.setUrl(n[s].meta,i.url)}}),n}function su(t,e=!1){let r=t.questions,o=r?J_(r,e):[];return St.create({key:e?v():t.key,settings:Z_(t.settings),questions:o})}function Z_(t){return mi.create({includeInProgress:t.includeInProgress,showCorrectAnswers:t.showCorrectAnswers,shuffleAnswers:t.shuffleAnswers})}function J_(t,e){return t.map(r=>eC(r,e))}function eC(t,e){let r=t.type,o=t.attachment;return di.create({key:e?v():t.key,type:r,description:Io(t.description),attachment:o?tC(o):void 0,content:oC(r,t.content,e),feedback:rC(t.feedback)})}function tC(t){let e={crop:t.crop||void 0,title:t.title||void 0,previewSrc:t.previewSrc||void 0};return Fm.create({type:t.type,width:t.width,height:t.height,src:t.src,...e})}function rC(t){return Wt.create({type:t.type,correct:Io(t.correct),incorrect:Io(t.incorrect),answered:Io(t.answered)})}function Io(t){return jr({text:t.text,inlineStyleRanges:t.inlineStyleRanges,urls:t.urls})}function oC(t,e,r){switch(t){case"mc":case"mr":return nC(e,r);case"ti":return sC(e,r);default:throw F(t),new Error(`Unknown question type: ${t}`)}}function nC(t,e){let r=t.choices,o=r?r.map(n=>iC(n,e)):[];return ai.create({choices:o})}function iC(t,e){return Xr.create({key:e?v():t.key,text:Io(t.text),correct:t.correct})}function sC(t,e){let r=t.answers,o=r?r.map(n=>aC(n,e)):[];return li.create({caseSensitive:t.caseSensitive,answers:o})}function aC(t,e){return ci.create({key:e?v():t.key,text:t.text})}var yi={create(t={}){return{...ze.create(t),type:f.EMBED,width:t.width||0,height:t.height||0,src:t.src||"",alignment:t.alignment||"inner"}},toEmbedBlock(t){return t.type!==f.EMBED?null:t}};var _i={create(t={}){return{...ze.create(t),type:f.IMAGE,src:t.src||"",isBlob:t.isBlob||!1,crop:t.crop||void 0}},toImageBlock(t){return t&&t.type===f.IMAGE?t:null}};function cC(t){return E.create({key:t.key,viewType:t.viewType,textAlign:t.textAlign,characters:jr({text:t.text,inlineStyleRanges:t.inlineStyleRanges,urls:t.urls}),isOrderedListFirstItem:t.isOrderedListFirstItem})}function lC(t){let e=t.text||"";return _i.create({key:t.key,characters:jr({text:e,inlineStyleRanges:t.inlineStyleRanges,urls:t.urls}),src:t.src,width:t.width,height:t.height,alignment:t.alignment})}function dC(t){let e=t.text||"";return yi.create({key:t.key,characters:jr({text:e,inlineStyleRanges:t.inlineStyleRanges||[],urls:t.urls}),src:t.src,width:t.width,height:t.height,alignment:t.alignment})}function mC(t){return dr.create({key:t.key,fileName:t.fileName,fileSize:t.fileSize,fileExtension:t.fileExtension})}function uC(t){switch(t.type){case f.PARAGRAPH:return cC(t);case f.IMAGE:return lC(t);case f.EMBED:return dC(t);case f.EXERCISE:return su(t);case f.ATTACHMENT:return mC(t)}return h.error(`unknown block type ${t.type}`),null}function au(t){let e=[];return t.forEach(r=>{let o=uC(r);o&&e.push(o)}),e}function cu(t){let e=au(t),r={order:[],blocks:{}};for(let o of e)r.order.push(o.key),r.blocks[o.key]=o;return{blockMap:r}}function pC(t){let e={kicker:t.kicker,title:t.title,coverInfoState:null};return t.coverSrc&&t.coverColor&&t.coverWidth!=null&&t.coverHeight!=null&&t.coverOpacity!=null&&(e.coverInfoState={src:t.coverSrc,width:t.coverWidth,height:t.coverHeight,color:t.coverColor,opacity:t.coverOpacity,isBlob:!1}),{header:{kicker:e.kicker,title:e.title,coverInfoState:e.coverInfoState},contentState:cu(t.blocks)}}function fC(t){return{key:t.key,header:{title:t.title},contentState:cu(t.blocks)}}function lu(t){let e=pC(t.intro),r=(t.chapters||[]).map(o=>fC(o));return{intro:e,chapters:rn(r,o=>o.key)}}function hC(t,e){return{main:{navigationType:t.navigationType,numberingEnabled:t.numberingEnabled,nextButtonEnabled:t.nextButtonEnabled,copyingEnabled:t.copyingEnabled},design:{accentColor:e[dt.ACCENT_COLOR],headerFont:t.fonts[Ze.PLAYER_MAIN],contentFont:t.fonts[Ze.CONTENT]}}}function du(t){return{content:lu(t.content),settings:hC(t.publishSettings,t.cssReplacements)}}function mu(t){let e=t.blocks;for(let r of Object.keys(e)){let o=e[r];if(o.type===f.IMAGE){let n=e[r],i={alignment:n.alignment,key:n.key,type:f.COLLAGE,images:[{key:v(),type:n.type,parentCollageKey:n.key,width:n.width,height:n.height,src:n.src,characters:n.characters,isBlob:n.isBlob,alignment:"inner"}]};e[r]=i}else if(o.type===f.EMBED){let n=e[r],i={key:n.key,type:n.type,width:n.width,height:n.height,src:n.src,alignment:n.alignment,characters:n.characters};e[r]=i}else e[r]=o}}function uu(t){return Qr(t,e=>{mu(e.intro.contentState.blockMap);for(let r of Object.values(e.chapters.blocks))r&&mu(r.contentState.blockMap)})}function pu({content:t,settings:e}){return{content:uu(t),settings:e}}function fu(t){return t}function hu(t){return t}function gu(t){return t}function yu(t){return t}function _u(t){return{...t,main:{...t.main,longreadType:"multiplePage"}}}function Cu(t){return{...t,settings:_u(t.settings)}}function Ea(t,e){return gC(t,1,e,13,[{targetVersion:2,upgradeFn:nu},{targetVersion:3,upgradeFn:iu},{targetVersion:4,upgradeFn:du},{targetVersion:5,upgradeFn:pu},{targetVersion:6,upgradeFn:fu},{targetVersion:7,upgradeFn:hu},{targetVersion:8,upgradeFn:gu},{targetVersion:9,upgradeFn:yu},{targetVersion:10,upgradeFn:Cu},{targetVersion:11,upgradeFn:jm},{targetVersion:12,upgradeFn:tu},{targetVersion:13,upgradeFn:ou}]).upgradedDocument}function gC(t,e,r,o,n){return new gi({initialVersion:e,upgraders:n}).upgradeDocument(t,{from:r,to:o})}async function yC(t){let e=await nl(t,n=>{switch(n){case 1:return fi;case 2:return Vm;case 3:return Ym;default:throw Error("invalid blob document format")}}),{version:r,data:o}=e;return Ea(o,r)}function _C(t){return"content"in t&&"settings"in t&&"version"in t?CC({version:t.version,content:t.content,settings:t.settings}):null}function CC({version:t,content:e,settings:r}){return Ea({content:Pm(e,t),settings:Ol(r,t)},t)}async function ku(t){let e;return t instanceof Blob?e=yC(t):e=_C(t),e}function Su(t,e){let r;function o(){r&&(clearTimeout(r.id),r=void 0)}function n(){if(r){let a=r.handler;o(),a()}}function i(...a){o();let c=()=>{o(),t(...a)};r={id:setTimeout(c,e),handler:c}}function s(...a){o(),t(...a)}return{isPending:()=>pe(r),cancel:o,flush:n,call:i,forceCall:s}}function bu(t){let e=t.length;if(!e)return 0;let r=0;for(;--e%4>1&&t.charAt(e)==="=";)++r;return Math.ceil(t.length*3)/4-r}var Zr=new Array(64),wu=new Array(123);for(let t=0;t<64;)wu[Zr[t]=t<26?t+65:t<52?t+71:t<62?t-4:t-59|43]=t++;function Tu(t,e=0,r=t.length){var o=null,n=[];let i=0,s=0,a;for(;e<r;){let c=t[e++];switch(s){case 0:n[i++]=Zr[c>>2],a=(c&3)<<4,s=1;break;case 1:n[i++]=Zr[a|c>>4],a=(c&15)<<2,s=2;break;case 2:n[i++]=Zr[a|c>>6],n[i++]=Zr[c&63],s=0;break}i>8191&&((o||(o=[])).push(String.fromCharCode(...n)),i=0)}return s&&(n[i++]=Zr[a],n[i++]=61,s===1&&(n[i++]=61)),o?(i&&o.push(String.fromCharCode(...n.slice(0,i))),o.join("")):String.fromCharCode(...n.slice(0,i))}var xu="invalid encoding";function vu(t,e,r=0){let o=r,n=0,i;for(let s=0;s<t.length;){let a=t.charCodeAt(s++);if(a===61&&n>1)break;if((a=wu[a])===void 0)throw Error(xu);switch(n){case 0:i=a,n=1;break;case 1:e[r++]=i<<2|(a&48)>>4,i=a,n=2;break;case 2:e[r++]=(i&15)<<4|(a&60)>>2,i=a,n=3;break;case 3:e[r++]=(i&3)<<6|a,n=0;break}}if(n===1)throw Error(xu);return r-o}function Eu(t,e,r){let{Type:o}=r,n=o.verify(e);if(n)throw new Error(n);let i=o.fromObject(e),s=o.encode(i).finish(),a=new Uint8Array(new Uint32Array([t]).buffer),c=new Uint8Array([...a,...s]);return Tu(c)}function Bu(t,e){let r=new Uint8Array(bu(t));vu(t,r);let o=new Uint32Array(r.buffer.slice(0,Uint32Array.BYTES_PER_ELEMENT))[0],n=new Uint8Array(r.buffer.slice(Uint32Array.BYTES_PER_ELEMENT)),{Type:i}=e(o),s=i.decode(n);return i.toObject(s)}function Ci(t){return t.type==="mc"||t.type==="mr"?t:null}function ki(t){return t.type==="ti"?t:null}var Ru={create(t){return{choice:t,selected:!1}}};function kC(t){for(let e=0;e<t.length;++e){let r=Math.floor(Math.random()*e),o=t[e];t[e]=t[r],t[r]=o}}function SC(t,e){let r=t.map(o=>Ru.create(o));return e&&kC(r),r}var Du={create(t,e){return{choicesState:SC(t.choices,e)}}};var Iu={create(t){return{typeIn:t,answer:""}}};function xC(t,e){let r=Ci(t);if(r)return Du.create(r.content,e);let o=ki(t);if(o)return Iu.create(o.content);throw new Error(`Unknown question type: ${t.type}`)}var Si={create(t,e){return{question:t,answered:!1,contentState:xC(t,e)}}};function bC(t,e){return t.map(r=>Si.create(r,e))}var Re={create(t){let e=bC(t.questions,t.settings.shuffleAnswers),r=e.length>0?0:-1;return{key:t.key,type:f.EXERCISE,exercise:t,questionsState:e,selectedQuestionIndex:r}},toExerciseState(t){return t.type!=f.EXERCISE?null:t},previousQuestionAvailable(t){return t.selectedQuestionIndex>0},nextQuestionAvailable(t){return t.selectedQuestionIndex<t.questionsState.length-1},selectedQuestionState(t){let e=t.selectedQuestionIndex;return e>=0?t.questionsState[e]:null}};function wC(t){let e=[];for(let r of t){let o=St.toExerciseBlock(r);o&&e.push(Re.create(o))}return e}var xi={create(t=[]){return{blockMap:G.createBlocks(t),progress:0,blocksState:wC(t)}}};var bi={create(t={}){return{title:t.title||"",subtitle:t.subtitle||""}}};var Mu={create(t){return{key:t.key||"",header:t.header||bi.create(),contentState:t.contentState||xi.create(),index:t.index||0,progress:t.progress||0}}};var Au={create(t={}){return{title:t.title||"",kicker:t.kicker||"",coverInfo:t.coverInfo||null}}};var Ou={create(t){return{key:t.key,header:t.header,contentState:t.contentState,index:-1,progress:t.progress||0}}};function TC(t,e){return(Math.floor(t.progress)+e.reduce((o,n)=>o+Math.floor(n.progress),0))/(e.length+1)}function vC(t,e){let r=e+1;return t[r]||null}var me={sections(t){return[t.intro,...t.chapters]},nextSection(t){return vC(t.chapters,t.selectedSectionIndex)},progress(t){return TC(t.intro,t.chapters)},selectedSection(t){let e=t.selectedSectionIndex;return e==-1?t.intro:t.chapters[e]},create(t,e){return{intro:t,chapters:e,selectedSectionIndex:-1,navigationPanelShowed:!1}}};function Fu(t){let e=[];for(let r of t.blockMap.order)e.push(t.blockMap.blocks[r]);return xi.create(e)}function EC(t){let e={kicker:t.header.kicker,title:t.header.title,coverInfo:t.header.coverInfoState};return t.header.coverInfoState&&(e.coverInfo={src:t.header.coverInfoState.src,width:t.header.coverInfoState.width,height:t.header.coverInfoState.height,color:t.header.coverInfoState.color,opacity:t.header.coverInfoState.opacity}),Ou.create({key:"intro",header:Au.create(e),contentState:Fu(t.contentState),progress:0})}function BC(t,e){return Mu.create({key:t.key,index:e,header:bi.create({title:t.header.title}),contentState:Fu(t.contentState)})}function Pu(t){let e=EC(t.intro),r=t.chapters.order.map((o,n)=>BC(t.chapters.blocks[o],n));return me.create(e,r)}function pt(t){return Ci(t.question)?t:null}function Ye(t){return ki(t.question)?t:null}var{Int:RC,Bool:wi,String:Jr}=Be,Nu=S({key:Jr(1),selected:wi(2)}),DC=S({choicesState:P(1,Nu)}),IC=S({choicesState:P(1,Nu)}),MC=S({answer:Jr(1)}),AC=S({key:Jr(1),answered:wi(2),contentState:T(3,DC)}),OC=S({key:Jr(1),answered:wi(2),contentState:T(3,IC)}),FC=S({key:Jr(1),answered:wi(2),contentState:T(3,MC)}),PC=Ne({mc:AC,mr:OC,ti:FC}),Lu=S({key:Jr(1),selectedQuestionIndex:RC(2),questionsState:P(3,PC)});var{Float:$u,Int:NC}=Be;var Ku=Ne({[f.EXERCISE]:Lu}),LC=S({intro:T(1,{progress:V(1,$u),blocksState:P(2,Ku)}),chapters:P(2,{progress:V(1,$u),blocksState:P(2,Ku)}),selectedChapter:V(3,NC)}),Ti=new Mt(LC);function Hu(t,e){let r=e.questionsState;if(!r)return;let o=t.questionsState;for(let i=0;i<o.length;++i){let s=o[i],a=r[i];s.answered=a.answered,$C(s,a.contentState)}let n=e.selectedQuestionIndex;typeof n=="number"&&(t.selectedQuestionIndex=n)}function $C(t,e){let r=pt(t);if(r){KC(r.contentState,e);return}let o=Ye(t);if(o){HC(o.contentState,e);return}throw new Error(`Unknown question type: ${t.question.type}`)}function KC(t,e){if(!e.choicesState)return;let r=t.choicesState,o=new Map;for(let i of r)o.set(i.choice.key,i);let n=[];for(let i of e.choicesState){let s=o.get(i.key);s.selected=i.selected,n.push(s)}t.choicesState=n}function HC(t,e){t.answer=e.answer}function Wu(t,e){let{intro:r,chapters:o,selectedChapter:n}=e;if(r){let{progress:i,blocksState:s}=r;typeof i=="number"&&(t.intro.progress=i),s&&Vu(t.intro.contentState.blocksState,s)}o&&t.chapters.forEach((i,s)=>{let a=d(o)[s],{progress:c,blocksState:l}=a;c&&(i.progress=c),l&&Vu(i.contentState.blocksState,l)}),typeof n=="number"&&n>=0&&(t.selectedSectionIndex=n)}function Vu(t,e){for(let r of e){let o=t.find(i=>r.key==i.key);if(!o)continue;let n=Re.toExerciseState(o);if(n){Hu(n,r);continue}throw new Error(`Unexpected block state type: ${o.type}`)}}function Uu(t,e){let r=Pu(t.content);if(e)try{let o=Bu(e,()=>Ti);Wu(r,o)}catch(o){h.warn(o)}return r}function zu(t){let e=t.questionsState,r=t.selectedQuestionIndex;return{key:t.key,type:t.type,selectedQuestionIndex:r,questionsState:VC(e)}}function VC(t){return t.map(e=>WC(e))}function WC(t){let e=t.question,r=e.type;return{key:e.key,type:r,answered:t.answered,contentState:UC(t)}}function UC(t){let e=pt(t);if(e)return zC(e.contentState);let r=Ye(t);if(r)return QC(r.contentState);throw new Error(`Unknown question type: ${t.question.type}`)}function zC(t){return{choicesState:t.choicesState.map(e=>GC(e))}}function GC(t){return{key:t.choice.key,selected:t.selected}}function QC(t){return{answer:t.answer}}function Gu(t){return t.map(e=>{let r=Re.toExerciseState(e);if(r)return zu(r);throw new Error(`Unexpected block state type: ${e.type}`)})}function Qu(t){return{intro:{progress:t.intro.progress,blocksState:Gu(t.intro.contentState.blocksState)},chapters:t.chapters.map(e=>({progress:e.progress,blocksState:Gu(e.contentState.blocksState)})),selectedChapter:t.selectedSectionIndex}}var vi=class{constructor(e){this.navigationType=e.main.navigationType,this.longreadType=e.main.longreadType,this.searchEnabled=!1,this.numberingEnabled=e.main.numberingEnabled,this.nextButtonEnabled=e.main.nextButtonEnabled,this.copyingEnabled=e.main.copyingEnabled,this.fonts={tooltip:mo(ge.LATO),playerMain:mo(e.design.headerFont),content:mo(e.design.contentFont)}}};function bt({reducer:t,timingFn:e,duration:r,abortSignal:o,beforeAnimation:n,afterAnimation:i}){let s=Date.now(),a=!1,c=new Ie;function l(){if(a)return;let u=ht(Date.now()-s,0,r),g=e(u/r);t.animate(g),u<r?Ce(l):(i&&i(),o&&o.remove(m),c.dispatch(!0),Ce(()=>{t.complete()}))}n&&n(),Ce(l);function m(){a=!0,d(o).remove(m),c.dispatch(!1)}return o&&o.add(m),c}function Yu(t){return t}function Gt(t){return--t*t*t+1}function Ba(t,e){return r=>r<e?0:t((r-e)/(1-e))}function Ei(t){return e=>1-t(e)}function YC({setScrollValue:t,initialValue:e,delta:r,duration:o}){if(!r)return;bt({duration:o,timingFn:Gt,reducer:{animate:i=>{t(e+r*i)},complete:()=>{},changedProperties:[]}})}function qu({element:t,container:e,duration:r,scrollDirection:o,bounds:n}){let i=t.getBoundingClientRect(),s=0;o==="top"&&n.top>i.top?s=i.top-n.top:o==="bottom"&&n.bottom<i.bottom&&(s=i.bottom-n.bottom),YC({initialValue:e.scrollTop,setScrollValue:a=>{e.scrollTop=a},delta:s,duration:r})}function gr(t,e){let r=window.getComputedStyle(t),o=r&&r.opacity?parseFloat(r.opacity):1;return{animate:n=>{t.style.opacity=`${o-o*n}`},complete:()=>{t.style.opacity=e||""},changedProperties:["opacity"]}}function qC({element:t,initialTransform:e,from:r,to:o}){let{x:n,y:i}=nn(t),s=r.x||n,a=r.y||i,c=0,l=0;o.x!==void 0&&(c=o.x-s),o.y!==void 0&&(l=o.y-a);let m=null;return{animate:u=>{m==null&&(m=on(t)),t.style.transform=`${m} translate(${c*u}px, ${l*u}px)`},complete:()=>{t.style.transform=e||""},changedProperties:["transform"]}}function Xu({element:t,initialTransform:e,from:r,to:o}){return qC({element:t,initialTransform:e,from:{y:r},to:{y:o}})}function ju(t){return t`
<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="m12 15-5-5 5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
`}function Zu(t){return t`
<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="m8 15 5-5-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
`}var Ju="li 0";function ep(t){let e=K(qr.getFirstBlock(t));return e&&e.viewType==="subheader"?e.key:""}var Bi=class extends O{constructor(){super({blockName:"insert-indicator"})}_render(){return this._html`
			<div class=${this._getCssClasses()}></div>`}};var Ri=class{constructor(e,r){this.type=e,this.items=[],this.isNewList=r}};var Di=class extends O{constructor(e){super({blockName:"rich-text-editor",direction:e}),this._renderers={},this._allowSubtitle=!1,this._readonlyMode=!1,this._prevBlockType=null,this._prevFloatedElementRenderer=null,this.onHyperlinkOver=this._createSignal()}getLockedBlocks(){return[]}setReadonlyMode(e){this._readonlyMode!==e&&(this._readonlyMode=e,this._sheduleRender())}setDirection(e){this._direction!==e&&(super.setDirection(e),this._sheduleRender())}setAllowSubtitle(e){e!==this._allowSubtitle&&(this._allowSubtitle=e,this._sheduleRender())}registerRenderer(e,r){this._renderers[e]=r}_getReadonlyMode(){return this._readonlyMode}_getBlockMap(){}_getParagraphPlaceholder(e){return""}_getParagraphPrompt(e){return""}_getListRelatedData(){return{}}_getListId(e){return e.items.filter(r=>!(r instanceof Bi)).reduce((r,o)=>`${r}-${o.key}`,"")}isLock(e){return!1}_renderBlock(e,r){let o=K(e);if(o){let b=this._getParagraphPlaceholder(o),N=this._getParagraphPrompt(o),I=new Qe({subtitleKey:this._allowSubtitle?ep(this._getBlockMap()):"",paragraph:o,blockBeforeType:this._prevBlockType,placeholder:b,prompt:N,paragraphIndex:r,direction:this._direction});return this._prevBlockType=I.type(),this._prevFloatedElementRenderer&&(this._prevFloatedElementRenderer.updateModifier("before",I.type()),this._prevFloatedElementRenderer=null),ct(I,this.onHyperlinkOver.toFn(),this._readonlyMode,this.isLock(e))}let i=this._renderers[e.type]({block:e,blockBeforeType:this._prevBlockType,onHyperlinkOverFn:this.onHyperlinkOver.toFn(),readonlyMode:this._readonlyMode,isLock:this.isLock(e),direction:this._direction}),s=So.toAbstractMediaBlock(e);s&&(s.alignment==="float-left"?this._prevFloatedElementRenderer=i:this._prevBlockType=So.getBlockType(s));let a=St.toExerciseBlock(e);a&&(this._prevBlockType=St.getBlockType(a));let c=dr.toAttachmentBlock(e);c&&(this._prevBlockType=dr.getBlockType(c));let l=ye.toCollageBlock(e);l&&(this._prevBlockType=ye.getBlockType(l));let m=Je.toNoteBlock(e);m&&(this._prevBlockType=Je.getBlockType(m));let u=p.toTableBlock(e);u&&(this._prevBlockType=p.getBlockType(u));let g=M.toFlipCardsBlock(e);return g&&(this._prevBlockType=M.getBlockType(g)),i.domElement()}_processBlock({blocks:e,block:r}){e.push(r)}_getBlockGroups(){let e=[],r=null,o=this._getBlockMap();return qr.forEach(o,n=>{if(E.isList(n)){let i=d(K(n));r&&r.type!==i.viewType&&(e.push(r),r=null);let s=i.viewType==="ol"&&!!i.isOrderedListFirstItem;(!r||s)&&(r&&e.push(r),r=new Ri(i.viewType,s)),this._processBlock({blocks:r.items,block:n});return}r&&(e.push(r),r=null),this._processBlock({blocks:e,block:n})}),r&&e.push(r),e}_renderBlockGroup(e,r){let o=`enter-paragraph-field-${r}`;if(e instanceof Ri){let n=e.items.map((a,c)=>this._renderBlock(a,c)),i=D(this._getListRelatedData(),this._getListId(e));if(e.type==="ul")return i`<ul class='list-block' data-at=${ee(o)}>${n}</ul>`;let s=e.isNewList?{"counter-reset":Ju}:null;return i`<ol class='list-block' style=${s}>${n}</ol>`}return this._renderBlock(e,r)}_renderBlocks(){return this._prevBlockType="none",this._getBlockGroups().map((e,r)=>this._renderBlockGroup(e,r))}};var Ii=class extends Di{constructor(e,r=Ve()){super(r),this._state=e}updateState(e){this._state!=e&&(this._state=e,this._sheduleRender())}_getBlockMap(){return this._state.blockMap}isLock(e){return!0}_render(){return this._html`
			<div class=${this._getCssClasses()}>
				${this._renderBlocks()}
			</div>`}};var Ra=0,tp=1024,rp=tp*1024,XC=rp*1024;function op(t){return Math.round(t*10)/10}function jC(t){return Math.max(Ra,Math.round(t/tp))}function ZC(t){return Math.max(Ra,op(t/rp))}function JC(t){return Math.max(Ra,op(t/XC))}function np(t){let e=JC(t);if(e>1)return x("Common.FileSize.ToGb",{volume:e});let r=ZC(t);return r>1?x("Common.FileSize.ToMb",{volume:r}):x("Common.FileSize.ToKb",{volume:jC(t)})}function eo(t,{component:e,tooltipText:r,size:o,stayOnHover:n,show:i,side:s,align:a,isPreventDefaultClick:c}){let l=B();return st({html:t,elementRef:l,text:r,size:o,stayOnHover:n,show:i,side:s,align:a,isPreventDefaultClick:c}),Pt(t,e,l)}function ip(t){return t`
<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M39 45.375H9A2.375 2.375 0 0 1 6.625 43V5A2.375 2.375 0 0 1 9 2.625h21.28c.647 0 1.267.264 1.715.731l8.72 9.093c.423.442.66 1.031.66 1.644V43A2.375 2.375 0 0 1 39 45.375z" fill="#fff" stroke="#D0D0D1" stroke-width="1.25"/><path d="M30.841 31.182V19.068h1.803c.61 0 1.106.495 1.106 1.106v9.902c0 .61-.495 1.106-1.106 1.106H30.84zM14.25 17.68v15.166L28.773 34.5V15.75L14.25 17.68z" fill="#4169B4"/><path d="m23.61 27.043 1.118-6.117h1.705l-1.842 8.597H22.87l-1.352-5.751-1.351 5.75h-1.723l-1.842-8.596h1.705l1.124 6.105 1.369-6.105h1.448l1.363 6.117z" fill="#fff"/></svg>
`}function sp(t){return t`
<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M39 45.375H9A2.375 2.375 0 0 1 6.625 43V5A2.375 2.375 0 0 1 9 2.625h21.28c.647 0 1.267.264 1.715.731l8.72 9.093c.423.442.66 1.031.66 1.644V43A2.375 2.375 0 0 1 39 45.375z" fill="#fff" stroke="#D0D0D1" stroke-width="1.25"/><path d="M14.658 26.355v2.895h-2.056v-8.531h3.404c.652 0 1.228.12 1.728.363.504.238.893.58 1.166 1.025.278.442.416.944.416 1.506 0 .832-.299 1.498-.896 1.998-.594.496-1.41.744-2.45.744h-1.312zm0-1.587h1.348c.398 0 .701-.1.908-.3.21-.198.316-.48.316-.843 0-.398-.107-.717-.322-.955-.215-.238-.508-.36-.879-.363h-1.37v2.46zM21.018 29.25v-8.531h2.748c.754 0 1.432.172 2.033.515a3.56 3.56 0 0 1 1.406 1.448c.34.62.512 1.318.516 2.091v.393c0 .781-.166 1.482-.498 2.104a3.619 3.619 0 0 1-1.395 1.453 3.956 3.956 0 0 1-2.003.527h-2.807zm2.056-6.943v5.361h.715c.59 0 1.043-.209 1.36-.627.316-.422.474-1.047.474-1.875v-.37c0-.823-.158-1.444-.474-1.862-.317-.418-.778-.627-1.383-.627h-.691zM34.749 25.852h-3.317v3.398h-2.056v-8.531h5.707v1.588h-3.65v1.963h3.316v1.582z" fill="#E05D36"/></svg>
`}function ap(t){return t`
<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M39 45.375H9A2.375 2.375 0 0 1 6.625 43V5A2.375 2.375 0 0 1 9 2.625h21.28c.647 0 1.267.264 1.715.731l8.72 9.093c.423.442.66 1.031.66 1.644V43A2.375 2.375 0 0 1 39 45.375z" fill="#fff" stroke="#D0D0D1" stroke-width="1.25"/><path d="M30.5 31.25V19h1.75a1.5 1.5 0 0 1 1.5 1.5v9.25a1.5 1.5 0 0 1-1.5 1.5H30.5zM14.25 17.68v15.166L28.875 34.5V15.75L14.25 17.68z" fill="#D1684D"/><path d="M20.49 26.523v3.102h-1.746V20.82h3.305c.636 0 1.194.12 1.675.363a2.6 2.6 0 0 1 1.118 1.034c.26.443.39.95.39 1.518 0 .862-.286 1.544-.856 2.044-.566.496-1.352.744-2.357.744h-1.53zm0-1.47h1.559c.461 0 .812-.113 1.053-.339.244-.226.366-.548.366-.967 0-.432-.122-.78-.366-1.046-.245-.267-.582-.404-1.013-.412h-1.6v2.764z" fill="#fff"/></svg>
`}function cp(t){return t`
<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M39 45.375H9A2.375 2.375 0 0 1 6.625 43V5A2.375 2.375 0 0 1 9 2.625h21.28c.647 0 1.267.264 1.715.731l8.72 9.093c.423.442.66 1.031.66 1.644V43A2.375 2.375 0 0 1 39 45.375z" fill="#fff" stroke="#D0D0D1" stroke-width="1.25"/></svg>
`}function lp(t){return t`
<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M39 45.375H9A2.375 2.375 0 0 1 6.625 43V5A2.375 2.375 0 0 1 9 2.625h21.28c.647 0 1.267.264 1.715.731l8.72 9.093c.423.442.66 1.031.66 1.644V43A2.375 2.375 0 0 1 39 45.375z" fill="#fff" stroke="#D0D0D1" stroke-width="1.25"/><path d="M30.5 31.25V19h1.75a1.5 1.5 0 0 1 1.5 1.5v9.25a1.5 1.5 0 0 1-1.5 1.5H30.5zM14.25 17.68v15.166L28.875 34.5V15.75L14.25 17.68z" fill="#468B5B"/><path d="m21.563 23.855 1.588-3.035h2.007l-2.467 4.366 2.531 4.439h-2.03l-1.63-3.084-1.629 3.084h-2.03l2.53-4.439-2.466-4.366h2.007l1.588 3.035z" fill="#fff"/></svg>
`}function dp(t){return t`
<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="m6.293 10.707 3 3a1 1 0 0 0 1.414 0l3-3a1 1 0 0 0-1.414-1.414L11 10.586V3a1 1 0 1 0-2 0v7.586L7.707 9.293a1 1 0 0 0-1.414 1.414zM5 15a1 1 0 1 0-2 0v1a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-1a1 1 0 1 0-2 0v1H5v-1z" fill="currentColor"/></svg>
`}var wt={attachmentFigure:{withMods:t=>__getCssClass("x99dbb__attachment-figure",t)},attachmentSubblock:{withMods:t=>__getCssClass("x99dbb__attachment-subblock",t)},attachmentBlock:{withMods:t=>__getCssClass("x99dbb__attachment-block",t)},dndIcon:"x99dbb__dnd-icon",attachmentIcon:"x99dbb__attachment-icon",attachmentInfo:"x99dbb__attachment-info",attachmentName:"x99dbb__attachment-name",attachmentSize:"x99dbb__attachment-size",attachmentButtons:"x99dbb__attachment-buttons",placeholder:"x99dbb__placeholder"};function ek(t,{disabled:e,onReplace:r,onDownload:o}){return t`
<div class=${wt.attachmentButtons}>
	${t.renderIf(eo,()=>r&&{component:C(Me,{state:e?"disabled":"default",style:"linkSecondary",structure:"icon",icon:C(Wn),size:"small",onClick:r}),tooltipText:x("Roll.Editor.AttachmentBlock.UpdateButtonTooltip")})}
	${t(eo,{component:C(Me,{state:e?"disabled":"default",style:"linkSecondary",structure:"icon",icon:C(dp),size:"small",onClick:o}),tooltipText:x("Roll.Editor.AttachmentBlock.DownloadButtonTooltip")})}
</div>`}function tk(t,{extension:e}){return t`
<div class=${wt.attachmentIcon}>
	${t.switch(()=>{switch(e){case"doc":case"docx":return C(ip,{});case"ppt":case"pptx":return C(ap,{});case"xls":case"xlsx":return C(lp,{});case"pdf":return C(sp,{});default:return C(cp,{})}})}
</div>`}function rk(t){return t`
<img class=${wt.placeholder} aria-hidden=true src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" />`}function mp(t,{fileName:e,fileSize:r,fileExtension:o,isLoading:n,isPlayer:i,disabled:s,onReplace:a,onDownload:c}){let l=B();return de(l,"click",()=>{i&&c()}),t`
<div
	class=${wt.attachmentBlock.withMods({clickable:i,lock:!!s})}
	save-ref=${l}
	draggable=true
>
	${t.switch(()=>n?C(Mm,{size:"medium"},wt.attachmentIcon):C(tk,{extension:o}))}
	<div class=${wt.attachmentSubblock.withMods({uploading:n})}>
		<div class=${wt.attachmentInfo}>
			<div class=${wt.attachmentName}>
				${e}
			</div>
			<div class=${wt.attachmentSize}>${np(r)}</div>
		</div>
		${t(ek,{disabled:!!s,onReplace:a,onDownload:i?()=>{}:c})}
		${t.renderIf(rk,()=>!i&&!n)}
	</div>
</div>`}var ok={attachmentFigure:{withMods:t=>__getCssClass("x99dbb__attachment-figure",t)},attachmentSubblock:{withMods:t=>__getCssClass("x99dbb__attachment-subblock",t)},attachmentBlock:{withMods:t=>__getCssClass("x99dbb__attachment-block",t)},dndIcon:"x99dbb__dnd-icon",attachmentIcon:"x99dbb__attachment-icon",attachmentInfo:"x99dbb__attachment-info",attachmentName:"x99dbb__attachment-name",attachmentSize:"x99dbb__attachment-size",attachmentButtons:"x99dbb__attachment-buttons",placeholder:"x99dbb__placeholder"},nk="attachment-block",Da={},ik={},Ia=class extends O{constructor({block:e}){super({blockName:nk}),this._block=e,this._attachmentElement=null}setBlock(e){this._block!==e&&(this._attachmentElement=null,this._block=e,this._sheduleRender())}_render(){let{key:e,src:r,fileName:o}=this._block,n=Ct(ik,`:attachment-block-${e}`),i=!0;return n`
<figure class=${Oe(this._getCssClasses(),ok.attachmentFigure.withMods({playerView:i}))}>
	${n(mp,{...this._block,isPlayer:i,onDownload:()=>{let s=document.createElement("a");s.setAttribute("href",Lt(d(r))),s.setAttribute("download",o),s.click()}})}
</figure>`}};function up({block:t,blockBeforeType:e}){let r;return Da[t.key]?(r=Da[t.key],r.setBlock(t)):(r=new Ia({block:t}),Da[t.key]=r),r.updateModifier("after",e),r}var Ma={create(t){return{key:"",..._i.create(t),parentCollageKey:t.parentCollageKey}},toCollagedImageBlock(t){return t&&t.type===f.IMAGE&&t.parentCollageKey?t:null}};var Qt=class extends O{constructor({bemInfo:e,blockName:r,block:o,relatedData:n}){super({bemInfo:e,blockName:r,block:o,relatedData:n}),this._hidden=!1,this._x=null,this._y=null,this._width=null,this._height=null,this._text=""}onDisconnected(){return this._getBrowserEventSignal($.CUSTOM_DISCONNECTED)}setText(e){this._text=e,this._sheduleRender()}show(){this._hidden&&(this._hidden=!1,this._sheduleRender())}hide(){this._hidden||(this._hidden=!0,this._sheduleRender())}visible(){return!this._hidden}x(){return this._x}y(){return this._y}move(e,r){(e!=this._x||r!=this._y)&&(this._x=e,this._y=r,this._sheduleRender())}setWidth(e){e!=this._width&&(this._width=e,this._sheduleRender())}setHeight(e){e!=this._height&&(this._height=e,this._sheduleRender())}_getText(){return this._text}_getBaseStyles(){let e={display:this._hidden?"none":""};return this._x!=null&&(e.left=this._x),this._y!=null&&(e.top=this._y),this._width!=null&&(e.width=this._width),this._height!=null&&(e.height=this._height),e}_render(){return this._html`
<div
	class=${this._getCssClasses()}
	style=${this._getBaseStyles()}
	ondisconnected=${this}
>
	${this._text}
</div>`}};var sk={dndIcon:"x5813d__dnd-icon"};function pp(t,{className:e}){return t`
<div class=${Oe(sk.dndIcon,e)} draggable="true">
	${t(C(Im))}
</div>`}var Mi="media-block",ak="wrapper",ck="content",lk="placeholder",dk=740,Ai=class extends O{constructor({block:e,contentRendererFn:r,direction:o}){super({blockName:Mi,direction:o}),this._block=e,this._contentRendererFn=r,this._wrapperClassName=new le(Mi,ak).className(),this._contentClassName=new le(Mi,ck).className(),this._placeholderClassName=new le(Mi,lk).className(),this.fixedRatio=0,this.setBlock(e)}getBlock(){return this._block}setBlock(e){this._block=e,this._invalidateModifiers()}setDirection(e){this._direction!==e&&(super.setDirection(e),this._invalidateModifiers())}_invalidateModifiers(){this.updateModifier("align",this._block.alignment),this.updateModifier("dir",this._direction)}_getWrapperInlineStyles(){}_onContentSizeChange(e){this.fixedRatio=e,this._sheduleRender()}_getInlineStyles(){return document.body.clientWidth<=dk||this._block.alignment!=="float-left"||this._block.type===f.EMBED?null:{width:`${this._block.width}px`}}_getPlaceholderStyles(){return this._block.width?{"padding-bottom":`${(this.fixedRatio?this.fixedRatio:this._block.height/this._block.width)*100}%`}:{width:"100%",height:`${this._block.height}px`}}};var mk={layer:{withMods:t=>__getCssClass("xd16ae__layer",t)}};function fp(t,{type:e,onClick:r}){return t`
<div
	class=${mk.layer.withMods({type:e})}
	onclick=${r}
>
</div>`}function hp(t){switch(t){case"right":return"left";case"left":return"right";case"center":case"bottom":return t;default:throw F(t),new Error}}var Mo=220,yr="cubic-bezier(.24,.84,.26,.99)",uk=40,yp=480;function Aa(t){return t<=yp?360:440}function Oa(t){return t<=yp?280:320}function _p(t,e){return U(t,{center:{appearDuration:Mo,hideDuration:Mo,hideTranslate:[0,uk],appearTranslate:[0,0],fade:!0,easing:yr},right:{appearDuration:Aa(e.getBoundingClientRect().width),hideDuration:Oa(e.getBoundingClientRect().width),hideTranslate:[e.getBoundingClientRect().width,0],appearTranslate:[0,0],fade:!1,easing:yr},bottom:{appearDuration:Aa(e.getBoundingClientRect().height),hideDuration:Oa(e.getBoundingClientRect().height),hideTranslate:[0,e.getBoundingClientRect().height],appearTranslate:[0,0],fade:!1,easing:yr},left:{appearDuration:Aa(e.getBoundingClientRect().height),hideDuration:Oa(e.getBoundingClientRect().height),hideTranslate:[-e.getBoundingClientRect().width,0],appearTranslate:[0,0],fade:!1,easing:yr}})}function gp([t,e]){return`translate(${t}px, ${e}px)`}function Cp({element:t,transformStart:e,transformEnd:r,opacity:o,duration:n,easing:i}){return new KeyframeEffect(t,[{transform:gp(e),...o?{opacity:o[0]}:{}},{transform:gp(r),...o?{opacity:o[1]}:{}}],{duration:n,easing:i,fill:"forwards"})}function kp(t,e){let{hideTranslate:r,appearTranslate:o,fade:n,appearDuration:i,easing:s}=_p(t,e);return Cp({element:e,duration:i,transformStart:r,transformEnd:o,opacity:n?[0,1]:void 0,easing:s})}function Sp(t,e,r){let{hideTranslate:o,fade:n,appearTranslate:i,easing:s,hideDuration:a}=_p(t,e);return Cp({element:e,easing:s,duration:a,transformStart:i,transformEnd:o,opacity:n?[1,0]:void 0})}var pk=t=>new KeyframeEffect(t,[{opacity:0},{opacity:1}],{duration:Mo,easing:yr,fill:"forwards"}),fk=t=>new KeyframeEffect(t,[{opacity:1},{opacity:0}],{duration:Mo,easing:yr,fill:"forwards"});function xp({html:t,layer:e,props:r}){let o=t.renderIf(fp,()=>r),{element:n}=oi({element:o,getAppearKeyframes:pk,getHideKeyframes:fk});ni({layer:e,element:n}),J(()=>{if(!o)return;let i=br(e),s=i.style.pointerEvents;return i.style.pointerEvents="auto",()=>{i.style.pointerEvents=s}},[o,e])}function hk(t,e){switch(t){case"center":return{left:Math.round((window.innerWidth-e.clientWidth)*.5),top:Math.round((window.innerHeight-e.clientHeight)*.5)};case"right":return{top:0,bottom:0,right:0};case"bottom":return{bottom:0,left:0,right:0};case"left":return{top:0,bottom:0,left:0};default:throw F(t),new Error}}function Oi(t,e){let{left:r,top:o,bottom:n,right:i}=hk(t,e),s=a=>pe(a)?`${a}px`:"";e.style.top=s(o),e.style.right=s(i),e.style.bottom=s(n),e.style.left=s(r)}var Fa=new Map;function bp({type:t,element:e,onModalOverlayClick:r}){let o=B(null),n=An(),i=ke(r),s=Fe(()=>(Fa.has(t)||Fa.set(t,[]),d(Fa.get(t))),[t]);e&&o.current===null&&(o.current=s.push({idRef:o,redraw:n,onModalOverlayClick:()=>i.current&&i.current()})-1,o.current&&o.current>=1&&s[o.current-1].redraw()),!e&&o.current===s.length-1&&(o.current&&o.current>=1&&s[o.current-1].redraw(),s.pop(),o.current=null),J(()=>()=>{o.current!==null&&(s.splice(o.current),o.current=null)},[s]);let a=Z(()=>{if(s.length){let c=s[s.length-1];c.onModalOverlayClick&&c.onModalOverlayClick()}},[s]);return{isFirst:o.current===0,activeElement:o.current===s.length-1?e:null,onModalOverlayClick:a}}function wp(t){H(()=>{if(t){let e=window.document.body,r=e.style.overflow;return e.style.overflow="hidden",()=>{e.style.overflow=r}}},[t])}function Tp({html:t,side:e,createModal:r,close:o,beforeUnmount:n,modalOverlayType:i="default"}){let s=t(r()),a=Tr()?hp(e):e,{isFirst:c,activeElement:l,onModalOverlayClick:m}=bp({type:a==="center"?"popup":"sidePanel",element:s,onModalOverlayClick:o});wp(c),xp({html:t,layer:"popup",props:c?{type:i,onClick:m}:null});let{element:u}=oi({element:l,getAppearKeyframes:g=>kp(a,g),getHideKeyframes:g=>Sp(a,g)});ni({layer:"popup",element:u,onAppend:g=>Oi(a,g),beforeUnmount:n}),ya(document.body,()=>s&&Oi(a,s)),ya(s,()=>s&&Oi(a,s))}function vp({html:t,side:e,component:r,closeOnOverlayClick:o,modalOverlayType:n}){let[i,s]=Q(null);return Tp({html:t,side:e,createModal:()=>i&&C(r,i),close:o?()=>s(null):void 0,modalOverlayType:n}),Fe(()=>({open:s,close:()=>s(null)}),[])}function Ao(){return"ontouchstart"in document.documentElement}function Ep(t,e,r,o=300){let n=B(0),i=B(0);function s(){n.current=0,clearTimeout(i.current)}de(t,"click",c=>{c.preventDefault(),n.current+=1,n.current===1&&(i.current=setTimeout(()=>{r&&r(),s()},o)),n.current===2&&(e(),s())})}var Bp={button:{withMods:t=>__getCssClass("x0df61__button",t)},icon:"x0df61__icon"};function Rp(t,{style:e,onClick:r,autotestData:o}){return t`
<button
	class=${Bp.button.withMods({style:e})}
	onclick=${r}
	data-at=${ee(o)}
>
	${t($r,{},Bp.icon)}
</button>
`}function Dp(t){return t`
<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M16.293 2.293a1 1 0 1 1 1.414 1.414L14.414 7H16a1 1 0 1 1 0 2h-4a1 1 0 0 1-1-1V4a1 1 0 1 1 2 0v1.586l3.293-3.293zm-14 14a1 1 0 1 0 1.414 1.414L7 14.414V16a1 1 0 1 0 2 0v-4a1 1 0 0 0-1-1H4a1 1 0 1 0 0 2h1.586l-3.293 3.293zM18 17v-4a1 1 0 1 0-2 0v3h-3a1 1 0 1 0 0 2h4a1 1 0 0 0 1-1zM3 2a1 1 0 0 0-1 1v4a1 1 0 0 0 2 0V4h3a1 1 0 0 0 0-2H3z" fill="currentColor"/></svg>
`}function Ip(t){return t`
<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3 10h14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
`}function Mp(t){return t`
<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M11 3a1 1 0 1 0-2 0v6H3a1 1 0 0 0 0 2h6v6a1 1 0 1 0 2 0v-6h6a1 1 0 1 0 0-2h-6V3z" fill="currentColor"/></svg>
`}function Pa(t,e,r,o){let n=Math.abs(r.width-window.innerWidth)/2/o,i=-n,s=Math.abs(r.height-window.innerHeight)/2/o,a=-s,c=ht(t,i,n),l=ht(e,a,s);return{fittedX:c,fittedY:l}}function Fi(t,e,r,o,n){let i=r.x+(t.x-e.x)/n,s=r.y+(t.y-e.y)/n,{fittedX:a,fittedY:c}=Pa(i,s,o,n);return{x:a,y:c}}function Pi(t,e){let r=t.current.offsetWidth*e,o=t.current.offsetHeight*e;return{horizontalOverflow:r>window.innerWidth,verticalOverflow:o>window.innerHeight}}function Ni(t,e){let r=B({horizontalOverflow:!1,verticalOverflow:!1});return H(()=>{r.current=Pi(t,e)},[t,r,e]),r}var gk=1;function Ap(t){return t.buttons===gk}function Op(t,e,r,o){let n=B(window),i=jo(),s=i?Vt.FF_DASH:Vt.DASH,a=i?Vt.FF_EQUALS:Vt.EQUALS;Yr(n,s,e,o),Yr(n,a,t,o),Yr(n,Vt.NUM_MINUS,e,o),Yr(n,Vt.NUM_PLUS,t,o),Yr(n,Vt.ESC,r,o)}function Fp(t,e){H(()=>{function r(o){o.deltaY>0?e():t()}return window.addEventListener("wheel",r),()=>{window.removeEventListener("wheel",r)}},[e,t])}function yk(t,e,r,o,n){let i=B({x:0,y:0}),s=B(o),a=ke(o),c=B({width:0,height:0}),l=ke(n),m=Ni(e,r);H(()=>{let u=null,g=null,b=null,N=()=>{sr([g,b])},I=y=>{let k=y,w=l.current,L=a.current,j={x:k.clientX,y:k.clientY};Ap(y)?(y.preventDefault(),L=Fi(j,i.current,s.current,c.current,r)):N(),w({x:m.current.horizontalOverflow?L.x:a.current.x,y:m.current.verticalOverflow?L.y:a.current.y})},R=y=>{let k=y,w=e.current.getBoundingClientRect();c.current={width:w.width,height:w.height},s.current=a.current,i.current={x:k.clientX,y:k.clientY},y.preventDefault(),b=lt(window,"mouseup",N),g=lt(window,"mousemove",I)};return(m.current.horizontalOverflow||m.current.verticalOverflow)&&(u=lt(e.current,"mousedown",R)),()=>{sr([u,g,b])}},[r,a,e,l,m])}function Pp(t,e,r,o,n,i,s,a){Fp(i,s),Op(i,s,a),yk(t,e,r,o,n)}function _k(t){let e={x:t[0].pageX,y:t[0].pageY},r={x:t[1].pageX,y:t[1].pageY};return[e,r]}function Na(t){if(t.length===2){let[e,r]=_k(t);return Math.sqrt(Math.pow(r.x-e.x,2)+Math.pow(r.y-e.y,2))}return 0}function Np(t,e,r,o,n){let i=B({startTouchPointsDist:0,startZoomScale:1,startDragPosition:{x:0,y:0},gesture:"none"}),s=Ni(t,e),a=B(o),c=ke(o),l=B(),m=ke(n),u=Z(k=>{i.current.gesture="pinch",i.current.startZoomScale=e,i.current.startTouchPointsDist=Na(k.touches)},[e]),g=Z(k=>{let L=Na(k.touches)/i.current.startTouchPointsDist,j=e*L;r(j)},[e,r]),b=Z(k=>{let w=t.current.getBoundingClientRect(),L=k.touches[0];l.current={width:w.width,height:w.height},i.current.startDragPosition={x:L.clientX,y:L.clientY},a.current=c.current,i.current.gesture="drag"},[c,t]),N=Z(k=>{let w=m.current,L=c.current,j=k.touches[0],ce={x:j.clientX,y:j.clientY};k.touches&&k.touches.length===1&&(L=Fi(ce,i.current.startDragPosition,a.current,l.current,e)),w({x:s.current.horizontalOverflow?L.x:c.current.x,y:s.current.verticalOverflow?L.y:c.current.y})},[c,e,m,s]),I=Z(k=>{k.cancelable&&k.preventDefault();let w=k;w.touches&&(w.touches.length===2&&i.current.gesture==="pinch"?g(w):w.touches.length===1&&i.current.gesture==="drag"&&(s.current.horizontalOverflow||s.current.verticalOverflow)&&N(w))},[N,g,s]),R=Z(()=>{i.current.gesture="none",window.removeEventListener("touchmove",I),window.removeEventListener("touchend",R)},[I]),y=Z(k=>{let w=k;w.touches&&(w.touches.length===2?u(w):w.touches.length===1&&b(w),window.addEventListener("touchmove",I,{passive:!1}),window.addEventListener("touchend",R))},[b,u,R,I]);H(()=>(window.addEventListener("touchstart",y),()=>{window.removeEventListener("touchstart",y)}),[y])}var to={preview:"x2385b__preview",imageContainer:{withMods:t=>__getCssClass("x2385b__image-container",t)},image:{withMods:t=>__getCssClass("x2385b__image",t)},zoomToolbar:{withMods:t=>__getCssClass("x2385b__zoom-toolbar",t)},centerButton:"x2385b__center-button",closeCross:"x2385b__close-cross"},$a=.5,Cr=6,_r=1;function Ck(){let[t,e]=Q(1);return{imageScale:t,setScale:s=>{s>=Cr?e(Cr):s<=_r?e(_r):e(s)},increaseScale:()=>{let s=t+$a;s<=Cr?e(s):e(Cr)},decreaseScale:()=>{let s=t-$a;s>=_r?e(s):e(_r)},resetScale:()=>{e(_r)}}}function kk(t,e){let[r,o]=Q(!0);return H(()=>{r?(t.current.style.bottom=vs("--tool-bar-bottom"),e.current.style.top=vs("--close-button-top")):(t.current.style.bottom=`-${t.current.offsetHeight}px`,e.current.style.top=`-${e.current.offsetHeight}px`)},[r,o,t,e]),{isToolsVisible:r,setUiVisibility:o}}function Sk(t,{style:e,onClose:r}){return eo(t,{component:C(Rp,{style:e==="dark"?"dark":"default",onClick:r},to.closeCross),tooltipText:x("Common.Close"),side:"bottom",align:"start"})}function xk(t,{style:e,icon:r,onClick:o,disabled:n}){return Me(t,{style:U(e,{light:"ghost",dark:"ghostInversed"}),size:"small",onClick:o,structure:"icon",icon:r,state:n?"disabled":"default"})}function La(t,e){return eo(t,{component:C(xk,e),tooltipText:e.tooltipText,show:!Ao()})}function bk(t,{style:e,increaseScale:r,decreaseScale:o,resetScale:n,scale:i,ref:s}){return de(s,"click",a=>a.preventDefault()),t`
<div
	save-ref=${s}
	class=${to.zoomToolbar.withMods({style:e})}
>
	${t(La,{style:e,icon:C(Ip),tooltipText:x("Common.ImageZoom.Tooltip.Decrease"),onClick:o,disabled:i==_r})}
	${t(La,{style:e,icon:C(Dp),tooltipText:x("Common.ImageZoom.Tooltip.ResetScale"),onClick:n,disabled:i==_r},to.centerButton)}
	${t(La,{style:e,icon:C(Mp),tooltipText:x("Common.ImageZoom.Tooltip.Increase"),onClick:r,disabled:i==Cr})}
</div>
`}function wk(t,{src:e,hasImageTransition:r,isTouchscreenDevice:o}){return t`
		<img
			class=${to.image.withMods({transition:r,touchscreen:o})}
			src=${e}
			alt=''
		/>`}function Lp(t,{style:e,imageSrc:r,imageCrop:o,closeZoomFn:n}){let[i,s]=Q(()=>({x:0,y:0})),[a,c]=Q(!1),l=Ck(),m=ne(),u=ne(),g=ne(),b=ne(),N=Ao(),{isToolsVisible:I,setUiVisibility:R}=kk(g,u),y=re=>{let xr=Pi(b,re),{fittedX:so,fittedY:ao}=Pa(i.x,i.y,{width:b.current.offsetWidth*re,height:b.current.offsetHeight*re},re);s({x:xr.horizontalOverflow?so:0,y:xr.verticalOverflow?ao:0})};function k(re){c(!1),l.setScale(re),y(re)}function w(){c(!0),l.increaseScale()}function L(){c(!0),l.decreaseScale(),y(l.imageScale-$a)}function j(){c(!0),l.resetScale(),s({x:0,y:0})}function ce(re){c(!1),s(re)}function He(){N&&R(!I)}function De(){!N||(I&&R(!1),l.imageScale>=Cr/2?j():(c(!0),l.setScale(Cr/2)))}de(g,"click",re=>re.preventDefault()),de(m,"click",re=>{re.defaultPrevented||(re.preventDefault(),n())}),Ep(b,De,He),Np(b,l.imageScale,k,i,ce),Pp(m,b,l.imageScale,i,ce,w,L,n),H(()=>{let re=Pi(b,l.imageScale),xr=re.horizontalOverflow||re.verticalOverflow,so=b.current.offsetWidth/2,ao=b.current.offsetHeight/2;b.current.style.cursor=xr?"move":"default",b.current.style.transformOrigin=`${so-i.x}px ${ao-i.y}px`,b.current.style.transform=`translate(${i.x}px, ${i.y}px) scale(${l.imageScale})`},[b,l.imageScale,i,s]),J(()=>{m.current.style.height=`${window.innerHeight}px`});let io={ref:b};return t`
<div
	class=${to.preview}
	save-ref=${m}
>
	<div class=${to.imageContainer.withMods({touchscreen:N})}
	>
		${t.renderIf(wk,()=>!o&&{src:r,hasImageTransition:a,isTouchscreenDevice:N},io)}
		${t.renderIf($t,()=>o&&{image:o,withSize:!0,containerRef:m},io)}
	</div>
	${t(bk,{style:e,increaseScale:w,decreaseScale:L,resetScale:j,scale:l.imageScale,ref:g})}
	${t(Sk,{style:e,onClose:n},{ref:u})}
</div>`}function $p(t,{style:e}){let r=vp({html:t,side:"center",component:Lp,closeOnOverlayClick:!0,modalOverlayType:e});return Z((o,n=void 0)=>r.open({imageSrc:o,imageCrop:n&&n.crop?{...n,crop:n.crop}:void 0,closeZoomFn:r.close,style:e}),[r,e])}var Ka={},Tk={},Oo=class extends Ai{constructor({block:e,contentRendererFn:r,direction:o}){super({block:e,contentRendererFn:r,direction:o}),this.updateModifier("hide-caption",!e.characters.length)}_renderCaption(e){let r=E.create({key:e.key,characters:e.characters});return ct(new Qe({paragraph:r,bemInfo:this.createChildBemInfo("caption"),blockBeforeType:null,idPrefix:"caption"}),()=>{},!0)}_getWrapperInlineStyles(){let e=this.getBlock();return e.type===f.IMAGE&&e.alignment==="inner"?{"max-width":`${e.width}px`,"max-height":`${e.height}px`}:null}_render(){let e=this.getBlock();return D(Tk,`:media-block-${e.key}`)`
<figure
	class=${this._getCssClasses()}
	style=${this._getInlineStyles()}
>
	<div class=${this._wrapperClassName} style=${this._getWrapperInlineStyles()}>
		${this._contentRendererFn(e,this._contentClassName,this._onContentSizeChange.bind(this))}
		<div class=${this._placeholderClassName} style=${this._getPlaceholderStyles()}></div>
	</div>
	<figcaption class="caption-wrapper">
		${this._renderCaption(e)}
	</figcaption>
</figure>`}};function Kp(t,e,r,o){let n;return Ka[e.key]?(n=Ka[e.key],n.setBlock(e),n.setDirection(o)):(n=new Oo({block:e,contentRendererFn:t,direction:o}),Ka[e.key]=n),n.updateModifier("after",r),n}var Ha={},vk={};function Ek(t,{imageBlock:e,className:r}){let o=$p(t,{style:"light"});return Pt(t,C($t,{image:e,withImageSelection:!0,className:r,onClick:()=>o(Lt(e.src),e)}))}function Bk(t,e){let r=d(Ma.toCollagedImageBlock(t));return D(vk,`:collaged-image-${r.key}`)`
			${ae(Ek)({imageBlock:r,className:e+" image-block"})}
		`}var Va=class extends Oo{constructor({block:e,contentRendererFn:r,direction:o}){super({block:e,contentRendererFn:r,direction:o}),this.updateModifier("hide-caption",!e.characters.length),this._grow=null,this._preventCollaging=!1}setGrow(e){this._grow=e}setPreventCollaging(e){this._preventCollaging=e,this.updateModifier("prevent-collaging",this._preventCollaging)}getGrow(){return this._grow}setBlock(e){super.setBlock(e);let r=Ma.toCollagedImageBlock(e);r&&(this.updateModifier("align",!1),this.updateModifier("blob",r.isBlob),this.updateModifier("collaged",!!r.parentCollageKey),this.updateModifier("prevent-collaging",this._preventCollaging))}_getInlineStyles(){return this._grow?{flex:`${this._grow} 0 0`}:null}_getPlaceholderStyles(){let e=this.getBlock();if(!e.width)return{width:"100%",height:`${e.height}px`};let{width:r,height:o}=Pe(e);return{"padding-bottom":`${(this.fixedRatio?this.fixedRatio:o/r)*100}%`}}_getWrapperInlineStyles(){let e=this.getBlock();if(this._preventCollaging){let{width:r}=Pe(e);return{"max-width":`${r}px`}}return null}};function Hp(t,e){let r;return Ha[t.key]?(r=Ha[t.key],r.setBlock(t),r.setDirection(e)):(r=new Va({block:t,contentRendererFn:Bk,direction:e}),Ha[t.key]=r),r}function Vp(t,e){let r=t.map(n=>{let i=Pe(n);return i.crop?i.width/i.height:n.width/n.height}),o=Math.min(...r);return e.forEach((n,i)=>{n.setGrow(r[i]/o)}),o}var Rk=740,Wa={},Dk={},Ik="collage-block",Ua=class extends O{constructor({block:e,direction:r}){super({blockName:Ik,direction:r}),this._block=e,this.updateModifier("align",this._block.alignment),this.updateModifier("dir",this._direction)}setBlock(e){this._block!==e&&(this._block=e,this.updateModifier("align",this._block.alignment),this._sheduleRender())}setDirection(e){this._direction!==e&&(super.setDirection(e),this.updateModifier("dir",this._direction),this._sheduleRender())}getBlock(){return this._block}_getInlineStyles(){if(this._block.images.length===1&&(document.body.clientWidth<=Rk||this._block.alignment==="float-left")){let{width:e}=Pe(this._block.images[0]);return{display:"block",width:`${e}px`}}return null}_renderImagesBlocks(e){let r=e.map(o=>{let n=Hp(o,this._direction);return n.setPreventCollaging(e.length===1&&this._block.alignment!=="float-left"),n});return Vp(e,r),r.map(o=>o._render())}_render(){let e=this.getBlock();return D(Dk,`:collage-block-${e.key}`)`
<figure
	class=${this._getCssClasses()}
	style=${this._getInlineStyles()}
>
	${this._renderImagesBlocks(e.images)}
</figure>`}};function Wp({block:t,blockBeforeType:e,direction:r}){let o;return Wa[t.key]?(o=Wa[t.key],o.setBlock(t),o.setDirection(r)):(o=new Ua({block:t,direction:r}),Wa[t.key]=o),o.updateModifier("after",e),o}var Mk={};function Up(t,e,r){let o=e+" embed-block",n=d(yi.toEmbedBlock(t));function i(s){let a=s.target;try{let c=d(a.contentWindow),l=new ResizeObserver(()=>{l.unobserve(c.document.body),r(c.document.body.clientHeight/c.document.body.clientWidth)});l.observe(c.document.body)}catch(c){}}return D(Mk,`:embed-${n.key}`)`
<iframe onload=${i} class=${o} src=${n.src} allowfullscreen loading="lazy">
</iframe>`}function zp({block:t,blockBeforeType:e,direction:r}){return Kp(Up,t,e,r)}var Fo="gotoNextQuestion";function Gp(t){t.on(Fo,(e,r)=>{let o=r.selectedQuestionIndex;if(o==r.questionsState.length-1){h.error("Goto next operation isn't  available for last question");return}r.selectedQuestionIndex=o+1})}var za="gotoPreviousQuestion";function Qp(t){t.on(za,(e,r)=>{let o=r.selectedQuestionIndex;if(o==0){h.error("Goto previous operation isn't  available for first question");return}r.selectedQuestionIndex=o-1})}var Ga="restartExercise";function Yp(t){t.on(Ga,(e,r)=>{let o=r.exercise.settings.shuffleAnswers;r.questionsState=r.questionsState.map(n=>Si.create(n.question,o)),r.selectedQuestionIndex=0})}var Qa="setTypeInAnswer";function qp(t){t.on(Qa,(e,r)=>{let o=d(Re.selectedQuestionState(r)),n=Ye(o);if(!n){h.error(`For question with type: ${o.question.type} not available 'Set type in answer' action`);return}n.contentState.answer=e})}var Ya="submit";function Xp(t){t.on(Ya,(e,r)=>{let o=d(Re.selectedQuestionState(r));o.answered=!0})}var Po="setChoiceCorrect";function jp(t){t.on(Po,(e,r)=>{let o=d(Re.selectedQuestionState(r)),n=o.question.type,i=pt(o);if(!i){h.error(`For question with type: ${n} not available 'Set choice correct' action`);return}i.contentState.choicesState.forEach(a=>{n=="mc"?a.selected=a.choice.key==e:a.choice.key==e&&(a.selected=!a.selected)})})}function Ak(t,e){e.forEach(r=>r(t))}function Zp(t){let e=(n,i="")=>{let s=r.get(n);s?t(a=>s(i,a)):h.warn(`Unknown action: ${n}`)},r=new Map;return Ak({on:(n,i)=>{r.set(n,i)}},[Qp,Gp,Xp,qp,jp,Yp]),{dispatch:e}}var{getCssClass:Ok}=he`/src/roll/components/richtext/renderer/exercise/NavigationButton.css`;function qa(t,e){let r={hidden:!e.visible};return t`
<div
	class=${Ok("button",r,e.className)}
	onclick=${e.onClick}
></div>`}function Jp(t,{text:e,autotestData:r}){return t`
<div data-at=${ee(r)}>
	${e}
</div>`}function ef(t){let[e,r]=Q(!1);return H(()=>{let o=t.current,n=null,i=lt(o,"mousedown",()=>{n=lt(window,"mouseup",()=>{r(!1),rt(n)}),r(!0)});return()=>sr([n,i])},[t]),e}function tf(t){let[e,r]=Q(!1);return H(()=>{let o=t.current,n=[lt(o,"mouseover",()=>r(!0)),lt(o,"mouseout",()=>r(!1))];return()=>sr(n)},[t]),e}function rf(t,e){let r=B(),o=tf(r),n=ef(r);function i(l){e.onclick&&(l.preventDefault(),e.onclick())}let{getCssClass:s}=e,a={...e.mods,over:o,down:n},c=e.focusable===!1?-1:void 0;return t`
<button
	save-ref=${r}
	disabled=${e.disabled}
	class=${`${s("button",a,e.className)}`}
	onmouseover=${e.onmouseover}
	onmouseout=${e.onmouseout}
	tabindex=${c}
	onclick=${i}
	onkeydown=${e.onkeydown}
	onmousedown=${e.onmousedown}
	data-at=${ee(e.autotestData)}
>
	${e.text||""}
</button>`}function ro(t){let e=Rt(t);if(!e)throw new Error("OrderedMap is empty");let r=K(e);if(!r)throw new Error("First block is not paragraph");return r}function Fk(t){let e=(s,a)=>(a?s:s.toLowerCase()).trim(),r=t.contentState,o=r.typeIn,n=o.caseSensitive,i=e(r.answer,n);for(let s of o.answers)if(i==e(s.text,n))return!0;return!1}function Pk(t){for(let e of t.contentState.choicesState)if(e.selected!=e.choice.correct)return!1;return!0}function of(t){let e=Ye(t);if(e)return Fk(e);let r=pt(t);return r?Pk(r):(h.error(`Unknown question type: ${t.question.type}`),!1)}function nf(t){return t.type=="mc"?t:null}function sf(t){return nf(t.question)?t:null}function af(t){return t.type=="mr"?t:null}function cf(t){return af(t.question)?t:null}function lf(t){let e=pt(t);if(e)return!!e.contentState.choicesState.find(n=>n.selected);let r=Ye(t);return r?!!r.contentState.answer:(h.error(`Unknown question type: ${t.question.type}`),!1)}var{getCssClass:Xa}=he`/src/roll/components/richtext/renderer/exercise/question/AttachmentRenderer.css`;function Nk(t){switch(t.type){case"i":return C(Lk,t);case"e":return C($k,t);default:throw F(t.type),new Error("Unknown attachment type")}}function Lk(t,e){let r=Fe(()=>Pe(e),[e]),o=r.height/r.width;return t`
<div class=${Xa("image")} style=${`max-width: ${r.width}px`}>
	<div style=${`padding-bottom: ${o*100}%`}>
		${t($t,{image:e})}
	</div>
</div>
`}function $k(t,e){return t`
<iframe
	class=${Xa("embed-attachment")}
	src=${e.src}
></iframe>`}function df(t,e){let r=e.attachment;return t`
<div
	class=${Xa("attachment")}
>
	${t.switch(()=>Nk(r))}
</div>`}var Kk={tooltipLink:"x1059a__tooltip-link"};function Hk(t){let e={},r=[];return z.hasStyle(t,"bold")&&(e["font-weight"]="bold"),z.hasStyle(t,"italic")&&(e["font-style"]="italic"),z.hasStyle(t,"underline")&&r.push("underline"),z.hasStyle(t,"strikethrough")&&r.push("line-through"),r.length&&(e["text-decoration"]=r.join(" ")),e}function Vk(t,{style:e,text:r}){return t`<span style=${e}>${r}</span>`}function Wk(t,{style:e,text:r,url:o,urlTooltipEnabled:n}){let i=ne();return st({html:t,elementRef:i,text:{html:`<a href=${o} class=${Kk.tooltipLink} target="_blank">${o}</a>`},size:"small",show:n,side:"bottom",stayOnHover:!0}),t`<a href='${o}' save-ref=${i} target=_blank><span style=${e}>${r}</span></a>`}function Uk(t,e,r){let o=Hk(t.styles),n=t.styles.url,i=t.text;t.isLast&&i.endsWith(`
`)&&(i+=Ge.ZERO_WIDTH_SPACE);let s=e.generate(`chunk_${t.text}${n?"_url":"_text"}`);return n?nr(s,Wk,{style:o,text:i,url:n,urlTooltipEnabled:r}):nr(s,Vk,{style:o,text:i})}function zk(t,e,r){e.length||e.push({text:Ge.ZERO_WIDTH_SPACE,styles:z.create(),isLast:!0});let o=new zr;return t.renderAll(e,n=>Uk(n,o,r))}function mf(t,{paragraph:e,placeholder:r="",className:o,autotestData:n,urlTooltipEnabled:i}){let s=E.getTextRuns(e),a=s.length?"":r,c=o&&a?o.split(" ").map(l=>`${l} ${l}_empty`).join(" "):o;return t`<p
	class=${c}
	data-key=${e.key}
	data-placeholder=${a}
	data-at=${ee(n)}
>${zk(t,s,i)}</p>`}var Yt={content:"x91b27__content",header:"x91b27__header",subheader:"x91b27__subheader",text:"x91b27__text",defaultParagraph:"x91b27__default-paragraph",exerciseParagraph:"x91b27__exercise-paragraph"};var U6={content:Yt.content,header:Yt.header,subheader:Yt.subheader,text:Yt.text,ul:Yt.text,ol:Yt.text},z6=Yt.defaultParagraph,uf=Yt.exerciseParagraph;function qt(t,e){return mf(t,{...e,className:Oe(uf,e.className),urlTooltipEnabled:!1})}var qe={NONE:"none",SELECTED:"selected",CORRECT:"correct",INCORRECT:"incorrect"};function Li(t,e,r){let o=t.selected,n=t.choice;return e&&r?n.correct?qe.CORRECT:qe.INCORRECT:o?qe.SELECTED:qe.NONE}function pf(t,e){return t`
<svg
	class=${e.className}
	viewBox="0 0 6 6" 
	xmlns="http://www.w3.org/2000/svg"
>
	<circle cx="828" cy="556" r="3" transform="translate(-825 -553)" fill="none"/>
</svg>`}function ff(t,e){return t`
<svg
	class=${e.className} 
	viewBox="0 0 12 10" 
	xmlns="http://www.w3.org/2000/svg"
>
	<path d="M10.135.32a1.09 1.09 0 0 1 1.548 1.538L4.405 9.182.317 5.072a1.09 1.09 0 0 1 1.547-1.538l2.54 2.553L10.135.32z" fill="none"/>
</svg>`}function Xt(t,e){return t`
<svg
	class=${e.className}  
	viewBox="0 0 12 10" 
	xmlns="http://www.w3.org/2000/svg"
>
	<path d="M10.135.32a1.09 1.09 0 0 1 1.548 1.538L4.405 9.182.317 5.072a1.09 1.09 0 0 1 1.547-1.538l2.54 2.553L10.135.32z" fill="none"/>
</svg>`}function jt(t,e){return t`
<svg
	class=${e.className} 
	viewBox="0 0 10 10" 
	xmlns="http://www.w3.org/2000/svg"
>
	<path d="M5 3.571L7.857.714a1.01 1.01 0 0 1 1.429 1.429L6.429 5l2.857 2.857a1.01 1.01 0 0 1-1.429 1.428L5 6.428 2.143 9.285A1.01 1.01 0 0 1 .714 7.857L3.571 5 .714 2.142A1.01 1.01 0 0 1 2.143.714L5 3.57z" fill="#42484E"/>
</svg>
`}var{getCssClass:kr}=he`/src/roll/components/richtext/renderer/exercise/question/content/multiplechoice/MultipleChoicesRenderer.css`;function Gk(t){switch(t){case qe.SELECTED:return C(pf,{className:kr("radio")});case qe.CORRECT:return C(Xt,{className:kr("correct")});case qe.INCORRECT:return C(jt,{className:kr("incorrect")});default:return null}}function Qk(t,e){return t`
<input type="radio" name="radio"/>
<span class=${kr("control",{},e.getCssClass("control"))}>
	${t.switch(()=>Gk(e.status))}
</span>`}function Yk(t,e){let r=it(Tt),o=e.answered,n=e.state.selected,i=Li(e.state,o,e.showCorrectAnswers),s={selected:n,status:i},a=ro(e.state.choice.content.blockMap);function c(l){let m=l.target,u=d(m.parentElement);if(m.tagName!=Nt.A&&u.tagName!=Nt.A){l.preventDefault();let g=e.state.choice.key;r(Po,g)}}return t`
<label
	class=${kr("choice",s,e.getCssClass("choice"))}
	onclick=${!o&&c}
	disabled=${o?!0:null}
>
	${t(Qk,{status:i,getCssClass:e.getCssClass})}
	${t(qt,{className:kr("text"),paragraph:a})}
</label>`}function hf(t,e){let r={answered:e.answered,dir:e.direction};return t`
<div
	class=${kr("choices",r)}
>
	${t.renderAll(e.state.choicesState,o=>nr(o.choice.key,Yk,{getCssClass:e.getCssClass,state:o,answered:e.answered,showCorrectAnswers:e.showCorrectAnswers}))}
</div>`}var{getCssClass:Sr}=he`/src/roll/components/richtext/renderer/exercise/question/content/multipleresponse/MultipleResponsesRenderer.css`;function qk(t){switch(t){case qe.SELECTED:return C(ff,{className:Sr("checkbox")});case qe.CORRECT:return C(Xt,{className:Sr("correct")});case qe.INCORRECT:return C(jt,{className:Sr("incorrect")});default:return null}}function Xk(t,e){return t`
<input type="checkbox" />
<span class=${Sr("control",{},e.getCssClass("control"))}>
	${t.switch(()=>qk(e.status))}
</span>`}function jk(t,e){let r=it(Tt),o=e.answered,n=e.state.selected,i=Li(e.state,o,e.showCorrectAnswers),s={selected:n,status:i},a=ro(e.state.choice.content.blockMap);function c(l){let m=l.target,u=d(m.parentElement);if(m.tagName!=Nt.A&&u.tagName!=Nt.A){l.preventDefault();let g=e.state.choice.key;r(Po,g)}}return t`
<label
	class=${Sr("choice",s,e.getCssClass("choice"))}
	onclick=${!o&&c}
	disabled=${o?!0:null}
>
	${t(Xk,{getCssClass:e.getCssClass,status:i})}
	${t(qt,{className:Sr("text"),paragraph:a})}
</label>`}function gf(t,e){let r={answered:e.answered,dir:e.direction};return t`
<div
	class=${Sr("choices",r)}
>
	${t.renderAll(e.state.choicesState,o=>nr(o.choice.key,jk,{getCssClass:e.getCssClass,state:o,answered:e.answered,showCorrectAnswers:e.showCorrectAnswers}))}
</div>`}var{getCssClass:No}=he`/src/roll/components/richtext/renderer/exercise/question/content/typein/TypeInRenderer.css`;function Zk(t,e){let r=e.answers.map(o=>o.text);return t`
<p class=${No("responses")}>
	${x("Roll.Exercise.Player.Content.TypeIn.AcceptableResponses")}: ${r.join(", ")}
</p>`}function yf(t,e){let r=it(Tt),o=e.answered,n=e.state,i=n.typeIn,s=i.caseSensitive,a=n.answer;function c(g){return s?g.text==a:g.text.toUpperCase()==a.toUpperCase()}let l=!!i.answers.find(c),m={correct:o&&l,incorrect:o&&!l};function u(g){let b=g.target;r(Qa,b.value)}return t`
<div
	class=${No("type-in",m,e.getCssClass("type-in"))}
>
	${t.renderIf(Xt,()=>o&&l&&{className:No("correct")})}
	${t.renderIf(jt,()=>o&&!l&&{className:No("incorrect")})}
	<input
		class=${No("answer")}
		value=${n.answer}
		placeholder=${x("Roll.Exercise.Player.Content.TypeIn.Placeholder")}
		oninput=${u}
		readonly=${o?"":void 0}
	/>
	${t.renderIf(Zk,()=>o&&e.showCorrectAnswers&&{answers:i.answers})}
</div>`}var{getCssClass:$i}=he`/src/roll/components/richtext/renderer/exercise/question/FeedbackRenderer.css`;function Jk(t){return t?C(Xt,{className:""}):C(jt,{className:""})}function _f(t,e){let r=e.correctAnswered,o=Wt.getFeedbackText(e.feedback,r),n=!E.isEmptyParagraph(o),i={"with-text":n,dir:e.direction},s={correct:r,incorrect:!r},a=r?x("Roll.Exercise.Player.Status.Correct"):x("Roll.Exercise.Player.Status.Incorrect");return t`
<div class=${$i("feedback-container",i,e.getCssClass("feedback-container"))}>
	<div class=${$i("status-icon",s,e.getCssClass("status-icon"))}>
		${t.switch(()=>Jk(r))}
	</div>
	<div class=${$i("status-label",{},e.getCssClass("status-label"))}>
		${a}
	</div>
	${t.renderIf(qt,()=>n&&{className:Oe($i("text"),e.getCssClass("feedback-text")),paragraph:o})}
</div>
`}var{getCssClass:tt}=he`/src/roll/components/richtext/renderer/exercise/question/QuestionRenderer.css`;function eS({questionState:t,showCorrectAnswers:e,direction:r}){let o=sf(t);if(o)return C(hf,{getCssClass:tt,state:o.contentState,answered:t.answered,showCorrectAnswers:e,direction:r});let n=cf(t);if(n)return C(gf,{getCssClass:tt,state:n.contentState,answered:t.answered,showCorrectAnswers:e,direction:r});let i=Ye(t);return i?C(yf,{getCssClass:tt,state:i.contentState,answered:t.answered,showCorrectAnswers:e}):(h.error(`Unknown question type: ${t.question.type}`),null)}function Cf(t,e){let{questionNumber:r,showCorrectAnswers:o,animationEnabled:n}=e,i=d(e.questionState),s=i.question,a=s.feedback,c=ro(s.description.blockMap),l=it(Tt),m=it(ja),u=it(Za),g=i.answered,b=of(i),N={questionState:i,showCorrectAnswers:o,direction:e.direction},I={dir:e.direction};if(g&&n){I["with-animations"]=!0,o&&(I["show-correct-answers"]=!0);let y=Wt.getFeedbackText(a,b);E.isEmptyParagraph(y)||(I["with-feedback"]=!0)}let R="xLarge";return t`
<div class=${tt("question",I)}>
	${t.renderIf(Jp,()=>!!r&&{text:r},tt("question-number"))}
	${t(qt,{className:tt("description"),paragraph:c})}
	${t.renderIf(df,()=>s.attachment&&{attachment:s.attachment})}
	${t.switch(()=>eS(N))}
	${t.renderIf(Me,()=>!g&&{style:"primary",structure:"text",text:x("Roll.Exercise.Player.Button.Submit"),state:lf(i)?"default":"disabled",onClick:()=>{m(!0),u("bottom"),l(Ya)},size:R},tt("submit-button"))}
	${t.renderIf(_f,()=>g&&{getCssClass:tt,correctAnswered:b,feedback:a,direction:e.direction})}
	${t.renderIf(Me,()=>g&&e.nextQuestionAvailable&&{style:"primary",structure:"text",text:x("Roll.Exercise.Player.Button.Next"),onClick:()=>{m(!1),u("top"),l(Fo)},size:R},tt("next-button"))}
	${t.renderIf(rf,()=>e.restartAvailable&&{getCssClass:tt,className:tt("restart-button"),text:x("Roll.Exercise.Player.Button.RestartExercise"),onclick:()=>{m(!1),u("top"),l(Ga)}})}
</div>`}var{getCssClass:Ja}=he`/src/roll/components/richtext/renderer/exercise/ExerciseBlockRenderer.css`,Tt=vn(()=>{}),ja=vn(()=>{}),Za=vn(()=>{});function kf(t,e){let r=e.state,o=e.dispatch,n=e.scrollToElementFn,[i,s]=Q(!1),[a,c]=Q("none"),l=r.selectedQuestionIndex,m=r.questionsState.length,u=l+1!=m,g=!!r.questionsState.find(y=>!y.answered),b;if(m>1){let y=String((l==null?-1:l)+1).padStart(2,"0"),k=String(m).padStart(2,"0");b=`${y}/${k}`}let N=Re.selectedQuestionState(r),I={[e.mode]:!0,dir:e.direction},R=B();return H(()=>{a!="none"&&(n(R.current,a),c("none"))},[a,n]),t.setContext(Tt,o).setContext(ja,s).setContext(Za,c)`
<div
	class=${Ja("exercise",I)}
	contenteditable="false"
	save-ref=${R}
>
	${t(qa,{className:Ja("prev-button"),visible:Re.previousQuestionAvailable(r),onClick:()=>{s(!1),c("top"),o(za)}})}
	${t.renderIf(Cf,()=>!!N&&{questionNumber:b,questionState:N,showCorrectAnswers:r.exercise.settings.showCorrectAnswers,nextQuestionAvailable:u,restartAvailable:!g&&!u,animationEnabled:i,direction:e.direction})}
	${t(qa,{className:Ja("next-button"),visible:Re.nextQuestionAvailable(r),onClick:()=>{s(!1),c("top"),o(Fo)}})}
</div>`}var tS="exercise-block",rS="wrapper",ec={},oS={},tc=class extends O{constructor(e,r,o){super({blockName:tS}),this._relatedObject={},this._state=e;let{dispatch:n}=Zp(r);this._dispatch=n,this._scrollToElementFn=o,this._exerciseElement=null}setState(e){this._state!=e&&(this._exerciseElement=null,this._state=e,this._sheduleRender())}_render(){this._exerciseElement||od(kf,n=>{this._exerciseElement=n},this._relatedObject)({state:this._state,dispatch:this._dispatch,mode:"player",scrollToElementFn:this._scrollToElementFn,direction:Ve()});let e=Y([this.createChildBemInfo(rS)]);return Ct(oS,`:exercise-block-${this._state.exercise.key}`)`
<figure class=${this._getCssClasses()}>
	<div class=${e}>
		${this._exerciseElement}
	</div>
</figure>`}};function Sf({state:t,updateStateFn:e,blockBeforeType:r,scrollToElementFn:o}){let n=t.exercise.key,i;return ec[n]?(i=ec[n],i.setState(t)):(i=new tc(t,e,o),ec[n]=i),i.updateModifier("after",r),i}function xf(){let t=d(window.getSelection());return t.type==="None"?null:t.rangeCount>0?d(t.getRangeAt(0)):null}var rc={},nS={},oc=class extends ri{constructor({block:e,onHyperlinkOverFn:r}){super({block:e,onHyperlinkOverFn:r,readonlyMode:!0,isLock:!1}),this._addSignal(this._cardsListRenderer.onCardClickSignal,o=>{let n=xf();if(n&&n.startOffset!==n.endOffset)return;let i=this._cardsListRenderer.getCardRendererByKey(o);if(i){let s=i.activeSide()==="front"?"back":"front";i.setActiveSide(s)}})}_render(){let e=this._block;return D(nS,`:flip-cards-block-${e.key}`)`
<figure
	class=${this._getCssClasses()}
	style=${this._getCssStyles()}
	contenteditable="false"
	draggable="false"
>
	${this._cardsListRenderer.domElement()}
</figure>`}};function bf({block:t,blockBeforeType:e,onHyperlinkOverFn:r}){let o;return rc[t.key]?(o=rc[t.key],o.setBlock(t)):(o=new oc({block:t,onHyperlinkOverFn:r}),rc[t.key]=o),o.updateModifier("after",e),o}function wf(t){return t`
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M23 12c0 6.075-4.925 11-11 11S1 18.075 1 12 5.925 1 12 1s11 4.925 11 11zm-9.68-4.98a1.62 1.62 0 1 1-3.24 0 1.62 1.62 0 0 1 3.24 0zM9.5 10.8a1 1 0 0 1 1-1h1.8a1 1 0 0 1 1 1v5h1.2v2h-4.4v-2h1.2v-4h-.8a1 1 0 0 1-1-1z" fill="currentColor"/></svg>
`}function Tf(t){return t`
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M23 12c0 6.075-4.925 11-11 11S1 18.075 1 12 5.925 1 12 1s11 4.925 11 11zM7 11a1 1 0 1 0 0 2h10a1 1 0 1 0 0-2H7z" fill="currentColor"/></svg>
`}function vf(t){return t`
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M23 12c0 6.075-4.925 11-11 11S1 18.075 1 12 5.925 1 12 1s11 4.925 11 11zM13 7a1 1 0 1 0-2 0v4H7a1 1 0 1 0 0 2h4v4a1 1 0 1 0 2 0v-4h4a1 1 0 1 0 0-2h-4V7z" fill="currentColor"/></svg>
`}function Ef(t){return t`
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M23 12c0 6.075-4.925 11-11 11S1 18.075 1 12 5.925 1 12 1s11 4.925 11 11zM9.998 8.834v-.009a1 1 0 0 1-2-.007c0-.351.117-.726.266-1.048.158-.343.394-.714.713-1.057.649-.7 1.654-1.295 3.021-1.295 2.64 0 4 1.876 4 3.4V9.563a3.24 3.24 0 0 1-2.604 3.176.493.493 0 0 0-.396.483v.576a1 1 0 1 1-2 0v-.576c0-1.188.839-2.211 2.004-2.444a1.24 1.24 0 0 0 .996-1.215V8.818c0-.392-.437-1.4-2-1.4-.734 0-1.23.304-1.555.655a2.104 2.104 0 0 0-.364.537c-.055.119-.073.193-.079.216a.033.033 0 0 1-.002.008zM12 16.02a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5z" fill="currentColor"/></svg>
`}function Bf(t){return t`
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M23 12c0 6.075-4.925 11-11 11S1 18.075 1 12 5.925 1 12 1s11 4.925 11 11zm-5.74-2.35a1 1 0 0 0-1.52-1.3l-5.296 6.18-2.737-2.737a1 1 0 0 0-1.414 1.414l3.5 3.5a1 1 0 0 0 1.466-.056l6-7z" fill="currentColor" opacity=".9"/></svg>
`}function Rf(t){return t`
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.25 5.32A2.4 2.4 0 0 0 1 7.425v9.151a2.4 2.4 0 0 0 1.25 2.107l8.6 4.69a2.4 2.4 0 0 0 2.299 0l8.6-4.69a2.4 2.4 0 0 0 1.25-2.107v-9.15a2.4 2.4 0 0 0-1.25-2.108l-8.6-4.69a2.4 2.4 0 0 0-2.299 0l-8.6 4.69zm6.857 2.372a1 1 0 0 0-1.414 1.414L10.586 12l-2.893 2.893a1 1 0 1 0 1.414 1.414L12 13.413l2.893 2.893a1 1 0 0 0 1.414-1.414L13.414 12l2.893-2.893a1 1 0 1 0-1.414-1.414L12 10.585 9.107 7.692z" fill="currentColor"/></svg>
`}function Df(t){return t`
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M14.612 4.62c-1.149-2.031-4.075-2.031-5.224 0L1.53 18.525C.4 20.524 1.844 23 4.142 23h15.716c2.297 0 3.742-2.476 2.612-4.476L14.612 4.62zM12 8.5a1 1 0 0 1 1 1v5a1 1 0 0 1-2 0v-5a1 1 0 0 1 1-1zm1.5 9.8a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z" fill="currentColor"/></svg>
`}function nc(t){switch(t){case"incorrect":case"minus":return gd;case"correct":case"plus":return _d;case"info":return"var(--roll-player-accent-color)";case"question":return Cd;case"warning":return yd;default:throw F(t,`Unknown note type: ${t}`),new Error(`Unknown note type: ${t}`)}}var iS="note-block",sS={};function aS(t){switch(t){case"correct":return C(Bf);case"incorrect":return C(Rf);case"info":return C(wf);case"minus":return C(Tf);case"plus":return C(vf);case"question":return C(Ef);case"warning":return C(Df);default:F(t,`Unknown note type: ${t}`)}}function cS(t,{className:e,noteType:r}){let o=aS(r),n=nc(r);return t`
<div
	class=${e}
	style=${{color:n}}
>
	${t(o)}
</div>`}var Ki=class extends O{constructor({block:e,onHyperlinkOverFn:r,readonlyMode:o,isLock:n}){super({blockName:iS}),this._block=e,this._readonlyMode=o,this._isLock=n,this._onHyperlinkOverFn=r}setBlock(e){this._block=e,this._sheduleRender()}setReadonlyMode(e){this._readonlyMode=e}setLockMode(e){this._isLock!==e&&(this._isLock=e,this._invalidateModifiers())}_invalidateModifiers(){this.updateModifier("lock",this._isLock)}_getNoteBackgroundColor(){return nc(this._block.noteType)}_getBackgroundInlineStyles(){return{background:this._getNoteBackgroundColor()}}_renderParagraph(e){let r=E.create({key:e.key,characters:e.characters}),o=ct(new Qe({paragraph:r,blockBeforeType:null,idPrefix:"note-text",placeholder:x("Roll.Note.Placeholder")}),this._onHyperlinkOverFn,this._readonlyMode,this._isLock);return o.classList.add("note-text"),o}_renderDndIcon(e){return this._readonlyMode?null:ae(pp)({className:"dnd-icon"},this._renderFunctionEx(`dnd-icon-${e.key}`))}_render(){let e=this._block;return D(sS,`:note-block-${this._block.key}`)`
<figure
	class=${this._getCssClasses()}
	contenteditable="false"
	data-key="${e.key}"
	tabindex="-1"
>
	<div
		draggable=${!this._readonlyMode&&!this._isLock}
		class="note-background"
		style=${this._getBackgroundInlineStyles()}
	></div>
	<div class="note-block-content">
		${this._renderDndIcon(e)}
		${ae(cS)({className:"note-icon",noteType:e.noteType},this._renderFunctionEx(`note-icon-${e.key}`))}
		<div
			 class="note-text-wrapper"
			 contenteditable="false"
		>
			<div contenteditable=${!this._readonlyMode&&!this._isLock}>
				${this._renderParagraph(e)}
			</div>
		</div>
	</div>
</figure>`}};var ic={};function If({block:t,blockBeforeType:e,onHyperlinkOverFn:r}){let o;return ic[t.key]?o=ic[t.key]:(o=new Ki({block:t,onHyperlinkOverFn:r,readonlyMode:!0,isLock:!1}),ic[t.key]=o),o.updateModifier("after",e),o}var A=class{static _changeCellColor(e,r,o){let n={name:"backgroundColor",color:r};if(p.addCellMeta(e,n),r!==Ee){let i={name:"backgroundOpacity",opacity:o};p.addCellMeta(e,i)}}static _applyForEachCell(e,r){for(let o of e.rowsOrder)for(let n of e.colsOrder){let i=p.getCell(e,o,n);r(i)}}static _applyForEachRowCell(e,r,o){e.colsOrder.forEach(n=>{let i=p.getCell(e,r,n);o(i)})}static _applyForEachColumnCell(e,r,o){e.rowsOrder.forEach(n=>{let i=p.getCell(e,n,r);o(i)})}static _getCellParagraphStyles(e,r,o){let n=p.getCell(e,r,o),i=K(n.content);if(!(i!=null&&i.characters.length)){let s=We(n.meta,"charactersMeta");return(s==null?void 0:s.name)==="charactersMeta"?s.data.style:[]}return i.characters[0].meta.style}static _getCellTextAlignment(e,r,o){let n=p.getCell(e,r,o),i=d(K(n.content));return{vertical:n.verticalTextAlign,horizontal:i.textAlign}}static _getCellKey(e,r,o){return p.getCell(e,r,o).key}static getFirstRowKey(e){return e.rowsOrder[0]}static getLastRowKey(e){return e.rowsOrder[e.rowsOrder.length-1]}static getPreviousRowKey(e,r){let o=e.rowsOrder.indexOf(r);return o===0?null:e.rowsOrder[o-1]}static getNextRowKey(e,r){let o=e.rowsOrder.indexOf(r);return o===e.rowsOrder.length-1?null:e.rowsOrder[o+1]}static getFirstColumnKey(e){return e.colsOrder[0]}static getLastColumnKey(e){return e.colsOrder[e.colsOrder.length-1]}static getPreviousColumnKey(e,r){let o=e.colsOrder.indexOf(r);return o===0?null:e.colsOrder[o-1]}static getNextColumnKey(e,r){let o=e.colsOrder.indexOf(r);return o===e.colsOrder.length-1?null:e.colsOrder[o+1]}static getCellTextLength(e,r,o){let n=p.getCell(e,r,o);return qn(n.content)}static getCellBelow(e,r,o){let n=A.getNextRowKey(e,r);return n?p.getCell(e,n,o):null}static getCellAbove(e,r,o){let n=A.getPreviousRowKey(e,r);return n?p.getCell(e,n,o):null}static getTableTextStyles(e){let r=A.getFirstRowKey(e),o=A.getFirstColumnKey(e);return A._getCellParagraphStyles(e,r,o)}static getTableTextAlignment(e){let r=A.getFirstRowKey(e),o=A.getFirstColumnKey(e);return A._getCellTextAlignment(e,r,o)}static getTableRowTextAlignment(e,r){let o=A.getFirstColumnKey(e);return A._getCellTextAlignment(e,r,o)}static getTableRowTextStyles(e,r){let o=A.getFirstColumnKey(e);return A._getCellParagraphStyles(e,r,o)}static getTableColumnTextAlignment(e,r){let o=A.getFirstRowKey(e);return A._getCellTextAlignment(e,o,r)}static getTableColumnTextStyles(e,r){let o=A.getFirstRowKey(e);return A._getCellParagraphStyles(e,o,r)}static updateTableAlign(e,r,o){let n=d(p.toTableBlock(e.blockMap.blocks[r]));return n.alignment=o,{selection:_.createTableBlockSelection(r)}}static addLastTableRow(e,r){let o=d(p.toTableBlock(e.blockMap.blocks[r]));return p.addLastRow(o),{selection:_.createTableBlockSelection(r)}}static addTableRowBefore(e,r,o){let n=d(p.toTableBlock(e.blockMap.blocks[r])),i=p.addRowBefore(n,o),s=A.getFirstColumnKey(n),a=A._getCellKey(n,i,s);return{selection:{..._.createTableBlockSelection(r),customSelection:se.createCellSelection({rowKey:i,colKey:s,cellKey:a})}}}static addTableRowAfter(e,r,o){let n=d(p.toTableBlock(e.blockMap.blocks[r])),i=p.addRowAfter(n,o),s=A.getFirstColumnKey(n),a=A._getCellKey(n,i,s);return{selection:{..._.createTableBlockSelection(r),customSelection:se.createCellSelection({rowKey:i,colKey:s,cellKey:a})}}}static removeTableRow(e,r,o){let n=d(p.toTableBlock(e.blockMap.blocks[r])),i=A.getNextRowKey(n,o);return p.removeRow(n,o),n.rowsOrder.length?(i||(i=A.getLastRowKey(n)),{selection:_.createTableRowSelection(r,i)}):xo(e,r,E.create())}static addLastTableColumn(e,r){let o=d(p.toTableBlock(e.blockMap.blocks[r]));return p.addLastColumn(o),{selection:_.createTableBlockSelection(r)}}static addTableColumnBefore(e,r,o){let n=d(p.toTableBlock(e.blockMap.blocks[r])),i=p.addColumnBefore(n,o),s=A.getFirstRowKey(n),a=A._getCellKey(n,s,i);return{selection:{..._.createTableBlockSelection(r),customSelection:se.createCellSelection({rowKey:s,colKey:i,cellKey:a})}}}static addTableColumnAfter(e,r,o){let n=d(p.toTableBlock(e.blockMap.blocks[r])),i=p.addColumnAfter(n,o),s=A.getFirstRowKey(n),a=A._getCellKey(n,s,i);return{selection:{..._.createTableBlockSelection(r),customSelection:se.createCellSelection({rowKey:s,colKey:i,cellKey:a})}}}static moveRowUp(e,r,o){let n=d(p.toTableBlock(e.blockMap.blocks[r]));return p.moveRowUp(n,o),{selection:_.createTableRowSelection(r,o)}}static moveRowDown(e,r,o){let n=d(p.toTableBlock(e.blockMap.blocks[r]));return p.moveRowDown(n,o),{selection:_.createTableRowSelection(r,o)}}static moveColumnLeft(e,r,o){let n=d(p.toTableBlock(e.blockMap.blocks[r]));return p.moveColumnLeft(n,o),{selection:_.createTableColumnSelection(r,o)}}static moveColumnRight(e,r,o){let n=d(p.toTableBlock(e.blockMap.blocks[r]));return p.moveColumnRight(n,o),{selection:_.createTableColumnSelection(r,o)}}static pinHeaderColumn(e,r){let o=d(p.toTableBlock(e.blockMap.blocks[r]));return p.addTableMeta(o,{name:"isHeaderColumnPinned"}),{selection:_.createTableColumnSelection(r,A.getFirstColumnKey(o))}}static unpinHeaderColumn(e,r){let o=d(p.toTableBlock(e.blockMap.blocks[r]));return p.removeTableMeta(o,"isHeaderColumnPinned"),{selection:_.createTableColumnSelection(r,A.getFirstColumnKey(o))}}static changeTableRowColor(e,r,o,{color:n,opacity:i}){let s=d(p.toTableBlock(e.blockMap.blocks[r]));return A._applyForEachRowCell(s,o,a=>{A._changeCellColor(a,n,i)}),{selection:{..._.createTableBlockSelection(r),customSelection:se.createRowSelection({rowKey:o})}}}static changeTableColumnColor(e,r,o,{color:n,opacity:i}){let s=d(p.toTableBlock(e.blockMap.blocks[r]));return A._applyForEachColumnCell(s,o,a=>{A._changeCellColor(a,n,i)}),{selection:{..._.createTableBlockSelection(r),customSelection:se.createColumnSelection({columnKey:o})}}}static duplicateColumn(e,r,o){let n=d(p.toTableBlock(e.blockMap.blocks[r])),i=p.duplicateColumn(n,o);return{selection:_.createTableColumnSelection(r,i)}}static duplicateRow(e,r,o){let n=d(p.toTableBlock(e.blockMap.blocks[r])),i=p.duplicateRow(n,o);return{selection:_.createTableRowSelection(r,i)}}static removeTableColumn(e,r,o){let n=d(p.toTableBlock(e.blockMap.blocks[r])),i=A.getNextColumnKey(n,o);return p.removeColumn(n,o),n.colsOrder.length?(i||(i=A.getLastColumnKey(n)),{selection:_.createTableColumnSelection(r,i)}):xo(e,r,E.create())}static changeTableColor(e,r,{color:o,opacity:n}){let i=d(p.toTableBlock(e.blockMap.blocks[r]));return A._applyForEachCell(i,s=>A._changeCellColor(s,o,n)),{selection:_.createTableBlockSelection(r)}}static changeTableTextVerticalAlign(e,r,o){let n=d(p.toTableBlock(e.blockMap.blocks[r]));return A._applyForEachCell(n,i=>p.setCellVerticalAlign(i,o)),{selection:_.createTableBlockSelection(r)}}static changeTableRowTextVerticalAlign(e,r,o,n){let i=d(p.toTableBlock(e.blockMap.blocks[r]));return A._applyForEachRowCell(i,o,s=>p.setCellVerticalAlign(s,n)),{selection:_.createTableRowSelection(r,o)}}static changeTableCellTextVerticalAlign(e,r,o){let{startKey:n}=r,{rowKey:i,colKey:s}=r.customSelection,a=d(p.toTableBlock(e.blockMap.blocks[n])),c=p.getCell(a,i,s);return p.setCellVerticalAlign(c,o),{selection:r}}static changeTableColumnTextVerticalAlign(e,r,o,n){let i=d(p.toTableBlock(e.blockMap.blocks[r]));return A._applyForEachColumnCell(i,o,s=>p.setCellVerticalAlign(s,n)),{selection:_.createTableColumnSelection(r,o)}}static changeTableTextHorizontalAlign(e,r,o){let n=d(p.toTableBlock(e.blockMap.blocks[r]));return A._applyForEachCell(n,i=>p.setCellHorizontalAlign(i,o)),{selection:_.createTableBlockSelection(r)}}static changeTableRowTextHorizontalAlign(e,r,o,n){let i=d(p.toTableBlock(e.blockMap.blocks[r]));return A._applyForEachRowCell(i,o,s=>p.setCellHorizontalAlign(s,n)),{selection:_.createTableRowSelection(r,o)}}static changeTableColumnTextHorizontalAlign(e,r,o,n){let i=d(p.toTableBlock(e.blockMap.blocks[r]));return A._applyForEachColumnCell(i,o,s=>p.setCellHorizontalAlign(s,n)),{selection:_.createTableColumnSelection(r,o)}}};function Mf(t){let e=We(t.meta,"charactersMeta");return e&&e.name==="charactersMeta"?e.data:null}function lS(t,e){return We(t.meta,e)}function Af(t){let e=lS(t,"isHeaderColumnPinned");return!!e&&e.name==="isHeaderColumnPinned"}function Hi(t){return t<=27?"1.5":t<=31?"1.35":t<=56?"1.25":"normal"}var Vi=class extends Qe{getLineHeightForFontSize(e){return Hi(e)}};var dS="table",mS=[255,255,255],sc={},Wi=class extends O{constructor({block:e,isLock:r,onHyperlinkOverFn:o,readonlyMode:n,direction:i}){super({blockName:dS,direction:i}),this._block=e,this._readonlyMode=n,this._isLock=r,this._direction=i,this._onHyperlinkOverFn=o,this._onCellFocusSignal=this._createSignal(),this._onCellBlurSignal=this._createSignal(),this._onCellMouseOver=this._createSignal(),this._onCellMouseOut=this._createSignal(),this._invalidateModifiers()}onCellKeyDown(){return this._getBrowserEventSignal($.KEY_DOWN)}onCellBlurSignal(){return this._onCellBlurSignal}onCellFocusSignal(){return this._onCellFocusSignal}onCellMouseOver(){return this._onCellMouseOver}onCellMouseOut(){return this._onCellMouseOut}setBlock(e){this._block!==e&&(this._block=e,this._invalidateModifiers(),this._sheduleRender())}setLockMode(e){this._isLock!==e&&(this._isLock=e,this._sheduleRender())}setDirection(e){this._direction!==e&&(super.setDirection(e),this._invalidateModifiers())}getCellElement(e){return this.domElement().querySelector(`[data-cell-key='${e}']`)}getLeftCellFromRow(e){let r=this._direction==="rtl"?A.getLastColumnKey(this._block):A.getFirstColumnKey(this._block);return d(p.getCell(this._block,e,r)).key}getFirstCellFromColumn(e){let r=A.getFirstRowKey(this._block);return d(p.getCell(this._block,r,e)).key}_invalidateModifiers(){this.updateModifier("pin-header-column",Af(this._block)),this.updateModifier("dir",this._direction)}_renderParagraph(e,r={}){let o=K(e);if(!o)throw new Error;let n=ct(new Vi({paragraph:o,idPrefix:"cell-paragraph",blockBeforeType:null}),this._onHyperlinkOverFn,this._readonlyMode,this._isLock);return n.classList.add("cell-paragraph"),Er(n,r),n}_getCellStyles(e){let r="",o="",n=1;if(e.forEach(i=>{switch(i.name){case"backgroundColor":o=i.color;break;case"backgroundOpacity":n=i.opacity;break;case"charactersMeta":break;default:throw F(i),new Error(`unknown meta ${i}`)}}),o){let[i,s,a]=an(mS,[...ie(o),n]);r+=`background-color: rgb(${i}, ${s}, ${a});`}return r}_getCellContentClasses(e){let r=new le("table-cell-content"),o=`${r.className()}`;return o+=` ${r.getModifierWithValueClassName("vertical-align",e)}`,o}_getParagraphStyles(e){return Xn(d(K(e.content)),Mf(e),Hi)}_renderCell(e,r){let o=this._block.rowsMap[e].colsMap[r],n=()=>{this._onCellFocusSignal.dispatch(o.key)},i=()=>{this._onCellBlurSignal.dispatch(o.key)},s=()=>{this._onCellMouseOver.dispatch({cellKey:o.key,rowKey:e,colKey:r})},a=()=>{this._onCellMouseOut.dispatch({cellKey:o.key,rowKey:e,colKey:r})},c=this._getCellStyles(o.meta),l=this._getParagraphStyles(o),m=this._getCellContentClasses(o.verticalTextAlign);return D(sc,`:cell-${this._block.key}-${e}-${r}-${o.key}`)`
<td
	style=${c}
	data-table-key=${this._block.key}
	data-cell-key=${o.key}
	data-row-key=${e}
	data-col-key=${r}
	contenteditable=${!this._readonlyMode&&!this._isLock}
	class="table-cell"
	onmouseover=${s}
	onmouseout=${a}
	onfocus=${n}
	onblur=${i}
	onkeydown=${this}
>
	<div
		contenteditable=${!this._readonlyMode&&!this._isLock}
		class=${m}
	>
		${this._renderParagraph(o.content,l)}
	</div>
</td>`}_renderRow(e){return D(sc,`:row-${this._block.key}-${e}`)`
<tr
	contenteditable="false"
	class='table-row'
	data-row-key=${e}
>
	${this._block.colsOrder.map(r=>this._renderCell(e,r))}
</tr>`}_render(){return D(sc,`:table-block-${this._block.key}`)`
<table
	contenteditable="false"
	class="${this._getCssClasses()}"
>
	${this._block.rowsOrder.map(e=>this._renderRow(e))}
</table>`}};var Ui=class extends O{constructor({tableBlock:e,tableRenderer:r,direction:o}){super({blockName:"table-scroll-container",direction:o}),this._tableBlock=e,this._tableRenderer=r,this._scrollSignal=this._createSignal()}setBlock(e){this._tableBlock!==e&&(this._tableBlock=e)}scrollSignal(){return this._scrollSignal}scrollLeft(){return this.domElement().scrollLeft}calculateCellBounds(e){if(!this._wasRendered())return null;let r=this._tableRenderer.getCellElement(e);if(!r)return null;let o=r.getBoundingClientRect(),n=this.domElement(),i=n.getBoundingClientRect();return{width:o.width,height:o.height,left:o.left-i.left+n.scrollLeft,top:o.top-i.top}}_onTableScroll(){this._scrollSignal.dispatch()}};var uS="table-shadow-container",pS={},zi=class extends O{constructor({tableBlock:e,tableRenderer:r,tableScrollContainer:o,direction:n}){super({blockName:uS,direction:n}),this._tableBlock=e,this._tableScrollContainer=o,new ResizeObserver(()=>this._invalidateModifiers()).observe(r.domElement()),new ResizeObserver(()=>this._invalidateModifiers()).observe(this._tableScrollContainer.domElement()),this._addSignal(this._tableScrollContainer.scrollSignal(),()=>this._invalidateModifiers())}setDirection(e){this._direction!==e&&(super.setDirection(e),this._invalidateModifiers())}_invalidateModifiers(){let e=this._tableScrollContainer.domElement(),r=this._direction==="rtl"?Math.abs(Math.ceil(e.scrollLeft)):Math.ceil(e.scrollLeft),o=Math.ceil(e.scrollWidth-e.clientWidth);this.updateModifier("left-shadow",r>0),this.updateModifier("right-shadow",r<o)}_render(){return D(pS,`:table-block-shadow-${this._tableBlock.key}`)`
			<div class=${this._getCssClasses()}></div>
		`}};var ac={},fS="table-block",Of={},cc=class extends Ui{constructor({tableBlock:e,tableRenderer:r}){super({tableBlock:e,tableRenderer:r})}_render(){let e=this._tableBlock;return D(Of,`:table-block-scroll-container-${e.key}`)`
		<div
			class="${this._getCssClasses()}"
			contenteditable="false"
			onscroll=${()=>this._onTableScroll()}
		>
			${this._tableRenderer.domElement()}
		</div>`}},lc=class extends O{constructor({block:e,onHyperlinkOverFn:r,direction:o=Ve()}){super({blockName:fS}),this._direction=o,this.updateModifier("dir",this._direction),this._block=e,this._tableRenderer=new Wi({block:e,onHyperlinkOverFn:r,readonlyMode:!0,isLock:!1,direction:this._direction}),this._tableScrollContainer=new cc({tableRenderer:this._tableRenderer,tableBlock:this._block}),this._tableShadowContainer=new zi({tableBlock:this._block,tableRenderer:this._tableRenderer,tableScrollContainer:this._tableScrollContainer,direction:this._direction}),this._invalidateModifiers()}setBlock(e){this._block!==e&&(this._block=e,this._invalidateModifiers(),this._tableRenderer.setBlock(e),this._sheduleRender())}_invalidateModifiers(){this.updateModifier("align",this._block.alignment)}_render(){let e=this._block;return D(Of,`:table-block-${this._block.key}`)`
			<figure
				class=${this._getCssClasses()}
				contenteditable="false"
				draggable="false"
				data-key=${e.key}
				tabindex="-1"
			>
				${this._tableScrollContainer.domElement()}
				${this._tableShadowContainer.domElement()}
			</figure>`}};function Ff({block:t,blockBeforeType:e,onHyperlinkOverFn:r}){let o;return ac[t.key]?(o=ac[t.key],o.setBlock(t)):(o=new lc({block:t,onHyperlinkOverFn:r}),ac[t.key]=o),o.updateModifier("after",e),o}function Nf({getState:t,updateStateFn:e,scrollToElementFn:r}){let o=me.selectedSection(t()).contentState,n=new Ii(o);return n.registerRenderer(f.COLLAGE,Wp),n.registerRenderer(f.EMBED,zp),n.registerRenderer(f.EXERCISE,({block:i,blockBeforeType:s})=>Sf({state:d(Pf(t(),i.key)),updateStateFn:a=>e(c=>{let l=d(Pf(c,i.key));a(l)}),blockBeforeType:s,scrollToElementFn:r})),n.registerRenderer(f.ATTACHMENT,up),n.registerRenderer(f.NOTE,If),n.registerRenderer(f.TABLE,Ff),n.registerRenderer(f.FLIP_CARD,bf),n}function Pf(t,e){let n=me.selectedSection(t).contentState.blocksState.find(i=>e===i.key);return n&&n.type===f.EXERCISE?n:null}function Lf(t,e,r){let o=r.getBoundingClientRect(),n=e.getBoundingClientRect(),i=Math.round(o.left-n.left+(o.width-t.clientWidth)*.5);yt(t,"inset-inline-start",`${i}px`)}var Gi=class extends Qt{constructor(e,r){super({block:"tooltip-with-tail"}),r&&this.addBemInfo(r),this._relatedElement=e,this._addSignal(this.onDidRedraw(),()=>this._reCalcTailPosition()),this.showBelow()}showAbove(){this.updateModifier("show","above")}showBelow(){this.updateModifier("show","below")}_reCalcTailPosition(){Lf(d(this._getChildElement("tail")),this.domElement(),this._relatedElement)}_renderContent(){return this._childHtml("content")`
<div></div>`}_render(){let e=Y([this.createChildBemInfo("tail")]);return this._html`
<div class=${this._getCssClasses()} style=${this._getBaseStyles()} onconnected=${()=>this._reCalcTailPosition()}>
	${this._childHtml("tail")`<div class=${e}></div>`}
	${this._renderContent()}
</div>`}};var Qi=class extends O{constructor(){super({blockName:"top-layer"}),this._component=null,this._componentStrategy=null,this._hideSignalKey=null,this._addSignal(this.onDidRedraw(),()=>{this._componentStrategy&&this._componentStrategy.invalidateComponentPosition()})}hide(){this._componentStrategy&&this._componentStrategy.hide()}_showImpl({component:e,componentStrategy:r}){this._component=e,this._componentStrategy=r,this._cleanListeners(),this._hideSignalKey=this._addSignal(this._componentStrategy.hideSignal(),()=>this._hideImpl()),this._componentStrategy.beforeShow(),this._sheduleRender()}_hideImpl(){this._cleanListeners(),this._component=null,this._componentStrategy=null,this._sheduleRender()}_cleanListeners(){this._hideSignalKey&&this._removeSignalByKey(this._hideSignalKey),this._hideSignalKey=null}_render(){return this._html`
<div class=${this._getCssClasses()}>
	${this._component}
</div>`}};var oo=class extends Ae{constructor(e){super(),this._component=e,this._hideSignal=this._createSignal()}hide(){let e=this._beforeHide();e?e.addCallOnce(()=>this._hideSignal.dispatch()):this._hideSignal.dispatch()}invalidateComponentPosition(){}beforeShow(){}_beforeHide(){}hideSignal(){return this._hideSignal}};var hS=20,gS=10,Zt=class extends oo{constructor({component:e,relatedElement:r,offsetX:o=hS,offsetY:n=gS}){super(e),this._relatedElement=r,this._offsetX=o,this._offsetY=n}invalidateComponentPosition(){let e=this._relatedElement.getBoundingClientRect();(!e.width||!e.height||!this._relatedElement.parentNode)&&h.warn(`incorrect bounding box (${this._relatedElement.parentNode==null})`),this._component.move(e.left-this._offsetX,e.bottom+this._offsetY);let r=this._component.x()||0;r<0&&(r=this._offsetX),r+this._component.domElement().clientWidth>window.innerWidth&&(r=window.innerWidth-this._offsetX-this._component.domElement().clientWidth);let o=this._component.y()||0;o<0&&(o=this._offsetY),o+this._component.domElement().clientHeight>window.innerHeight&&(o=e.top-this._offsetY-this._component.domElement().clientHeight),this._component.move(r,o)}};var $f=150,yS=5,_S=10,Yi=class extends Zt{constructor({tooltip:e,relatedElement:r,offsetX:o=yS,offsetY:n=_S,showBelow:i}){super({component:e,relatedElement:r,offsetX:o,offsetY:n}),this._showBelow=i,this._onMouseOutKey=null,this._onComponentMouseOutKey=null,this._onTouchStartKey=null}beforeShow(){this._onMouseOutKey=this._listen(this._relatedElement,$.MOUSEOUT,o=>this._checkForHide(o)),this._onComponentMouseOutKey=this._listen(this._component.domElement(),$.MOUSEOUT,o=>this._checkForHide(o)),this._onTouchStartKey=this._listen(document.body,$.TOUCHSTART,o=>this._checkForHide(o));let e=this._component.domElement(),r=gr(e);bt({reducer:r,timingFn:Ei(Gt),duration:$f})}_beforeHide(){return this._onMouseOutKey&&this._unlistenByKey(this._onMouseOutKey),this._onComponentMouseOutKey&&this._unlistenByKey(this._onComponentMouseOutKey),this._onTouchStartKey&&this._unlistenByKey(this._onTouchStartKey),this._playHideAnimation()}invalidateComponentPosition(){let e=this._showBelow,r=this._getTooltip(),o=this._relatedElement.getBoundingClientRect();(!o.width||!o.height||!this._relatedElement.parentNode)&&h.warn(`incorrect bounding box (${this._relatedElement.parentNode==null})`);let n=r.domElement().getBoundingClientRect(),i=o.left+o.width*.5-n.width*.5,s=this._showBelow?o.bottom+this._offsetY:o.top-this._offsetY-n.height;r.move(i,s);let a=r.x()||0;a<0&&(a=this._offsetX),a+n.width>window.innerWidth&&(a=window.innerWidth-this._offsetX-n.width);let c=r.y()||0;c<0&&(c=o.bottom+this._offsetY,e=!0),this._component.move(a,c),e?r.showBelow():r.showAbove()}_checkForHide(e){let r=e.relatedTarget;r instanceof Node&&!this._relatedElement.contains(r)&&!this._component.domElement().contains(r)&&this.hide()}_getTooltip(){return this._component}_playHideAnimation(){let e=this._component.domElement(),r=gr(e);return bt({reducer:r,timingFn:Gt,duration:$f,afterAnimation:()=>{this._component.hide()}})}};var qi=class extends oo{constructor(e){super(e),this._onMouseDownKey=null}invalidateComponentPosition(){}beforeShow(){this._onMouseDownKey=this._listen(document.body,$.MOUSEDOWN,e=>this._onMouseDown(e))}_beforeHide(){return this._onMouseDownKey&&this._unlistenByKey(this._onMouseDownKey),null}_onMouseDown(e){let r=e.target;r instanceof Node&&!this._component.domElement().contains(r)&&this.hide()}};var Xi=class extends Zt{constructor(e){super(e),this._onMouseDownKey=null}beforeShow(){this._onMouseDownKey=this._listen(document.body,$.MOUSEDOWN,e=>this._onMouseDown(e))}_beforeHide(){return this._onMouseDownKey&&this._unlistenByKey(this._onMouseDownKey),null}_onMouseDown(e){let r=e.target;r instanceof Node&&!this._relatedElement.contains(r)&&!this._component.domElement().contains(r)&&this.hide()}};var CS=5,kS=10,ji=class extends Zt{constructor({tooltip:e,relatedElement:r,offsetX:o=CS,offsetY:n=kS,showBelow:i}){super({component:e,relatedElement:r,offsetX:o,offsetY:n}),this._showBelow=i,this._onMouseOutKey=null,this._onTouchStartKey=null}beforeShow(){this._onMouseOutKey=this._listen(this._relatedElement,$.MOUSEOUT,()=>this.hide()),this._onTouchStartKey=this._listen(document.body,$.TOUCHSTART,e=>this._checkForHide(e))}_beforeHide(){return this._onMouseOutKey&&this._unlistenByKey(this._onMouseOutKey),this._onTouchStartKey&&this._unlistenByKey(this._onTouchStartKey),null}invalidateComponentPosition(){let e=this._showBelow,r=this._getTooltip(),o=this._relatedElement.getBoundingClientRect();(!o.width||!o.height||!this._relatedElement.parentNode)&&h.warn(`incorrect bounding box (${this._relatedElement.parentNode==null})`);let n=r.domElement().getBoundingClientRect(),i=o.left+o.width*.5-n.width*.5,s=this._showBelow?o.bottom+this._offsetY:o.top-this._offsetY-n.height;r.move(i,s);let a=r.x()||0;a<0&&(a=this._offsetX),a+n.width>window.innerWidth&&(a=window.innerWidth-this._offsetX-n.width);let c=r.y()||0;c<0&&(c=o.bottom+this._offsetY,e=!0),this._component.move(a,c),e?r.showBelow():r.showAbove()}_checkForHide(e){let r=e.target;r instanceof Node&&!this._relatedElement.contains(r)&&!this._component.domElement().contains(r)&&this.hide()}_getTooltip(){return this._component}};var Zi=class extends Qi{showPopup(e){this._showImpl({component:e.component,componentStrategy:new Xi(e)})}showTooltip({tooltip:e,relatedElement:r,offsetX:o,offsetY:n,showBelow:i=!0,enableAnimation:s=!1}){let a=s?new Yi({tooltip:e,relatedElement:r,offsetX:o,offsetY:n,showBelow:i}):new ji({tooltip:e,relatedElement:r,offsetX:o,offsetY:n,showBelow:i});this._showImpl({component:e,componentStrategy:a})}showFreePositioningPopup(e){this._showImpl({component:e,componentStrategy:new qi(e)})}};function Kf(t,e){return{animate:r=>{t.style.transform=`${e} scaleX(${r})`},complete:()=>{t.style.transform=e||""},changedProperties:["transform"]}}var Ji=class extends Gi{constructor(e,r){super(r),this._tooltipText=e}_renderContent(){let e=Y([this.createChildBemInfo("text")]);return this._childHtml("content")`
<div class=${e}>
	${this._tooltipText}
</div>`}};function Hf(t,e){let[,r]=Ln(t,e);return r}function Vf(t,{articleTitle:e,articleTitleClass:r}){let o=ne(),n=Hf(o);return st({html:t,elementRef:o,text:e,show:n}),t`
<div class=${r} save-ref=${o}>${e}</div>`}function Wf(t){return t?t.replace(/^\s|\s$/,Ge.NBSP):Ge.ZERO_WIDTH_SPACE}var{getCssClass:no}=he`/src/roll/player/renderer/navigation/NavigationItemRenderer.css`;function SS(t,{progress:e}){let r=e==0?no("not-started",{dir:Ve()}):no("complete");return t`
<div class=${r}></div>`}function xS(t,{progress:e}){let o=Math.PI*18,n=(100-e*100)/100*o;return t`
<div class=${no("progress-bar")}>
	<svg width="22" height="22" viewPort="0 0 11 11" version="1.1" xmlns="http://www.w3.org/2000/svg">
		<circle r="${9}" cx="11" cy="11" fill="transparent" stroke-dasharray="56.5" stroke-dashoffset="0"></circle>
		<circle class=${no("bar")} r="${9}" cx="11" cy="11" fill="transparent" stroke-dasharray="56.5" stroke-dashoffset="${n}"></circle>
	</svg>
</div>`}function Uf(t,e){let r={selected:e.selected,intro:e.isIntro,dir:Ve()},o=e.progress,n=Ao(),i=e.disabled,s=i?e.onHoverDisabledState:null,a=n?null:s,c=n?s:null,l=i?null:e.onClick;return t`
<div
	class=${no("navigation-item",r)}
	disabled=${i?!0:null}
	onclick=${l}
	onmouseover=${a}
	passive-events=${{ontouchstart:c}}
>
	${t.switch(()=>o==0||o==1?C(SS,{progress:o}):C(xS,{progress:o}))}
	<div class=${no("label")}>${Wf(e.label)}</div>
</div>`}var es=class extends O{constructor(){super({blockName:"total-progress"}),this._progress=0}setProgress(e){this._progress=e,this._sheduleRender()}_render(){let e=Math.floor(this._progress*100)+"%";return this._html`
<div class=${this._getCssClasses()}>
	<div class=${this._getChildClass("numeric")}>${e}</div>
	<div class=${this._getChildClass("indicator-container")}>
		<div class=${this._getChildClass("indicator-progress")} style=${`width: ${e}`}></div>
	</div>
</div>`}};var ts=class extends O{constructor(e,r,o){super({blockName:"navigation-panel"}),this._state=e,this._settings=r,this._topLayer=o,this._totalProgress=new es,this._totalProgress.addBemInfo(this.createChildBemInfo("progress")),this._sections=this._createSections(e),this.onSectionClick=this._createSignal(),this._ignoreNextAnimation=!1,this._articleTitle=this._state.intro.header.title||x("Roll.Common.IntroDefaultTitle")}setState(e){this._state=e,this._updateRenderers()}ignoreNextShowPanelAnimation(){this._ignoreNextAnimation=!0}onTransitionEnd(){return this._getBrowserEventSignal($.TRANSITIONEND)}redrawOverlay(){this._updateRenderers()}_updateRenderers(){this.updateModifier("showed",this._state.navigationPanelShowed),this.updateModifier("in-overlay",Ht()||at()),this._totalProgress.setProgress(me.progress(this._state)),this._sections=this._createSections(this._state),this._ignoreNextAnimation?(this._ignoreNextAnimation=!1,this.updateModifier("ignore-transition",!0)):this.hasModifier("ignore-transition")&&this.updateModifier("ignore-transition",!1),this._sheduleRender()}_createSections(e){let r=[],o=-1,n=this._settings.navigationType=="sequence",i=x("Roll.Common.ChapterDefaultTitle");return me.sections(e).forEach((s,a)=>{let c=s==e.intro?x("Roll.Common.NavigationPanel.IntroTitle"):s.header.title||i,l=s.progress,m=s==me.selectedSection(e);m&&(o=l<1?a:a+1);let u=n&&o!=-1&&a>o&&l==0,g=()=>{let N=new Ji(x("Roll.Player.LockedNavigationItemTooltipText"),b);this._topLayer.showTooltip({tooltip:N,relatedElement:b,showBelow:!1,enableAnimation:!0})},b=ae(Uf)({label:c,progress:s.progress,selected:m,isIntro:s==e.intro,disabled:u,onClick:()=>this.onSectionClick.dispatch(s),onHoverDisabledState:g},this._renderFunctionEx(s.key));r.push(b)}),r}_renderArticleTitle(){let e=Y([this.createChildBemInfo("article-title")]);return ae(Vf)({articleTitle:this._articleTitle,articleTitleClass:e},this._renderFunctionEx("article-title"))}_renderMainPanel(){return this._childHtml("main-panel")`
<div class='main-panel'>
	${this._renderArticleTitle()}
	${this._totalProgress}
	${this._sections}
</div>`}_render(){return this._html`
<div
	class=${this._getCssClasses()}
	ontransitionend=${this}
	onscroll=${()=>this._topLayer.hide()}
>
	${this._renderMainPanel()}
</div>`}};var Lo=new Map,zf=!1;function bS(t){Lo.delete(t)}function wS(t,e,r){Lo.has(e)||(Lo.set(e,{}),e.addDestructHandler(()=>{bS(e)}));let o=d(Lo.get(e));d(!o[t]),o[t]=r}function TS(t){Lo.forEach(e=>{e.hasOwnProperty(t)&&e[t]()})}function vS(t,e){return function(){let r=typeof e=="function"?e():e;return x(t,r)}}function ES({id:t,renderer:e,updateFn:r,parameters:o}){!zf&&bs&&(bs.add(TS),zf=!0);let n=o?vS(t,o):()=>x(t),i=null;if(r){let s=r.bind(e);i=()=>s(n()),i()}else i=()=>e._sheduleRender();return wS(t.toString(),e,i),{getMessageFn:n,forceUpdateFn:i}}function Gf(t,e,r){let{getMessageFn:o}=ES({id:t,renderer:e,parameters:r});return o}var rs=class extends O{constructor({header:e,chapterIndex:r,chaptersCount:o,numberingEnabled:n,defaultTitle:i,marginTop:s,paddingTop:a}){super({blockName:"chapter-header",relatedData:e}),this._header=e,this._defaultTitle=i,this._marginTop=s,this._paddingTop=a,this._labelMessageFn=Gf(Lc("Roll.Common.CurrentChapterFromTotal"),this,{current:r+1,total:o}),this._numberingEnabled=n}title(){return d(this._getChildElement("chapter-title"))}_render(){let e=Y(["text-chapter-number",this.createChildBemInfo("chapter-number")]),r=Y(["text-title",this.createChildBemInfo("title")]),o=this._header.title||this._defaultTitle||x("Roll.Common.ChapterDefaultTitle");return this._html`
<div
	class=${this._getCssClasses()}
	style=${{"margin-top":this._marginTop,"padding-top":this._paddingTop}}
>
	${this._numberingEnabled?this._childHtml("numbering")`<p class=${e}>${this._labelMessageFn()}</p>`:null}
	${this._childHtml("chapter-title")`
		<p class=${r}>${o}</p>
	`}
</div>`}};var os=class extends O{constructor(e){super({blockName:"intro-header",relatedData:e}),this._header=e,this.updateModifier("with-cover",!!this._header.coverInfo),this.updateModifier("without-kicker",this._header.kicker=="")}kickerElement(){return this._getChildElement("kicker")}titleElement(){return d(this._getChildElement("intro-title"))}stripElement(){return this._getChildElement("strip")}_coverImage(){let e=this._header.coverInfo;if(!e)return null;let r={"background-image":`url(${e.src})`},o=ie(e.color),n=e.opacity,i={"background-color":`rgba(${o[0]}, ${o[1]}, ${o[2]}, ${n})`},s=Y(["intro-cover",this.createChildBemInfo("cover")]),a=Y(["intro-cover-overlay",this.createChildBemInfo("cover-overlay")]);return this._childHtml("cover")`
<div style=${r} class=${s}>
	<div style=${i} class="${a}">
</div>`}_render(){let e=Y(["intro-container"]),r=Y(["text-kicker",this.createChildBemInfo("kicker")]),o=Y(["text-title",this.createChildBemInfo("title")]),n=Y([this.createChildBemInfo("strip")]),i=this._header.coverInfo?null:this._childHtml("strip")`
				<div class=${n}></div>`;return this._html`
<div class=${this._getCssClasses()}>
	${this._coverImage()}
	<div class=${e}>
		${this._header.kicker?this._childHtml("kicker")`<p class=${r}>${this._header.kicker.trim()||Ge.ZERO_WIDTH_SPACE}</p>`:null}
		${this._childHtml("intro-title")`
			<p class=${o}>${this._header.title?this._header.title.trim()||Ge.ZERO_WIDTH_SPACE:x("Roll.Common.IntroDefaultTitle")}</p>
		`}
		${i}
	</div>
</div>`}};var ns=class extends Qt{constructor({bemInfo:e,blockName:r,autotestData:o}){super({bemInfo:e,blockName:r}),this._pressed=!1,this._disabled=!1,this._autotestData=o}onClick(){return this._getBrowserEventSignal($.CLICK)}onMouseDown(){return this._getBrowserEventSignal($.MOUSEDOWN)}onMouseOver(){return this._getBrowserEventSignal($.MOUSEOVER)}onMouseOut(){return this._getBrowserEventSignal($.MOUSEOUT)}setDisabled(e){this._disabled=e,this._sheduleRender()}pressed(){return this._pressed}setPressed(e){this._pressed=e,this.updateModifier("pressed",this._pressed)}_render(){return this._html`
			<button class=${this._getCssClasses()}
					disabled=${this._disabled}
					style=${this._getBaseStyles()}
					onclick=${this._getHandler($.CLICK)}
					data-at=${ee(this._autotestData)}
					onmousedown=${this._getHandler($.MOUSEDOWN)}
					onmouseover=${this._getHandler($.MOUSEOVER)}
					onmouseout=${this._getHandler($.MOUSEOUT)}>
				${this._getText()}
			</button>`}};var is=class extends Qt{constructor({previewMode:e,subscriptionProduct:r,removeWatermarkUrl:o}){super({blockName:"top-panel"}),this._previewMode=e,this.onClosePlayerRequest=this._createSignal(),this._showNavigationButton=new ns({bemInfo:this.createChildBemInfo("show-navigation")}),this._showNavigationButton.updateModifier("dir",Ve()),this._progress=0,this._animationRunning=!1,this._ignoreProgressTransition=!1,this._addSignal(this.onDidRedraw(),()=>{this._ignoreProgressTransition=!1}),this._subscriptionProduct=r,this._removeWatermarkUrl=o,this._watermarkBemInfo=this.createChildBemInfo("watermark"),this._watermarkLogoBemInfo=this.createChildBemInfo("watermark-logo")}onShowNavigationButtonClick(){return this._showNavigationButton.onClick()}setState(e){this._showNavigationButton.setPressed(e.navigationPanelShowed);let r=me.selectedSection(e);this._progress=r.progress,this._ignoreProgressTransition=r.progress<this._progress,this.updateModifier("floating",Ht()||at()),this._sheduleRender()}setAnimationRunning(e){this._animationRunning=e}getProgressElement(){return d(this._getChildElement("progress"))}_getWatermarkText(){let e=d(this._subscriptionProduct);switch(e){case"isstudio":return x("TrialWatermark.Text.Page");case"isspace":return x("TrialWatermark.Text.Space");case"islearn":return x("TrialWatermark.Text.Learn");default:F(e)}return""}_isWatermarkRemovalAllowed(){return this._subscriptionProduct==="isstudio"||this._subscriptionProduct==="isspace"}_renderCrossIcon(){if(this._previewMode)return null;let e=ae($r)({}),r=this._getChildClass("close");if(Zo()){let o=e.getAttribute("class")||"";o=o.split(" ").includes(r)?o:`${e.className} ${r}`,e.setAttribute("class",o)}else e.classList.add(r);return Xe(e,"click",()=>this.onClosePlayerRequest.dispatch()),e}_render(){let e=Y(["top-panel-progress"]),r={width:`calc(100% * ${this._progress})`,transition:this._ignoreProgressTransition?"none":""},o=this._watermarkLogoBemInfo.className();this._subscriptionProduct&&(o+=" "+this._watermarkLogoBemInfo.getModifierWithValueClassName("product",this._subscriptionProduct));let n=this._watermarkBemInfo.className(),i="#";return this._isWatermarkRemovalAllowed()&&(n+=" "+this._watermarkBemInfo.getModifierClassName("removable"),i=this._removeWatermarkUrl||"#"),this._html`
<div class=${this._getCssClasses()} style=${this._getBaseStyles()}>
	${this._showNavigationButton}
	${this._childHtml("progress")`<div class=${e} style=${r}></div>`}
	${this._renderCrossIcon()}
	${!1?this._childHtml("watermark")`
		<a href=${i} target="_blank" class=${n}>
			<div class="${o}"></div>
			<span>${this._getWatermarkText()}</span>
		</a>`:null}
</div>`}};var BS=500,Qf=56,dc=53,RS=600,DS=Ei(Ba(Gt,.14)),IS=Ba(Gt,.64),MS=850,ss=class extends O{constructor({state:e,settings:r,previewMode:o,updateStateFn:n,subscriptionProduct:i,removeWatermarkUrl:s}){super({blockName:"roll-player"}),this._topLayer=new Zi,this._topWindow=window;try{window.top.location.href&&(this._topWindow=window.top)}catch(a){}this._state=e,this._settings=r,this._isOnePageLongread=r.longreadType==="onePage",this._topPanel=new is({previewMode:o,subscriptionProduct:i,removeWatermarkUrl:s}),this._navigationPanel=new ts(e,r,this._topLayer),this._navigationPanel.addBemInfo(this.createChildBemInfo("navigation")),this._labelText="",this._iconMeta={},this._introHeaderRenderer=null,this._chapterHeaderRenderer=null,this._richTextRenderer=Nf({getState:()=>this._state,updateStateFn:n,scrollToElementFn:(a,c)=>{let m={top:Qf+15,bottom:d(this._topWindow).innerHeight-15};qu({element:a,container:this._content(),duration:BS,scrollDirection:c,bounds:m})}}),this._watermarkClassName=this.createChildBemInfo("watermark").className(),this._contentBlockClassName=this.createChildBemInfo("content").className(),this._gotoNextClassName=this.createChildBemInfo("next").className(),this._mainBlockClassName=this.createChildBemInfo("main").className(),this._state=e,this._invalidateRenderer(),this.onToggleNavigationButtonClick=this._createSignal(this._topPanel.onShowNavigationButtonClick()),this.onSectionClick=this._createSignal(),this._addSignal(this._navigationPanel.onSectionClick,a=>{let c=me.selectedSection(this._state);a==c?this._hideNavigationPanel(!1):(this._navigationPanel.ignoreNextShowPanelAnimation(),this._hideNavigationPanel(!0)),this.onSectionClick.dispatch(a)}),this.onGotoNextChapter=this._createSignal(),this.onSelectedSectionProgress=this._createSignal(),this.onClosePlayerRequest=this._createSignal(this._topPanel.onClosePlayerRequest),this._selectedChapterIndex=this._state.selectedSectionIndex,this._navigationPanelHideTransitionFinished=!0,this._prevScrollTop=0,this._abortContentAnimationSignal=new Ie,this._abortProgressAnimationSignal=new Ie,this._abortNextButtonIconSignal=new Ie,this._nextButtonIconAnimationCompleted=!0,lo()&&(this._listen(d(this._topWindow),$.RESIZE,()=>{this._invalidateHeight()}),this._listen(d(this._topWindow),$.SCROLL,()=>{this._invalidateHeight()}),this._listen(d(this._topWindow),$.ORIENTATIONCHANGE,()=>{setTimeout(()=>d(this._topWindow).scrollTo(0,0),500)})),this._listen(d(this._topWindow),$.ORIENTATIONCHANGE,()=>{this._topLayer.hide()}),this._resizeObserver=new ResizeObserver(()=>{this._onResize()})}redrawNavigation(){this._sheduleRender(),this._navigationPanel.redrawOverlay()}state(){return this._state}updateState(e){this._state=e;let r=this._state.selectedSectionIndex,o=this._selectedChapterIndex!=r;if(this._invalidateRenderer(),o){this._selectedChapterIndex=r;let n=this._content();n.scrollTop=0}this._invalidateContentProgress(),o&&(this._runContentAnimation(),this._runProgressAnimation())}ignoreNextShowPanelAnimation(){this._navigationPanel.ignoreNextShowPanelAnimation()}_onResize(){this._topPanel.updateModifier("without-transition",!0),this._topPanel.move(null,0),this._prevScrollTop=0,this._invalidateRenderer()}_runContentAnimation(){let e=this._content();this.updateModifier("hide-content-scroll",e.scrollHeight==e.clientHeight);let r=[];if(this._introHeaderRenderer){let i=this._introHeaderRenderer.domElement();r.push(gr(i))}if(this._chapterHeaderRenderer){let i=this._chapterHeaderRenderer.domElement();r.push(gr(i))}let o=this._richTextRenderer.domElement();r.push(gr(o));let n=Hn(r);this._abortContentAnimationSignal.dispatch(),bt({reducer:n,timingFn:DS,duration:RS,abortSignal:this._abortContentAnimationSignal}).addCallOnce(()=>{this.updateModifier("hide-content-scroll",!1)})}_runProgressAnimation(){this._abortProgressAnimationSignal&&this._abortProgressAnimationSignal.dispatch();let e=this._topPanel.getProgressElement(),r=Kf(e);this._abortProgressAnimationSignal.dispatch(),this._topPanel.setAnimationRunning(!0),bt({reducer:r,timingFn:IS,duration:MS,abortSignal:this._abortProgressAnimationSignal,beforeAnimation:()=>{e.style.transformOrigin="0 50%"},afterAnimation:()=>{e.style.transformOrigin=""}}).addCallOnce(()=>{this._topPanel.setAnimationRunning(!1)})}_getSelectedContent(){return me.selectedSection(this._state).contentState}_getIntroHeader(){let e=this._state;return e.selectedSectionIndex==-1?e.intro.header:null}_getChapterHeader(){return this._state.selectedSectionIndex==-1?null:me.selectedSection(this._state).header}_getSelectedSectionIndex(){return this._state.selectedSectionIndex}_getChaptersCount(){return this._state.chapters.length}_invalidateRenderer(){this._topPanel.setState(this._state),this._navigationPanel.setState(this._state);let e=(Ht()||at())&&!this._isOnePageLongread;this.updateModifier("with-floating-top-panel",e);let r=this._getIntroHeader();this._introHeaderRenderer=r?new os(r):null;let o=this._getChapterHeader();this._removeDisposable(this._chapterHeaderRenderer),this._chapterHeaderRenderer=null,o&&(this._chapterHeaderRenderer=new rs({header:o,chapterIndex:this._getSelectedSectionIndex(),chaptersCount:this._getChaptersCount(),numberingEnabled:this._settings.numberingEnabled}));let n=this._getSelectedContent();this._richTextRenderer.setAllowSubtitle(this._state.selectedSectionIndex>-1),this._richTextRenderer.updateState(n);let i=this._getNextSection();i?this._labelText=this._getNextSectionLabel(i):this._labelText="",this._sheduleRender()}_content(){return d(this.domElement().querySelector(`.${this._contentBlockClassName}`))}_invalidateContentProgress(){let e=this._content(),r=this._getChildElement("next"),o=r?r.clientHeight:0,n=ht(Math.ceil(e.scrollTop+e.clientHeight)/(e.scrollHeight-o),0,1);this.onSelectedSectionProgress.dispatch(n)}_invalidateHeight(){let e=d(this._topWindow).innerHeight;this.domElement().style.height=`${e}px`,this._navigationPanel.domElement().style.height=`${e}px`}_onScroll(e){if(this._invalidateContentProgress(),Ht()||at()){e.preventDefault(),this._topPanel.updateModifier("without-transition",!1);let r=Math.max(e.target.scrollTop,0);if(r>=this._prevScrollTop){if(r>dc){let o=-Math.min(r,dc);this._topPanel.move(null,o),this._prevScrollTop=r}}else if(r<this._prevScrollTop){if(r<=dc){this._topPanel.updateModifier("without-transition",!0);let o=Math.abs(parseFloat(d(this._topPanel.domElement().style.top)))||0,n=-Math.min(r,o);this._topPanel.move(null,n),this._prevScrollTop=r}this._prevScrollTop-r>Qf&&(this._topPanel.move(null,0),this._prevScrollTop=r)}}}_onConnected(){if(this._resizeObserver.observe(this.domElement()),lo()&&this._invalidateHeight(),this._invalidateContentProgress(),jo()){let e=()=>{Ce(()=>{this._invalidateContentProgress(),e()})};e()}}_hideNavigationPanel(e=!1){zn()||!this._navigationPanelHideTransitionFinished||(this._navigationPanelHideTransitionFinished=e,this._addSignal(this._navigationPanel.onTransitionEnd(),()=>{this._navigationPanelHideTransitionFinished=!0,this._sheduleRender()}),this.onToggleNavigationButtonClick.dispatch())}_animateNextButtonIcon(e){let r=this._iconMeta.current;if(r){this._abortNextButtonIconSignal.dispatch();let{y:o}=nn(r),n=e?"":"translateY(4px)",i=this._nextButtonIconAnimationCompleted?e?4:0:Math.abs(o),a=Xu({element:r,initialTransform:n,from:i,to:e?0:4});bt({reducer:a,timingFn:Yu,duration:150,abortSignal:this._abortNextButtonIconSignal,afterAnimation:()=>{this._nextButtonIconAnimationCompleted=!0}}),this._nextButtonIconAnimationCompleted=!1}}_getNextSection(){return this._settings.nextButtonEnabled?me.nextSection(this._state):null}_getNextSectionLabel(e){return x("Roll.Player.GotoNextChapterLink",{title:e.header.title||x("Roll.Common.ChapterDefaultTitle")})}_renderNextButton(){let r=this._getNextSection()?ae(Me)({style:"primary",structure:"textAndIcon",text:x("Roll.Player.Continue"),icon:Tr()?C(ju):C(Zu),onClick:()=>this.onGotoNextChapter.dispatch(),size:"xLarge"}):ae(Me)({style:"primary",structure:"text",text:x("Roll.Player.Complete"),onClick:()=>this.onClosePlayerRequest.dispatch(),size:"xLarge"});return r.classList.add(this._gotoNextClassName),r}_render(){let e=Y(["overlay"]),r=Y(["next-section-content-container"]),o=Y(["next-section-label"]),n=Y(["copying-disabled"]),i=this._settings.copyingEnabled?this._getCssClasses():`${this._getCssClasses()} ${n}`;return this._html`
<div data-root="${gt}" class=${i} onconnected=${this._onConnected}>
	${this._isOnePageLongread?null:this._navigationPanel}
	<div class=${this._mainBlockClassName}>
		${this._isOnePageLongread?null:this._topPanel}
		<div class=${this._contentBlockClassName} onscroll=${this._onScroll}>
			${this._introHeaderRenderer}
			${this._chapterHeaderRenderer}
			${this._richTextRenderer}
			${this._settings.nextButtonEnabled?this._childHtml("next")`
					<div class=${r}>
						<div class=${o}>
							${this._labelText}
						</div>
						${this._renderNextButton()}
					</div>`:null}
		</div>
	</div>
	${(Ht()||at())&&this._state.navigationPanelShowed||!this._navigationPanelHideTransitionFinished?this._childHtml("overlay")`<div class=${e} passive-events=${{ontouchstart:this._hideNavigationPanel}} onmousedown=${this._hideNavigationPanel}></div>`:null}
	${this._topLayer}
</div>`}};var as=class extends Ae{constructor({playerData:e,previewMode:r=!1,resumeState:o,subscriptionProduct:n,removeWatermarkUrl:i}){super(),this._state=Uu(e,o);let s=new vi(e.settings);this.onSelectedSectionChange=this._createSignal(),this.onSectionProgressChange=this._createSignal(),this._renderer=this._addDisposable(new ss({state:this._state,updateStateFn:c=>this._updateState(c),previewMode:r,settings:s,subscriptionProduct:n,removeWatermarkUrl:i})),this.onClosePlayerRequest=this._createSignal(this._renderer.onClosePlayerRequest),this._addSignal(this._renderer.onToggleNavigationButtonClick,()=>this._toggleNavigationPanel()),this._addSignal(this._renderer.onSectionClick,c=>this._selectSection(c)),this._addSignal(this._renderer.onGotoNextChapter,()=>this._gotoNextChapter()),this._addSignal(this._renderer.onSelectedSectionProgress,c=>{this._setSelectedSectionProgress(c),this.onSectionProgressChange.dispatch()});let a=Su(()=>this.setInitialNavigationToggleState(),100);this._lastWindowWidth=0,this._listen(window,$.RESIZE,a.call),this.setInitialNavigationToggleState()}getTitle(){return this._state.intro.header.title||x("Roll.Common.IntroDefaultTitle")}getChaptersCount(){return this._state.chapters.length}getCurrentSectionIndex(){return this._state.selectedSectionIndex}getCurrentSectionProgress(){return me.selectedSection(this._state).progress}getCurrentSectionsStateProgress(){return this._state.chapters.map(e=>e.progress===1)}getSuspendData(){return Eu(1,Qu(this._renderer.state()),Ti)}getArticle(){let e=this._state.chapters.map(r=>({key:r.key,title:r.header.title}));return{intro:{key:this._state.intro.key,title:this._state.intro.header.title},chapters:e}}setInitialNavigationToggleState(e=!0){let r=window.innerWidth;if(this._lastWindowWidth>lr.FULL&&zn())return;this._lastWindowWidth=r;let o=r>lr.FULL;this._updateState(n=>{if(o==n.navigationPanelShowed){o&&this._renderer.redrawNavigation();return}e||this._renderer.ignoreNextShowPanelAnimation(),n.navigationPanelShowed!=o&&(n.navigationPanelShowed=o)})}_updateState(e){let r=Qr(this._state,o=>{e(o)});this._state!=r&&(this._state=r,this._renderer.updateState(r),this.onSelectedSectionChange.dispatch())}_selectSection(e){this._updateState(r=>{r.selectedSectionIndex=e.key==r.intro.key?-1:r.chapters.findIndex(o=>o.key==e.key)})}_gotoNextChapter(){this._updateState(e=>{let r=me.nextSection(e);r&&(e.selectedSectionIndex=r.key==e.intro.key?-1:e.chapters.findIndex(o=>o.key==r.key))})}_setSelectedSectionProgress(e){this._updateState(r=>{let o=me.selectedSection(r);isNaN(e)||o.progress>=e||(o.progress=e)})}_toggleNavigationPanel(){this._updateState(e=>{e.navigationPanelShowed=!e.navigationPanelShowed})}domElement(){return this._renderer.domElement()}};async function AS(){let t=await _s(Xm);return t||(t=await Ec(qm),t)?t:null}function OS(t,e,r,o,n,i){Promise.all([_s(t),AS()]).then(([s,a])=>{if(!a)throw new Error;ku(a).then(c=>{if(!c)throw new Error;rl({settings:c.settings,i18nData:s});let l=new as({playerData:c,resumeState:o,subscriptionProduct:n,removeWatermarkUrl:i});r(l),document.body.appendChild(l.domElement());let m=xs("popup");document.body.appendChild(m);let u=xs("tooltip");document.body.appendChild(u)})})}function FS(t,e,r,o,n){return new Promise((i,s)=>{OS(t,e,i,r,o,n)})}xc("start",FS);})();
